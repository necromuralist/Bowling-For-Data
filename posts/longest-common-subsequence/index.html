<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A look at finding the longest common subsequence of two sequences.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Longest Common Subsequence | Bowling For Data</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/posts/longest-common-subsequence/index.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="The Cloistered Monkey">
<link rel="prev" href="../comparing-energy-prices/index.html" title="Comparing Energy Prices" type="text/html">
<link rel="next" href="../weighted-completion-times/index.html" title="Weighted Completion Times" type="text/html">
<meta property="og:site_name" content="Bowling For Data">
<meta property="og:title" content="Longest Common Subsequence">
<meta property="og:url" content="https://necromuralist.github.io/Bowling-For-Data/posts/longest-common-subsequence/index.html">
<meta property="og:description" content="A look at finding the longest common subsequence of two sequences.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-07-13T17:02:30-07:00">
<meta property="article:tag" content="algorithms">
<meta property="article:tag" content="dynamic programming">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../pages/" class="nav-link">Pages</a>
                </li>
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Monkey Pages</a>
            <div class="dropdown-menu">
                    <a href="https://necromuralist.github.io/" class="dropdown-item">The Cloistered Monkey</a>
                    <a href="https://necromuralist.github.io/Ape-Iron/" class="dropdown-item">Ape Iron</a>
                    <a href="https://necromuralist.github.io/Beach-Pig-Thigh/" class="dropdown-item">Beach-Pig Rump &amp; Thigh</a>
                    <a href="https://necromuralist.github.io/Neurotic-Networking/" class="dropdown-item">Neurotic Networking</a>
                    <a href="https://necromuralist.github.io/Terribilis-Ludum/" class="dropdown-item">Terribilis Ludum</a>
                    <a href="https://necromuralist.github.io/Visions-Voices-Data/" class="dropdown-item">Visions, Voices, Data</a>
            </div>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.org" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Longest Common Subsequence</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2022-07-13T17:02:30-07:00" itemprop="datePublished" title="2022-07-13 17:02">2022-07-13 17:02</time></a>
            </p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="index.html#org3c41224">The Longest Common Subsequence Problem</a></li>
<li>
<a href="index.html#org169246c">Finding The LCS</a>
<ul>
<li><a href="index.html#org6526da1">The Length-Finder</a></li>
<li><a href="index.html#org08da7a1">Implementation</a></li>
</ul>
</li>
<li><a href="index.html#org278c44e">Printing The Sequence</a></li>
<li><a href="index.html#org78e1221">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-org3c41224" class="outline-2">
<h2 id="org3c41224">The Longest Common Subsequence Problem</h2>
<div class="outline-text-2" id="text-org3c41224">
<p>
A <i>subsequence</i> of a sequence is the original sequence with zero or more elements removed from it. A <i>common subsequence</i> of two sequences is a subsequence that belongs to both sequences. With the <i>Longest Common Subsequence (LCS)</i> problem you are given two sequences - \(X = \langle x_1, x_2,\ldots,x_m\rangle\) and \(Y = \langle y_1, y_2,\ldots,y_n\rangle\) and you want to find a common subsequence of \(X\) and \(Y\) that has the maximum length (there might be more than one common subsequence that have the maximum length).
</p>

<p>
<b><b>Note:</b></b> The elements of the subsequence have to be in both sequences in the same relative order, but don't need to be consecutive. "AK" is a common subsequence of "ARK" and "BACK" because "A" and "K" appears in both sequences and the "A" comes before the "K," even though there are letters between them in both of the original sequences.
</p>
</div>
</div>

<div id="outline-container-org169246c" class="outline-2">
<h2 id="org169246c">Finding The LCS</h2>
<div class="outline-text-2" id="text-org169246c">
<p>
We basically have to look at three cases.
</p>

<p>
\[
c[i,j] = \begin{cases}
  0 &amp; \text{if } i = 0 \text{ or } j = 0\\
  c[i - 1, j - 1] + 1 &amp; \text{if } i,j &gt; 0 \text{ and } x_i = y_j\\
  \text{Max}(c[i, j-1], c[i - 1, j) &amp; \text{if } i, j &gt; 0 \text{ and } x_i \neq y_j
\end{cases}
\]
</p>

<ul class="org-ul">
<li>\(c\) is the lookup table that we will build</li>
<li>\(i\) is the index of an element in \(X\) and a row in \(c\)</li>
<li>\(j\) is the index of an element in \(Y\) and a column in \(c\)</li>
<li>\(X\) and \(Y\) use 1-based indices, not 0-based</li>
</ul>
</div>

<div id="outline-container-org6526da1" class="outline-3">
<h3 id="org6526da1">The Length-Finder</h3>
<div class="outline-text-3" id="text-org6526da1">
<p>
As with the other Dynamic Programming algorithms, our function is going to find the length of the longest sequence, not the actual sequence (this is left to another function).
</p>

<pre id="longest-common-subsequence-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Longest Common Subsequence Length Finder}
\begin{algorithmic}
\INPUT $X$: Sequence of elements
\INPUT $Y$: Sequence of elements
\OUTPUT Table of common subsequence lengths, table to reconstruct the best subsequence.
\PROCEDURE{LCS-Length}{$X, Y$}
\STATE \(m \gets X.length\)
\STATE \(n \gets Y.length\)
\STATE \(b[1\ldots m, 1 \ldots n]\) and \(c[0 \ldots m, 0 \ldots n]\) are new tables.
\FOR {\(i \in \{1 \ldots m\}\)}
    \STATE \(c[i, 0] \gets 0\)
\ENDFOR

\FOR {\(j \in \{0 \ldots n\}\)}
    \STATE \(c[0, j] \gets 0\)
\ENDFOR

\FOR {\(i \in \{1 \ldots m\}\)}
  \FOR {\(j \in \{1 \ldots n\}\)}
      \IF {\(X_i = Y_j\)}
          \STATE \(c[i, j] \gets c[i - 1, j - 1] + 1\)
          \STATE \(b[i, j] \gets "\nwarrow"\)
      \ELSEIF {\(c[i - 1, j] \geq c[i, j-1]\)}
          \STATE \(c[i, j] \gets c[i - 1, j]\)
          \STATE \(b[i, j] \gets "\uparrow" \)
      \ELSE
          \STATE \(c[i, j] \gets c[i, j - 1]\)
          \STATE \(b[i,j] \gets "\leftarrow"\)
      \ENDIF
  \ENDFOR
\ENDFOR
\RETURN $c, b$
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org08da7a1" class="outline-3">
<h3 id="org08da7a1">Implementation</h3>
<div class="outline-text-3" id="text-org08da7a1">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">attrs</span> <span class="kn">import</span> <span class="n">define</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">contain_only</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">Direction</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Direction"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"up_left"</span><span class="p">,</span> <span class="s2">"up"</span><span class="p">,</span> <span class="s2">"left"</span><span class="p">],</span>
		       <span class="n">defaults</span><span class="o">=</span><span class="p">[</span><span class="s2">"</span><span class="se">\\</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"|"</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">])()</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="nd">@define</span>
<span class="k">class</span> <span class="nc">LongestCommonSubsequence</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Finds the longest common subsequence of two sequences</span>

<span class="sd">    Args:</span>
<span class="sd">     x: first sequence</span>
<span class="sd">     y: second sequence</span>
<span class="sd">    """</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">_table</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_trace_table</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_length</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""The memoization table"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
			   <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
	    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">trace_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""Table to reconstruct longest common subsequence"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_trace_table</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
				 <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))]</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_table</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""Number of characters in longest common subsequence"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		    <span class="n">previous_row</span><span class="p">,</span> <span class="n">previous_column</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span>
		    <span class="n">unpadded_row</span><span class="p">,</span> <span class="n">unpadded_column</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span>
		    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">previous_row</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">previous_column</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_row</span><span class="p">][</span><span class="n">previous_column</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">unpadded_row</span><span class="p">][</span><span class="n">unpadded_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up_left</span>
		    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">previous_column</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">unpadded_row</span><span class="p">][</span><span class="n">unpadded_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up</span>
		    <span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">previous_column</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">unpadded_row</span><span class="p">][</span><span class="n">unpadded_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">left</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span>

    <span class="k">def</span> <span class="nf">print_lcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""Prints the elements of the longest common subsequence</span>

<span class="sd">	Note:</span>
<span class="sd">	 to start row and column should match the last cell in the trace table.</span>

<span class="sd">	Args:</span>
<span class="sd">	 row: row in the trace_table to start with</span>
<span class="sd">	 column: column in the trace_table to start with</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">column</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
	    <span class="k">return</span>

	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up_left</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
	    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
	<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
	<span class="k">return</span>

    <span class="k">def</span> <span class="nf">print_longest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
	<span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s2">"A B C B D A B"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="s2">"B D C A B A"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">lcs</span> <span class="o">=</span> <span class="n">LongestCommonSubsequence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_only</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))))</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">trace_table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">length</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org278c44e" class="outline-2">
<h2 id="org278c44e">Printing The Sequence</h2>
<div class="outline-text-2" id="text-org278c44e">
<pre id="print-lcs-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Longest Common Subsequence Printer}
\begin{algorithmic}
\INPUT $b$: Table of directions from \textsc{LCS-Length}
\INPUT $X$: Sequence of elements
\INPUT $Y$: Sequence of elements
\INPUT $i$: Row number in $b$
\INPUT $j$: Column number in $b$
\PROCEDURE{Print-LCS}{$b, X, i, j$}
\IF {\(i = 0 \text{ or } j = 0\)}
    \RETURN
\ENDIF
\IF {\(b[i, j] = "\nwarrow" \)}
    \STATE \textsc{PrintLCS}(\(b, X, i - 1, j - 1\))
    \STATE \textsc{Print}(\(X_i\))
\ELSEIF {\(b[i, j] = "\uparrow" \)}
    \STATE \textsc{PrintLCS}(\(b, X, i- 1, j \))
\ELSE
    \STATE \textsc{PrintLCS}(\(b, X, i, j - 1\))
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="n">lcs</span><span class="o">.</span><span class="n">print_longest</span><span class="p">()</span>
</pre></div>

<pre class="example">
B
C
B
A
</pre>
</div>
</div>

<div id="outline-container-org78e1221" class="outline-2">
<h2 id="org78e1221">Sources</h2>
<div class="outline-text-2" id="text-org78e1221">
<ul class="org-ul"><li>
</li></ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("longest-common-subsequence-algorithm"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("print-lcs-algorithm"));
});
</script>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/algorithms/index.html" rel="tag">algorithms</a></li>
            <li><a class="tag p-category" href="../../categories/dynamic-programming/index.html" rel="tag">dynamic programming</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../comparing-energy-prices/index.html" rel="prev" title="Comparing Energy Prices">Previous post</a>
            </li>
            <li class="next">
                <a href="../weighted-completion-times/index.html" rel="next" title="Weighted Completion Times">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script></article><!--End of body content--><footer id="footer">
            Scribbles by <a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> © 2023 - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<div id="license" xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
<span property="dct:title">Ape-Iron</span> is licensed under
<a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0
<img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a> 

            
            
        
    </div>
</footer>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</div>
</body>
</html>
