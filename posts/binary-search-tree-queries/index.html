<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Querying the Search Tree">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Binary Search Tree Queries | Bowling For Data</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/posts/binary-search-tree-queries/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="The Cloistered Monkey">
<link rel="prev" href="../binary-search-tree-node-insertion/" title="Binary Search Tree Node Insertion" type="text/html">
<meta property="og:site_name" content="Bowling For Data">
<meta property="og:title" content="Binary Search Tree Queries">
<meta property="og:url" content="https://necromuralist.github.io/Bowling-For-Data/posts/binary-search-tree-queries/">
<meta property="og:description" content="Querying the Search Tree">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-03-14T14:47:08-07:00">
<meta property="article:tag" content="algorithms">
<meta property="article:tag" content="binary search trees">
<meta property="article:tag" content="data structures">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Searchâ€¦" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.org" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Binary Search Tree Queries</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2022-03-14T14:47:08-07:00" itemprop="datePublished" title="2022-03-14 14:47">2022-03-14 14:47</time></a>
            </p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgb8b0537">A Query Class</a></li>
<li>
<a href="#org092a9f6">Search</a>
<ul>
<li><a href="#orgbe35409">The Algorithm</a></li>
<li><a href="#org738fd9a">The Iterative Version</a></li>
<li>
<a href="#org5da13ea">The Implementation</a>
<ul>
<li><a href="#org517cd5a">Testing</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#orga5c9731">Miminum and Maximum</a>
<ul>
<li>
<a href="#org71424ce">Mimimum</a>
<ul>
<li><a href="#orga25ca4b">The Implementation</a></li>
<li><a href="#orgac1990a">Testing</a></li>
</ul>
</li>
<li>
<a href="#org041e5bb">Maximum</a>
<ul>
<li><a href="#org62ffc03">The Implementation</a></li>
<li><a href="#org9b0e630">Testing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf0bcb0a">Tree Successor</a></li>
<li><a href="#orgb904fe9">Tree Predecessor</a></li>
<li><a href="#org83c9528">Sources</a></li>
</ul>
</div>
</div>
<p>
This is the next post in a series on Binary Search Trees that start with <a href="../binary-search-trees/">this post</a>. In this post we'll look at some basic queries we can make using the tree.
</p>

<div id="outline-container-orgb8b0537" class="outline-2">
<h2 id="orgb8b0537">A Query Class</h2>
<div class="outline-text-2" id="text-orgb8b0537">
<p>
The textbook(s) treat these as functions, but they seem to suggest to me methods of a class, so I'll make one.
</p>

<div class="highlight"><pre><span></span><span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Tree</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Query</span><span class="p">:</span>
    <span class="sd">"""Holds a tree and performs queries on it</span>

<span class="sd">    Args:</span>
<span class="sd">     tree: A Binary Search Tree</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span>
	<span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org092a9f6" class="outline-2">
<h2 id="org092a9f6">Search</h2>
<div class="outline-text-2" id="text-org092a9f6">
<p>
The first thing we'll look at is searching for a Node in a Binary Search Tree. Because of the way the tree is structured the search looks a lot like a <a href="../binary-search/">Binary Search</a> where we start at the root of the tree and then work our way downwards, picking the next child to follow based on whether the key we're searching for is greater than the right child's key or less than the left child's key. If it's equal then we've found the node we want.
</p>
</div>

<div id="outline-container-orgbe35409" class="outline-3">
<h3 id="orgbe35409">The Algorithm</h3>
<div class="outline-text-3" id="text-orgbe35409">
<pre id="tree-search" style="display:hidden;">
\begin{algorithm}
\caption{TreeSearch}
\begin{algorithmic}
\INPUT The Node to start searching from and the key to search for.
\OUTPUT If a node with the key is in the tree, then it will output the node.
\PROCEDURE{TreeSearch}{x, key}
\IF {\textit{x} = \textsc{NIL} or key = \textit{x}.key}
  \RETURN \textit{x}
\ENDIF

\IF {key &lt; \textit{x}.key}
    \RETURN \textsc{TreeSearch}(\textit{x}.left, key)
\ELSE
    \RETURN \textsc{TreeSearch}(\textit{x}.right, key)
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>
<div id="outline-container-org738fd9a" class="outline-3">
<h3 id="org738fd9a">The Iterative Version</h3>
<div class="outline-text-3" id="text-org738fd9a">
<p>
The recursive version of <code>TreeSearch</code> is quite nice, but it also translates easily to an iterative version if for some reason performance or size becomes a problem.
</p>

<pre id="iterative-tree-search" style="display:hidden;">
\begin{algorithm}
\caption{IterativeTreeSearch}
\begin{algorithmic}
\INPUT The Node to start searching from and the key to search for.
\OUTPUT If a node with the key is in the tree, then it will output the node.
\PROCEDURE{IterativeTreeSearch}{x, key}
\WHILE {\textit{x} $\neq$ \textsc{NIL} and key $\neq$ \textit{x}.key}
  \IF {key &lt; \textit{x}.key}
   \STATE \textit{x} $\gets$ \textit{x}.left
  \ELSE
   \STATE \textit{x} $\gets$ \textit{x}.right
  \ENDIF
\ENDWHILE
\RETURN \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>
<div id="outline-container-org5da13ea" class="outline-3">
<h3 id="org5da13ea">The Implementation</h3>
<div class="outline-text-3" id="text-org5da13ea">
<p>
I'll add the iterative version of the Tree Search as a method for our Query class.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Searches the tree for the node with the matching key</span>

<span class="sd">    Args:</span>
<span class="sd">     key: node's key to search for</span>

<span class="sd">    Returns:</span>
<span class="sd">     the node with the key or None if it isn't in the tree</span>
<span class="sd">    """</span>
    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span>
    <span class="k">while</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
	<span class="k">if</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
	    <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span>
	<span class="k">else</span><span class="p">:</span>
	   <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span>
    <span class="k">return</span> <span class="n">node</span>
</pre></div>
</div>
<div id="outline-container-org517cd5a" class="outline-4">
<h4 id="org517cd5a">Testing</h4>
<div class="outline-text-4" id="text-org517cd5a">
<div class="highlight"><pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">be</span><span class="p">,</span><span class="n">be_none</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Tree</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree.query</span> <span class="kn">import</span> <span class="n">Query</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>

<span class="n">five</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">five</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">five</span><span class="p">))</span>

<span class="n">fifteen</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">fifteen</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">fifteen</span><span class="p">))</span>
</pre></div>

<p>
I'll have to think of something more interesting to show for thisâ€¦
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orga5c9731" class="outline-2">
<h2 id="orga5c9731">Miminum and Maximum</h2>
<div class="outline-text-2" id="text-orga5c9731">
</div>
<div id="outline-container-org71424ce" class="outline-3">
<h3 id="org71424ce">Mimimum</h3>
<div class="outline-text-3" id="text-org71424ce">
<pre id="tree-minimum" style="display:hidden;">
\begin{algorithm}
\caption{TreeMinimum}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the smallest key.
\PROCEDURE{TreeMinimum}{x}
\WHILE {\textit{x}.left $\neq$ \textsc{NIL}}
   \STATE \textit{x} $\gets$ \textit{x}.left
\ENDWHILE
\RETURN \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>

<div id="outline-container-orga25ca4b" class="outline-4">
<h4 id="orga25ca4b">The Implementation</h4>
<div class="outline-text-4" id="text-orga25ca4b">
<p>
I originally didn't take the root node as an argument, since I thought the minimum of the tree is always the smallest item. But this method gets used later on in the <code>successor</code> method where we want to find the smallest item in the right-subtree of a particular node, so the outcome won't necessarily be the smallest item in the tree.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the node with the smallest key</span>

<span class="sd">    Args:</span>
<span class="sd">     node: a node to use as the starting root</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span>

    <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span>
    <span class="k">return</span> <span class="n">node</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgac1990a" class="outline-4">
<h4 id="orgac1990a">Testing</h4>
<div class="outline-text-4" id="text-orgac1990a">
<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org041e5bb" class="outline-3">
<h3 id="org041e5bb">Maximum</h3>
<div class="outline-text-3" id="text-org041e5bb">
<pre id="tree-maximum" style="display:hidden;">
\begin{algorithm}
\caption{TreeMaximum}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the largest key.
\PROCEDURE{TreeMaximum}{x}
\WHILE {\textit{x}.right $\neq$ \textsc{NIL}}
   \STATE \textit{x} $\gets$ \textit{x}.right
\ENDWHILE
\RETURN \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>

<div id="outline-container-org62ffc03" class="outline-4">
<h4 id="org62ffc03">The Implementation</h4>
<div class="outline-text-4" id="text-org62ffc03">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the node with the largest key</span>

<span class="sd">    Args:</span>
<span class="sd">     root: subtree root to start at</span>

<span class="sd">    Returns:</span>
<span class="sd">     node with the largest key in tree/subtree</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span>
    <span class="k">while</span> <span class="n">root</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">right</span>
    <span class="k">return</span> <span class="n">root</span>
</pre></div>
</div>
</div>
<div id="outline-container-org9b0e630" class="outline-4">
<h4 id="org9b0e630">Testing</h4>
<div class="outline-text-4" id="text-org9b0e630">
<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf0bcb0a" class="outline-2">
<h2 id="orgf0bcb0a">Tree Successor</h2>
<div class="outline-text-2" id="text-orgf0bcb0a">
<p>
A "Successor" node is the next largest node after a given node. Since all the nodes in a right subtree are greater than the node, it's the smallest node in the right (if it exists). If the right subtree is empty then we traverse up the ancestors of the node until we find the first one that is greater than our node.
</p>

<pre id="tree-successor" style="display:hidden;">
\begin{algorithm}
\caption{TreeSuccessor}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the next largest key.
\PROCEDURE{TreeSuccessor}{x}
\IF {\textit{x}.right $\neq$ \textsc{NIL}}
  \RETURN \textsc{TreeMinimum}(\textit{x}.right)
\ENDIF

\STATE \textit{y} $\gets$ \textit{x}.parent

\WHILE {\textit{y} $\neq$ \textsc{NIL} and \textit{x} = \textit{y}.right}
   \STATE \textit{x} $\gets$ \textit{y}
   \STATE \textit{y} $\gets$ \textit{y}.parent
\ENDWHILE
\RETURN \textit{y}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">successor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the next largest node</span>

<span class="sd">    Args:</span>
<span class="sd">     node: the node who's successor to find</span>

<span class="sd">    Returns:</span>
<span class="sd">     successor node to the input node</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>

    <span class="n">successor</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">while</span> <span class="n">successor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node</span> <span class="o">==</span> <span class="n">successor</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
	<span class="n">node</span> <span class="o">=</span> <span class="n">successor</span>
	<span class="n">successor</span> <span class="o">=</span> <span class="n">successor</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">return</span> <span class="n">successor</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgb904fe9" class="outline-2">
<h2 id="orgb904fe9">Tree Predecessor</h2>
<div class="outline-text-2" id="text-orgb904fe9">
<p>
Similar in concept to a node successor, a node <i>predecessor</i> is the largest node less than the given node.
</p>

<pre id="tree-predecessor" style="display:hidden;">
\begin{algorithm}
\caption{TreePredecessor}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the next smallest key.
\PROCEDURE{TreePredecessor}{x}
\IF {\textit{x}.left $\neq$ \textsc{NIL}}
  \RETURN \textsc{TreeMaximum}(\textit{x}.right)
\ENDIF

\STATE \textit{y} $\gets$ \textit{x}.parent

\WHILE {\textit{y} $\neq$ \textsc{NIL} and \textit{x} = \textit{y}.left}
   \STATE \textit{x} $\gets$ \textit{y}
   \STATE \textit{y} $\gets$ \textit{y}.parent
\ENDWHILE
\RETURN \textit{y}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predecessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the predecessor node</span>

<span class="sd">    Args:</span>
<span class="sd">     node: the node whose predecessor we want</span>

<span class="sd">    Returns:</span>
<span class="sd">     largest node smaller than given node</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="n">predecessor</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">while</span> <span class="n">predecessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node</span> <span class="o">==</span> <span class="n">predecessor</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
	<span class="n">node</span><span class="p">,</span> <span class="n">predecessor</span> <span class="o">=</span> <span class="n">predecessor</span><span class="p">,</span> <span class="n">predecessor</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">return</span> <span class="n">predecessor</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org83c9528" class="outline-2">
<h2 id="org83c9528">Sources</h2>
<div class="outline-text-2" id="text-org83c9528">
<ul class="org-ul">
<li><a href="../clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-search"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("iterative-tree-search"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-minimum"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-maximum"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-successor"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-predecessor"));
});
</script>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/algorithms/" rel="tag">algorithms</a></li>
            <li><a class="tag p-category" href="../../categories/binary-search-trees/" rel="tag">binary search trees</a></li>
            <li><a class="tag p-category" href="../../categories/data-structures/" rel="tag">data structures</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../binary-search-tree-node-insertion/" rel="prev" title="Binary Search Tree Node Insertion">Previous post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script></article><!--End of body content--><footer id="footer"><a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
 <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
