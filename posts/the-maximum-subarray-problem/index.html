<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Maximum-Subarray Problem | Bowling For Data</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/posts/the-maximum-subarray-problem/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="The Cloistered Monkey">
<link rel="prev" href="../shortest-paths-dijkstras-algorithm/" title="Shortest Paths: Dijkstra's Algorithm" type="text/html">
<link rel="next" href="../karatsuba-multiplication/" title="Karatsuba Multiplication" type="text/html">
<meta property="og:site_name" content="Bowling For Data">
<meta property="og:title" content="The Maximum-Subarray Problem">
<meta property="og:url" content="https://necromuralist.github.io/Bowling-For-Data/posts/the-maximum-subarray-problem/">
<meta property="og:description" content="Table of Contents


Imports and Setup

Imports
Set Up


Implementations

Test Case
Brute Force
Recursive

Max-Crossing-Subarray
Max-Subarray


Alternate Version


Comparing the Methods



Plot It




">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-05-07T16:49:09-07:00">
<meta property="article:tag" content="algorithms">
<meta property="article:tag" content="divide-and-conquer">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Searchâ€¦" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.org" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">The Maximum-Subarray Problem</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2022-05-07T16:49:09-07:00" itemprop="datePublished" title="2022-05-07 16:49">2022-05-07 16:49</time></a>
            </p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="#orgf7b8032">Imports and Setup</a>
<ul>
<li><a href="#org5531722">Imports</a></li>
<li><a href="#org58103ec">Set Up</a></li>
</ul>
</li>
<li>
<a href="#org5509fda">Implementations</a>
<ul>
<li><a href="#orgea83f91">Test Case</a></li>
<li><a href="#org15db316">Brute Force</a></li>
<li>
<a href="#orgd213b92">Recursive</a>
<ul>
<li><a href="#org402cac4">Max-Crossing-Subarray</a></li>
<li><a href="#org959d19f">Max-Subarray</a></li>
</ul>
</li>
<li><a href="#org0bae59a">Alternate Version</a></li>
</ul>
</li>
<li>
<a href="#org1111e1a">Comparing the Methods</a>
<ul>
<li>
<ul>
<li><a href="#org51dc9e7">Plot It</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org549e7b0">Sources</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgf7b8032" class="outline-2">
<h2 id="orgf7b8032">Imports and Setup</h2>
<div class="outline-text-2" id="text-orgf7b8032">
</div>
<div id="outline-container-org5531722" class="outline-3">
<h3 id="org5531722">Imports</h3>
<div class="outline-text-3" id="text-org5531722">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">inf</span> <span class="k">as</span> <span class="n">infinity</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log2</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># my stuff</span>
<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
</pre></div>
</div>
</div>

<div id="outline-container-org58103ec" class="outline-3">
<h3 id="org58103ec">Set Up</h3>
<div class="outline-text-3" id="text-org58103ec">
<div class="highlight"><pre><span></span><span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>

<span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"the-maximum-subarray-problem"</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="n">SLUG</span><span class="p">)</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>

<span class="n">MAXIMUM_SUBARRAY</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">Case</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Case"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"inputs"</span><span class="p">,</span> <span class="s2">"left"</span><span class="p">,</span> <span class="s2">"right"</span><span class="p">,</span> <span class="s2">"max"</span><span class="p">])</span>

<span class="n">Plot</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Plot"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"height"</span><span class="p">,</span> <span class="s2">"width"</span><span class="p">],</span> <span class="n">defaults</span><span class="o">=</span><span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">PLOT</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">()</span>

<span class="n">Output</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Output"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"start"</span><span class="p">,</span> <span class="s2">"end"</span><span class="p">,</span> <span class="s2">"gain"</span><span class="p">,</span> <span class="s2">"runtime"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-org5509fda" class="outline-2">
<h2 id="org5509fda">Implementations</h2>
<div class="outline-text-2" id="text-org5509fda">
<p>
The motivation given by the text is that we have some data that varies over time and we want to find the pair of points that maximizes the gain from the first point to the second.
</p>
</div>

<div id="outline-container-orgea83f91" class="outline-3">
<h3 id="orgea83f91">Test Case</h3>
<div class="outline-text-3" id="text-orgea83f91">
<div class="highlight"><pre><span></span><span class="n">CASE_ONE</span> <span class="o">=</span> <span class="n">Case</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span>
		 <span class="mi">101</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">97</span><span class="p">],</span>
		<span class="n">left</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
		<span class="n">right</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
		<span class="nb">max</span><span class="o">=</span><span class="mi">43</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">changes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Numbers"</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
			  <span class="s2">"Change"</span><span class="p">:</span> <span class="n">changes</span><span class="p">})</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">melted</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"index"</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Numbers"</span><span class="p">,</span> <span class="s2">"Change"</span><span class="p">]</span> <span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">"Data Source"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Data"</span><span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"index"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"quantitative"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Data"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"quantitative"</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Data Source"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Sample Input One"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">PLOT</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"sample-input-one"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="sample-input-one.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>

<div id="outline-container-org15db316" class="outline-3">
<h3 id="org15db316">Brute Force</h3>
<div class="outline-text-3" id="text-org15db316">
<p>
The first way we're going to find the maximum gain is using Brute Force - we're going to calculate the gain for each pair of points and picking the pair with the best gain. Since this involves checking every pair we're essentially looking at a Handshake Problem so the number of comparisons should be \(\frac{n(n - 1)}{2}\) or \(\Theta(n^2)\).
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">brute_force_maximum_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Output</span><span class="p">:</span>
    <span class="sd">"""Finds the subarray with maximum gain</span>

<span class="sd">    Args:</span>
<span class="sd">     source: sequence with sub-array to maximize</span>

<span class="sd">    Returns:</span>
<span class="sd">     (left-max-index, right-max-index, gain, count)</span>
<span class="sd">    """</span>
    <span class="n">best_left</span> <span class="o">=</span> <span class="n">best_right</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_gain</span> <span class="o">=</span> <span class="o">-</span><span class="n">infinity</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">left</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)):</span>
	    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">gain</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">-</span> <span class="n">source</span><span class="p">[</span><span class="n">left</span><span class="p">]</span>
	    <span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">best_gain</span><span class="p">:</span>
		<span class="n">best_left</span><span class="p">,</span> <span class="n">best_right</span><span class="p">,</span> <span class="n">best_gain</span> <span class="o">=</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">gain</span>
    <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="n">best_left</span><span class="p">,</span> <span class="n">best_right</span><span class="p">,</span> <span class="n">best_gain</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">brute_force_maximum_subarray</span><span class="p">(</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">left</span>
<span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">right</span>
<span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">gain</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">max</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"count = </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">runtime</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n(n-1)/2 = </span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n^2 = </span><span class="si">{</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
n = 17
count = 136
n(n-1)/2 = 136
n^2 = 289
</pre>
</div>
</div>

<div id="outline-container-orgd213b92" class="outline-3">
<h3 id="orgd213b92">Recursive</h3>
<div class="outline-text-3" id="text-orgd213b92">
<p>
Looking at the brute-force solution you might think - "That was a check of point-pairs, why is this called 'max-subarray'?". Well, we're going to improve upon the brute-force implementation by doing a data-transformation. If you look at the data that we set up you might notice that there's the point values and then there's the change in value from one point to another. The changes are there because we can re-think our problem not as the maximum of increases between pair points, but instead as the maximum of point-change-sums. 
</p>

<p>
In our <code>CASE_ONE</code> inputs, the biggest gain came from point 7 (with a value of 63) and point 11 (with a value of 106). If we look at the difference between consecutive points from points 7 to 11 we get 
-23, 18, 20, -7, 12 which sums to 20, which is the maximum sub-array total for this data set. To solve this problem we're going to need to find this sub-array. Since we stated that we're going to use a divide-and-conquer approach we know that we're going to repeatedly break the inputs up into (in this case) two separate sub-sets to solve. Every time we break the inputs into two groups we end up with three possibilities as to where the maximum sub-array lies:
</p>

<ul class="org-ul">
<li>in the left half</li>
<li>in the right half</li>
<li>crossing from the left half over the split to the right half</li>
</ul>
</div>

<div id="outline-container-org402cac4" class="outline-4">
<h4 id="org402cac4">Max-Crossing-Subarray</h4>
<div class="outline-text-4" id="text-org402cac4">
<p>
This is a function that will find the best subarray in the left and in the right halves of the sub-array and combines them to find the gain across the mid-point of the subarray.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_max_crossing_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
			       <span class="n">low</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
			       <span class="n">high</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Output</span><span class="p">:</span>
    <span class="sd">"""Find the max subarray that crosses the mid-point</span>

<span class="sd">    Args:</span>
<span class="sd">     source: the array to search for the sub-sequence in</span>
<span class="sd">     low: the lower-bound for the indices to search within</span>
<span class="sd">     mid: the mid-index between low and high</span>
<span class="sd">     high: the upper-bound for the indices to search within</span>

<span class="sd">    Returns:</span>
<span class="sd">     left-index, right-index, gain, count</span>
<span class="sd">    """</span>
    <span class="n">count</span><span class="p">,</span> <span class="n">best_left</span><span class="p">,</span> <span class="n">best_right</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">left_gain</span> <span class="o">=</span> <span class="n">right_gain</span> <span class="o">=</span> <span class="o">-</span><span class="n">infinity</span>
    <span class="n">gain</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">left</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="n">gain</span> <span class="o">+=</span> <span class="n">source</span><span class="p">[</span><span class="n">left</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">left_gain</span><span class="p">:</span>
	    <span class="n">left_gain</span> <span class="o">=</span> <span class="n">gain</span>
	    <span class="n">best_left</span> <span class="o">=</span> <span class="n">left</span>
    <span class="n">gain</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="n">gain</span> <span class="o">+=</span> <span class="n">source</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">right_gain</span><span class="p">:</span>
	    <span class="n">right_gain</span> <span class="o">=</span> <span class="n">gain</span>
	    <span class="n">best_right</span> <span class="o">=</span> <span class="n">right</span>
    <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="n">best_left</span><span class="p">,</span> <span class="n">best_right</span><span class="p">,</span> <span class="n">left_gain</span> <span class="o">+</span> <span class="n">right_gain</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-org959d19f" class="outline-4">
<h4 id="org959d19f">Max-Subarray</h4>
<div class="outline-text-4" id="text-org959d19f">
<p>
The <code>find_maximum_subarray</code> function finds the start and end indices for the best gain.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_maximum_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
			  <span class="n">low</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">high</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Output</span><span class="p">:</span>
    <span class="sd">"""Find the sub-array that maximizes gain</span>

<span class="sd">    Args:</span>
<span class="sd">     source: sequence to maximize</span>
<span class="sd">     low: lower-bound for indices in source</span>
<span class="sd">     high: upper-bound for indices in source</span>

<span class="sd">    Returns:</span>
<span class="sd">     left-index, right-index, gain, count</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">high</span> <span class="o">==</span> <span class="n">low</span><span class="p">:</span>
	<span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">source</span><span class="p">[</span><span class="n">low</span><span class="p">],</span> <span class="mi">1</span>

    <span class="k">else</span><span class="p">:</span>
	<span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

	<span class="n">left</span> <span class="o">=</span> <span class="n">find_maximum_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
	<span class="n">right</span> <span class="o">=</span> <span class="n">find_maximum_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
	<span class="n">cross_mid</span> <span class="o">=</span> <span class="n">find_max_crossing_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>

	<span class="n">count</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">runtime</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">runtime</span> <span class="o">+</span> <span class="n">cross_mid</span><span class="o">.</span><span class="n">runtime</span>

	<span class="n">best_gain</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">gain</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">gain</span><span class="p">,</span> <span class="n">cross_mid</span><span class="o">.</span><span class="n">gain</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">left</span><span class="o">.</span><span class="n">gain</span> <span class="o">==</span> <span class="n">best_gain</span><span class="p">:</span>
	    <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">left</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">left</span><span class="o">.</span><span class="n">gain</span><span class="p">,</span> <span class="n">count</span>
	<span class="k">elif</span> <span class="n">right</span><span class="o">.</span><span class="n">gain</span> <span class="o">==</span> <span class="n">best_gain</span><span class="p">:</span>
	    <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">gain</span><span class="p">,</span> <span class="n">count</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="p">(</span><span class="n">cross_mid</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">cross_mid</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
				       <span class="n">cross_mid</span><span class="o">.</span><span class="n">gain</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>

<p>
The <code>maximum_subarray</code> converts our list of values to a list of changes between consecutive values so that we can use our divide-and-conquer function.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">maximum_subarray</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Output</span><span class="p">:</span>
    <span class="sd">"""Finds the sub-array with maximum gain</span>

<span class="sd">    Args:</span>
<span class="sd">     source: array to maximize</span>

<span class="sd">    Returns:</span>
<span class="sd">     left-index, right-index, gain, count</span>
<span class="sd">    """</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">changes</span> <span class="o">=</span> <span class="p">[</span><span class="n">source</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">source</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">end</span><span class="p">)]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">find_maximum_subarray</span><span class="p">(</span><span class="n">changes</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># our 'changes' has one fewer entry than the original list so up the right index by 1</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">gain</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">runtime</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">maximum_subarray</span><span class="p">(</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">left</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">"</span>
<span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">right</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">"</span>
<span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">gain</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">gain</span><span class="si">}</span><span class="s2">"</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"left: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">, right: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">, gain: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">gain</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"count = </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">runtime</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n(n-1)/2 = </span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n log n : </span><span class="si">{</span><span class="n">n</span> <span class="o">*</span> <span class="n">log2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="si">:</span><span class="s2"> 0.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n^2 = </span><span class="si">{</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
n = 17
left: 7, right: 11, gain: 43
count = 50
n(n-1)/2 = 136
n log n :  69.49
n^2 = 289
</pre>


<p>
By transforming the problem to one that lets us use divide-and-conquer we reduced the number of comparisons from 136 to 50. More generally, if we look at <code>find_maximum_subarray</code> we see that we're splitting the input in half before each of the recursive calls so we're going to make \(log_2 n\) splits and at each level of the recursions tree we're going to have \(2n\) inputs (<code>left</code> and <code>right</code> are each \(\frac{1}{2} n\) and <code>cross_mid</code> uses \(n\)) so we're going from \(\Theta(n^2)\) for the brute-force verios to \(\Theta(n \log n)\) for the divide-and-conquer version.
</p>
</div>
</div>
</div>
<div id="outline-container-org0bae59a" class="outline-3">
<h3 id="org0bae59a">Alternate Version</h3>
<div class="outline-text-3" id="text-org0bae59a">
<p>
Let's try another version that uses the idea of summing the changes between consecutive points but doesn't use recursion (see <a href="https://en.wikipedia.org/wiki/Maximum_subarray_problem#Computing_the_best_subarray's_position">Wikipedia: Kardane's algorithm</a>).
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">max_subarray_2</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Output</span><span class="p">:</span>
    <span class="sd">"""Gets the maximal subarray</span>

<span class="sd">    This is an alternate version that doesn't use recursion or brute-force</span>

<span class="sd">    Args:</span>
<span class="sd">     source: sequence to maximize</span>

<span class="sd">    Returns:</span>
<span class="sd">     left-index, right-index, gain, count</span>
<span class="sd">    """</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">best_total</span> <span class="o">=</span> <span class="o">-</span><span class="n">infinity</span>
    <span class="n">best_start</span> <span class="o">=</span> <span class="n">best_end</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">current_total</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">changes</span> <span class="o">=</span> <span class="p">[</span><span class="n">source</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">source</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">here</span><span class="p">,</span> <span class="n">value_here</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">changes</span><span class="p">):</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">current_total</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
	    <span class="n">current_start</span> <span class="o">=</span> <span class="n">here</span>
	    <span class="n">current_total</span> <span class="o">=</span> <span class="n">value_here</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">current_total</span> <span class="o">+=</span> <span class="n">value_here</span>

	<span class="k">if</span> <span class="n">current_total</span> <span class="o">&gt;</span> <span class="n">best_total</span><span class="p">:</span>
	    <span class="n">best_total</span> <span class="o">=</span> <span class="n">current_total</span>
	    <span class="n">best_start</span> <span class="o">=</span> <span class="n">current_start</span>
	    <span class="n">best_end</span> <span class="o">=</span> <span class="n">here</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">Output</span><span class="p">(</span><span class="n">best_start</span><span class="p">,</span> <span class="n">best_end</span><span class="p">,</span> <span class="n">best_total</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">max_subarray_2</span><span class="p">(</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">left</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">left</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s2">"</span>
<span class="k">assert</span> <span class="n">right</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">right</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s2">"</span>
<span class="k">assert</span> <span class="n">gain</span> <span class="o">==</span> <span class="n">CASE_ONE</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected: </span><span class="si">{</span><span class="n">CASE_ONE</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">, Actual: </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s2">"</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"left: </span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s2">, right: </span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s2">, gain: </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Count: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
n = 17
left: 7, right: 11, gain: 43
Count: 17
</pre>


<p>
So, without using divide-and-conquer we get an even better runtime - it was the data transformation that was the most valuable part in improving the performance.
</p>
</div>
</div>
</div>

<div id="outline-container-org1111e1a" class="outline-2">
<h2 id="org1111e1a">Comparing the Methods</h2>
<div class="outline-text-2" id="text-org1111e1a">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_thing</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"*** </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> ***"</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">runtime</span> <span class="o">=</span> <span class="n">thing</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="n">runtime</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\t</span><span class="s2">Elapsed Time: </span><span class="si">{</span><span class="n">stop</span> <span class="o">-</span> <span class="n">start</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">runtime</span>

<span class="n">brutes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">divided</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">linear</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">UPPER</span> <span class="o">=</span> <span class="mi">6</span>
<span class="k">for</span> <span class="n">exponent</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">UPPER</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">exponent</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">underline</span> <span class="o">=</span> <span class="s2">"="</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">underline</span><span class="p">)</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
    <span class="n">brutes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_thing</span><span class="p">(</span><span class="n">brute_force_maximum_subarray</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">"Brute Force"</span><span class="p">))</span>
    <span class="n">divided</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_thing</span><span class="p">(</span><span class="n">maximum_subarray</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">"Divide and Conquer"</span><span class="p">))</span>
    <span class="n">linear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_thing</span><span class="p">(</span><span class="n">max_subarray_2</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">))</span>
    <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</pre></div>

<pre class="example">

n = 10
======
*** Brute Force ***
	Elapsed Time: 0:00:00.001054
*** Divide and Conquer ***
	Elapsed Time: 0:00:00.000249
*** Linear ***
	Elapsed Time: 0:00:00.000127

n = 100
=======
*** Brute Force ***
	Elapsed Time: 0:00:00.002403
*** Divide and Conquer ***
	Elapsed Time: 0:00:00.002198
*** Linear ***
	Elapsed Time: 0:00:00.000175

n = 1,000
=========
*** Brute Force ***
	Elapsed Time: 0:00:00.002527
*** Divide and Conquer ***
	Elapsed Time: 0:00:00.017359
*** Linear ***
	Elapsed Time: 0:00:00.002204

n = 10,000
==========
*** Brute Force ***
	Elapsed Time: 0:00:00.071900
*** Divide and Conquer ***
	Elapsed Time: 0:00:00.044104
*** Linear ***
	Elapsed Time: 0:00:00.000224

n = 100,000
===========
*** Brute Force ***
	Elapsed Time: 0:00:07.506323
*** Divide and Conquer ***
	Elapsed Time: 0:00:00.023113
*** Linear ***
	Elapsed Time: 0:00:00.001233
</pre>
</div>

<div id="outline-container-org51dc9e7" class="outline-4">
<h4 id="org51dc9e7">Plot It</h4>
<div class="outline-text-4" id="text-org51dc9e7">
<div class="highlight"><pre><span></span><span class="n">runtimes</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Brute Force"</span><span class="p">:</span> <span class="n">brutes</span><span class="p">,</span>
			     <span class="s2">"Divide and Conquer"</span><span class="p">:</span> <span class="n">divided</span><span class="p">,</span>
			     <span class="s2">"Linear"</span><span class="p">:</span> <span class="n">linear</span><span class="p">,</span>
			     <span class="s2">"Input Size"</span><span class="p">:</span> <span class="n">counts</span><span class="p">})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">runtimes</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Input Size"</span><span class="p">],</span>
		       <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Brute Force"</span><span class="p">,</span> <span class="s2">"Divide and Conquer"</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">],</span>
		       <span class="n">var_name</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Comparisons"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">OverlayMarkDef</span><span class="p">())</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Input Size"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"quantitative"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Comparisons"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"quantitative"</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Algorithm"</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Comparison Counts"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">PLOT</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"algorithm_comparisons"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="algorithm_comparisons.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
Stepping up to a million with Brute Force takes too long (I've never let it run to the end to see how long). Let's see if the linear and divide and conquer can handle it, though.
</p>

<div class="highlight"><pre><span></span><span class="n">linear_more</span> <span class="o">=</span> <span class="n">linear</span><span class="p">[:]</span>
<span class="n">divided_more</span> <span class="o">=</span> <span class="n">divided</span><span class="p">[:]</span>
<span class="n">counts_more</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[:]</span>

<span class="k">for</span> <span class="n">exponent</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">exponent</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">underline</span> <span class="o">=</span> <span class="s2">"="</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">underline</span><span class="p">)</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>

    <span class="n">linear_more</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_thing</span><span class="p">(</span><span class="n">max_subarray_2</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">))</span>
    <span class="n">divided_more</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_thing</span><span class="p">(</span><span class="n">maximum_subarray</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">"Divide and Conquer"</span><span class="p">))</span>
    <span class="n">counts_more</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</pre></div>

<pre class="example">

n = 1,000,000
=============
*** Linear ***
	Elapsed Time: 0:00:00.008010
*** Divide and Conquer ***
	Elapsed Time: 0:00:00.294771

n = 10,000,000
==============
*** Linear ***
	Elapsed Time: 0:00:00.169138
*** Divide and Conquer ***
	Elapsed Time: 0:00:02.018406

n = 100,000,000
===============
*** Linear ***
	Elapsed Time: 0:00:00.850640
*** Divide and Conquer ***
	Elapsed Time: 0:00:21.290975

n = 1,000,000,000
=================
*** Linear ***
	Elapsed Time: 0:00:07.666758
*** Divide and Conquer ***
	Elapsed Time: 0:03:32.097027
</pre>

<p>
They do pretty well, it seems to be the brute force that dies out.
</p>

<div class="highlight"><pre><span></span><span class="n">longtimes</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Linear"</span><span class="p">:</span> <span class="n">linear_more</span><span class="p">,</span>
			      <span class="s2">"Divide &amp; Conquer"</span><span class="p">:</span> <span class="n">divided_more</span><span class="p">,</span>
			      <span class="s2">"Input Size"</span><span class="p">:</span> <span class="n">counts_more</span><span class="p">})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">longtimes</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Input Size"</span><span class="p">],</span>
		       <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Divide &amp; Conquer"</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">],</span>
		       <span class="n">var_name</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Comparisons"</span><span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">OverlayMarkDef</span><span class="p">())</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Input Size"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"quantitative"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Comparisons"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"quantitative"</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Comparison Counts"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">PLOT</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"longer_algorithm_comparisons"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="longer_algorithm_comparisons.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>

<div id="outline-container-org549e7b0" class="outline-2">
<h2 id="org549e7b0">Sources</h2>
<div class="outline-text-2" id="text-org549e7b0">
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Maximum_subarray_problem">Wikipedia: Maximum Subarray Problem</a></li>
<li><a href="../clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/algorithms/" rel="tag">algorithms</a></li>
            <li><a class="tag p-category" href="../../categories/divide-and-conquer/" rel="tag">divide-and-conquer</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../shortest-paths-dijkstras-algorithm/" rel="prev" title="Shortest Paths: Dijkstra's Algorithm">Previous post</a>
            </li>
            <li class="next">
                <a href="../karatsuba-multiplication/" rel="next" title="Karatsuba Multiplication">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script></article><!--End of body content--><footer id="footer"><a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
 <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
