<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Striking out for data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bowling For Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/">
<link rel="next" href="index-7.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/the-activity-selection-problem/" type="text/html">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href=".">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-activity-selection-problem/" class="u-url">The Activity Selection Problem</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-activity-selection-problem/" rel="bookmark">
            <time class="published dt-published" datetime="2022-08-04T17:25:35-07:00" itemprop="datePublished" title="2022-08-04 17:25">2022-08-04 17:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/the-activity-selection-problem/#orgd48e4dc">What is the Activity Selection Problem?</a></li>
<li><a href="posts/the-activity-selection-problem/#orgca59225">The Greedy Choice</a></li>
<li>
<a href="posts/the-activity-selection-problem/#org5838604">The Recursive Activity Selector</a>
<ul>
<li><a href="posts/the-activity-selection-problem/#org767a1a0">Padding The Start</a></li>
</ul>
</li>
<li><a href="posts/the-activity-selection-problem/#orgabb4fb6">The Iterative Activity Selector</a></li>
<li><a href="posts/the-activity-selection-problem/#orgbd447f5">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgd48e4dc" class="outline-2">
<h2 id="orgd48e4dc">What is the Activity Selection Problem?</h2>
<div class="outline-text-2" id="text-orgd48e4dc">
<ul class="org-ul">
<li>In this problem we have a set of <i>n</i> activities \(S = \{a_1, a_2, \ldots, a_n\}\).</li>
<li>Assume the activities are sorted by increasing finish time</li>
<li>Each activity has a start time \(s_i\) and a finish time \(f_i\)</li>
<li>Only one activity can happen at a time.</li>
<li>Two activities are <i>compatible</i> if the earlier event finishes before the start time of the other event.</li>
</ul>
<p>
The problem we want to solve is finding the most compatible activities we can from our set of activities. This differs from a more common scheduling problem in that the times are fixed - we can't re-arrange activities to make them fit so they either can happen or they can't.
</p>
</div>
</div>

<div id="outline-container-orgca59225" class="outline-2">
<h2 id="orgca59225">The Greedy Choice</h2>
<div class="outline-text-2" id="text-orgca59225">
<p>
<a href="posts/clrs/">CLRS</a> goes into the more formal aspects of finding the optimal substructure and proving that a greedy strategy works, but in this case the reasoning is fairly intuitive (and I didn't find the proof so easy to follow) so I'll skip the formal stuff. The thing to recognize is just that the sooner the first activity you schedule finishes the more time there is for other activities. So if after each activity you pick you then pick the next compatible activity that finishes first you will be maximizing the number of activities that you can schedule.
</p>
</div>
</div>

<div id="outline-container-org5838604" class="outline-2">
<h2 id="org5838604">The Recursive Activity Selector</h2>
<div class="outline-text-2" id="text-org5838604">
<pre id="recursive-activity-selector" style="display:hidden;">
\begin{algorithm}
\caption{Recursive Activity Selector}
\begin{algorithmic}
\REQUIRE The activities are sorted in non-decreasing order of finish time
\INPUT $s$: The array of start times for the activities.
\INPUT $f$: The array of finish times for the activities.
\INPUT $k$: The last activity selected so far.
\INPUT $n$: The number of activities.
\OUTPUT The activities that maximize the number of compatible activities.
\PROCEDURE{RecursiveActivitySelector}{$s, f, k, n$}

\STATE \(m \gets k + 1\)

\WHILE {\(m \le n\) and \(s[m] &lt; f[k]\)}
  \STATE \(m \gets m + 1\)
\ENDWHILE

\IF {\(m \le n\)}
  \RETURN \(\{a_m\} \cup \) \textsc{RecursiveActivitySelector}(\(s, f, m, n\))
\ELSE
  \RETURN \{\}
\ENDIF

\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
<b><b>Note:</b></b> The activity set (\(\{a_1, a_2, \ldots, a_n\}\)) is treated as a global collection so it is used in the function but not passed in as an argument.
</p>
</div>

<div id="outline-container-org767a1a0" class="outline-3">
<h3 id="org767a1a0">Padding The Start</h3>
<div class="outline-text-3" id="text-org767a1a0">
<p>
Because the recursive algorithm is looking for the next earliest finish time after the first event we need to pad the activities with a dummy activity that has a finish time of 0 (\(f_0 = 0\)) and then when the function is first called the <i>k</i> value is set to 0:
</p>

<p>
\[
RecursiveActivitySelector(s, f, 0, n)
\]
</p>
</div>
</div>
</div>

<div id="outline-container-orgabb4fb6" class="outline-2">
<h2 id="orgabb4fb6">The Iterative Activity Selector</h2>
<div class="outline-text-2" id="text-orgabb4fb6">
<pre id="greedy-activity-selector" style="display:hidden;">
\begin{algorithm}
\caption{Greedy Activity Selector}
\begin{algorithmic}
\REQUIRE The activities are sorted in non-decreasing order of finish time
\INPUT $s$: The array of start times for the activities.
\INPUT $f$: The array of finish times for the activities.
\OUTPUT The activities that maximize the number of compatible activities.
\PROCEDURE{GreedyActivitySelector}{\(s, f\)}

\STATE \(n \gets s.length \)
\STATE \(A \gets \{a_1\} \)
\STATE \(k \gets 1 \)

\FOR {\(m  \in \{2, \ldots, n \}\)}
  \IF {\( s[m] \ge f[k] \)}
    \STATE \(A \gets A \cup \{a_m\}\)
    \STATE \(k \gets m \)
  \ENDIF
\ENDFOR

\RETURN \(A\)
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-orgbd447f5" class="outline-2">
<h2 id="orgbd447f5">Sources</h2>
<div class="outline-text-2" id="text-orgbd447f5">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("recursive-activity-selector"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("greedy-activity-selector"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/weighted-completion-times/" class="u-url">Weighted Completion Times</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/weighted-completion-times/" rel="bookmark">
            <time class="published dt-published" datetime="2022-07-20T16:33:47-07:00" itemprop="datePublished" title="2022-07-20 16:33">2022-07-20 16:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/weighted-completion-times/#org8baa6f0">The Weighted Scheduling Problem</a>
<ul>
<li><a href="posts/weighted-completion-times/#org6f7c8dd">Completion Time</a></li>
</ul>
</li>
<li><a href="posts/weighted-completion-times/#org0b4548e">Greedy Metrics</a></li>
<li><a href="posts/weighted-completion-times/#orgad40e16">Source</a></li>
</ul>
</div>
</div>
<div id="outline-container-org8baa6f0" class="outline-2">
<h2 id="org8baa6f0">The Weighted Scheduling Problem</h2>
<div class="outline-text-2" id="text-org8baa6f0">
<p>
This is a look at the problem of arranging a schedule of jobs so that their completion times are lowest, while accounting for different priorities for each job.
</p>

<p>
<b><b>Input:</b></b> \(n\) jobs with positive lengths \(l_1, l_2, \ldots, l_n\) and positive weights \(w_1, w_2,\ldots,w_n\). The larger the weight, the higher the priority.
</p>

<p>
<b><b>Output:</b></b> A job sequence (the schedule) that minimizes the sum of the weight completion times \(w_1l_1 + w_2 l_2 + \cdots + w_n l_n\).
</p>
</div>

<div id="outline-container-org6f7c8dd" class="outline-3">
<h3 id="org6f7c8dd">Completion Time</h3>
<div class="outline-text-3" id="text-org6f7c8dd">
<p>
The output above is a little confusing (I'll have to re-write that later). What we're minimizing is the sum of <i>completion times</i>. A job's completion time is the total of all the times for the jobs that precede it as well as the time to finish the job. This means the completion time for the first job is the time to run that job, the completion time for the second job is the time for the first job plus the time for the second job, and so on.
</p>
</div>
</div>
</div>
<div id="outline-container-org0b4548e" class="outline-2">
<h2 id="org0b4548e">Greedy Metrics</h2>
<div class="outline-text-2" id="text-org0b4548e">
<p>
The greedy method for this problem involves finding a metric such that when the jobs are sorted by the metric they form the optimal schedule. One possible metric is the <i>Greedy Difference</i> which is the weight for a job minus the time the job takes (\(w_i - l_i\)).
</p>

<p>
Another possible metric is the <i>Greedy Ratio</i> which is the ratio of job-weight to job-length (\(\frac{w_i}{l_i}\)).
</p>
</div>
</div>
<div id="outline-container-orgad40e16" class="outline-2">
<h2 id="orgad40e16">Source</h2>
<div class="outline-text-2" id="text-orgad40e16">
<ul class="org-ul">
<li><a href="posts/algorithms-illuminated-part-3/">Algorithms Illuminated - Part III: Greedy Algorithms and Dynamic Programming</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/comparing-energy-prices/" class="u-url">Comparing Energy Prices</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/comparing-energy-prices/" rel="bookmark">
            <time class="published dt-published" datetime="2022-07-12T13:13:00-07:00" itemprop="datePublished" title="2022-07-12 13:13">2022-07-12 13:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/comparing-energy-prices/#org9fdc4f9">How Many Megajoules For a Dollar of Gas?</a>
<ul>
<li><a href="posts/comparing-energy-prices/#org281e144">Chain-Link Conversion</a></li>
<li><a href="posts/comparing-energy-prices/#org199459a">In Python</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/#org33fcf41">How Many MegaJoules For a Dollar of Electricity?</a>
<ul>
<li><a href="posts/comparing-energy-prices/#orgb6981e3">Kilowatt-Hour To Joules</a></li>
<li><a href="posts/comparing-energy-prices/#org52d0b93">A Dollar's Worth Of Megajoules</a></li>
<li><a href="posts/comparing-energy-prices/#org92ded45">Check The Math</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/#org72f78c2">How Many Megajoules For a Dollar Of Natural Gas?</a>
<ul>
<li><a href="posts/comparing-energy-prices/#org2eda063">Check The Math</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/#org539ea51">How Many Megajoules For a Dollar of Coal?</a>
<ul>
<li><a href="posts/comparing-energy-prices/#orgc993291">Checking the Math</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/#org7739606">How Many Megajoules Per Dollar In Corn (Biodiesel)?</a>
<ul>
<li><a href="posts/comparing-energy-prices/#org369e182">Checking the Math</a></li>
</ul>
</li>
<li><a href="posts/comparing-energy-prices/#org98abcb8">What Is the Ratio of the Cost of the Most Expensive to the Cheapest?</a></li>
<li><a href="posts/comparing-energy-prices/#org907b3a3">Source</a></li>
</ul>
</div>
</div>
<div class="highlight"><pre><span></span><span class="c1"># from python</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>

<span class="k">def</span> <span class="nf">print_energy</span><span class="p">(</span><span class="n">megajoules_per_dollar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Print the energy provided by the source.</span>

<span class="sd">    Args:</span>
<span class="sd">     megajoules_per_dollar: how many megajoules provided by the source for each dollar</span>
<span class="sd">     source: where the energy is coming from</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> provides </span><span class="si">{</span><span class="n">megajoules_per_dollar</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> megajoules per dollar."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> costs $</span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">megajoules_per_dollar</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> per megajoule."</span><span class="p">)</span>
    <span class="k">return</span>

<span class="n">COSTS</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

<div id="outline-container-org9fdc4f9" class="outline-2">
<h2 id="org9fdc4f9">How Many Megajoules For a Dollar of Gas?</h2>
<div class="outline-text-2" id="text-org9fdc4f9">
<ul class="org-ul">
<li>A gallon of gasoline carries with it \(\approx 1.3E8\) joules of energy.</li>
<li>You pay \(5 \frac{\text{dollars}}{\text{gallon}}\).</li>
<li>How many megajoules (\(10^6\) joules) can you get for a dollar?</li>
</ul>
</div>

<div id="outline-container-org281e144" class="outline-3">
<h3 id="org281e144">Chain-Link Conversion</h3>
<div class="outline-text-3" id="text-org281e144">
\begin{align}
\require{cancel}
\left(\frac{1 \cancel{gallon}}{5\textit{ dollars}}\right)\left(\frac{1.3 \times 10^8\textit{ joules}}{1 \cancel{gallon}}\right) &amp;= \left(\frac{1.3 \times 10^8 \cancel{joules}}{5\textit{ dollars}}\right)\left(\frac{1 megajoule}{10^6 \cancel{joule}}\right) \\
&amp;=\frac{1.3\times 10^8 megajoules}{(5 \textit{ dollars})\left(10^6\right)}\\
&amp;= 26 \frac{megajoules}{dollar}
\end{align}
</div>
</div>

<div id="outline-container-org199459a" class="outline-3">
<h3 id="org199459a">In Python</h3>
<div class="outline-text-3" id="text-org199459a">
<div class="highlight"><pre><span></span><span class="n">gallons_per_dollar</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">joules_per_gallon</span> <span class="o">=</span> <span class="mi">13</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
<span class="n">joules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_gallon</span> <span class="o">*</span> <span class="n">gallons_per_dollar</span>
<span class="n">MEGAJOULES_PER_JOULE</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">gas_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_dollar</span> <span class="o">*</span> <span class="n">megajoules_per_joule</span>
<span class="n">gasoline</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">gas_megajoules_per_dollar</span>

<span class="n">print_energy</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">gas_megajoules_per_dollar</span><span class="p">),</span> <span class="s2">"Gasoline"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gasoline</span><span class="p">,</span> <span class="s2">"Gasoline"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Gasoline provides 26.00 megajoules per dollar.
Gasoline costs $0.0385 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org33fcf41" class="outline-2">
<h2 id="org33fcf41">How Many MegaJoules For a Dollar of Electricity?</h2>
<div class="outline-text-2" id="text-org33fcf41">
<ul class="org-ul">
<li>Electricity is $0.05 per kilowatt-hour.</li>
<li>\(1\text{ watt} = 1 \frac{joule}{second}\)</li>
<li>\(1\text{ kilowatt-hour} = 1,000\text{ watts} \times 3,600\text{ seconds}\)</li>
</ul>
</div>

<div id="outline-container-orgb6981e3" class="outline-3">
<h3 id="orgb6981e3">Kilowatt-Hour To Joules</h3>
<div class="outline-text-3" id="text-orgb6981e3">
\begin{align}
1 kilowatt-hour &amp;= (1,000\text{ watts})(3,600\text{ seconds})\\
  &amp;= \left(\frac{1,000\text{ joules}}{\cancel{second}}\right)\left(3,600 \cancel{seconds}\right)\\
  &amp;= 36 \times 10^5 \text{ joules}
\end{align}
</div>
</div>
<div id="outline-container-org52d0b93" class="outline-3">
<h3 id="org52d0b93">A Dollar's Worth Of Megajoules</h3>
<div class="outline-text-3" id="text-org52d0b93">
\begin{align}
\frac{1 \text{ kilowatt-hour}}{0.05\text{ dollars}} &amp;= \left(\frac{3.6 \times \cancel{10^6 joules}}{0.05\text{ dollars}}\right)\left(\frac{1 \text{ megajoule}}{\cancel{10^6 joules}}\right)\\

&amp;= \left(\frac{3.6\ megajoules}{0.05\text{ dollars}}\right)\left(\frac{20}{20}\right) \\
&amp;= 72 \ \frac{megajoules}{dollar}

\end{align}
</div>
</div>
<div id="outline-container-org92ded45" class="outline-3">
<h3 id="org92ded45">Check The Math</h3>
<div class="outline-text-3" id="text-org92ded45">
<div class="highlight"><pre><span></span><span class="n">kilowatt_hours_per_dollar</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># 1/0.05 = 20</span>
<span class="n">megajoules</span> <span class="o">=</span> <span class="mf">3.6</span>
<span class="n">electricity_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">kilowatt_hours_per_dollar</span> <span class="o">*</span> <span class="n">megajoules</span>
<span class="n">electricity</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">electricity_megajoules_per_dollar</span>

<span class="n">print_energy</span><span class="p">(</span><span class="n">electricity_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Electricity"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">electricity</span><span class="p">,</span> <span class="s2">"Electricity"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Electricity provides 72.00 megajoules per dollar.
Electricity costs $0.0139 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org72f78c2" class="outline-2">
<h2 id="org72f78c2">How Many Megajoules For a Dollar Of Natural Gas?</h2>
<div class="outline-text-2" id="text-org72f78c2">
<ul class="org-ul">
<li>A standard cubic foot of natural gas has about \(1.1 \times 10^6\) joules of energy.</li>
<li>You can get about \(5\times 10^5\) BTUs of gas for a dollar.</li>
<li>There are about 1,030 BTUs in a cubic foot.</li>
</ul>

\begin{align}
\left(1.1 \times 10^6 \frac{joules}{\cancel{cubic foot}}\right)\left(\frac{1\ \cancel{cubic foot}}{1.03 \times 10^3\ BTU}\right) &amp;= \left(\frac{1.1 \times 10^3\ joules}{1.03\ \cancel{BTU}}\right)\left(\frac{5 \times 10^5\ \cancel{BTU}}{dollar}\right)\\
&amp;= \left(\frac{5.5 \times 10^8\ \cancel{joules}}{1.03\ dollars}\right)\left(\frac{1\ Megajoule}{10^6 \cancel{joules}}\right)\\
&amp;= \left(\frac{5.5 \times 10^2\ Megajoules}{1.03 dollars}\right)\\
&amp;\approx 533.98\ \frac{Megajoules}{dollar}\\
\end{align}
</div>

<div id="outline-container-org2eda063" class="outline-3">
<h3 id="org2eda063">Check The Math</h3>
<div class="outline-text-3" id="text-org2eda063">
<div class="highlight"><pre><span></span><span class="n">joules_per_cubic_foot</span> <span class="o">=</span> <span class="mf">1.1E6</span>
<span class="n">cubic_feet_per_btu</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1030</span>
<span class="n">btus_per_dollar</span> <span class="o">=</span> <span class="mf">5e5</span>

<span class="n">joules_per_btu</span> <span class="o">=</span> <span class="n">joules_per_cubic_foot</span> <span class="o">*</span> <span class="n">cubic_feet_per_btu</span>

<span class="n">joules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_btu</span> <span class="o">*</span> <span class="n">btus_per_dollar</span>
<span class="n">natural_gas_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_dollar</span> <span class="o">*</span> <span class="n">MEGAJOULES_PER_JOULE</span>
<span class="n">natural_gas</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">natural_gas_megajoules_per_dollar</span>
<span class="n">print_energy</span><span class="p">(</span><span class="n">natural_gas_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Natural Gas"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">natural_gas</span><span class="p">,</span> <span class="s2">"Natural Gas"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Natural Gas provides 533.98 megajoules per dollar.
Natural Gas costs $0.0019 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org539ea51" class="outline-2">
<h2 id="org539ea51">How Many Megajoules For a Dollar of Coal?</h2>
<div class="outline-text-2" id="text-org539ea51">
<ul class="org-ul">
<li>A Ton of coal holds about \(3.2 × 10^{10}\) joules of energy.</li>
<li>A Ton of coal costs $40.</li>
</ul>
<p>
How many Megajoules of energy in the form of coal can you get for a dollar?
</p>

\begin{align}
\left(\frac{3.2 \times 10^{10}\ joules}{40\ dollars}\right) &amp;= \left(\frac{8 \times 10^{8} joules}{dollar}\right)\\
&amp;= \left(\frac{8 \times 10^{8}\ \cancel{joules}}{dollar}\right)\left(\frac{1\ Megajoule}{1 \times 10^6\ \cancel{joules}}\right)\\
&amp;=8 \times 10^2 \frac{Megajoules}{dollar}
\end{align}
</div>

<div id="outline-container-orgc993291" class="outline-3">
<h3 id="orgc993291">Checking the Math</h3>
<div class="outline-text-3" id="text-orgc993291">
<div class="highlight"><pre><span></span><span class="n">coal_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">MEGAJOULES_PER_JOULE</span> <span class="o">*</span> <span class="mf">3.2e10</span><span class="o">/</span><span class="mi">40</span>
<span class="n">coal</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">coal_megajoules_per_dollar</span>
<span class="n">print_energy</span><span class="p">(</span><span class="n">coal_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Coal"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coal</span><span class="p">,</span> <span class="s2">"Coal"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Coal provides 800.00 megajoules per dollar.
Coal costs $0.0013 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org7739606" class="outline-2">
<h2 id="org7739606">How Many Megajoules Per Dollar In Corn (Biodiesel)?</h2>
<div class="outline-text-2" id="text-org7739606">
<ul class="org-ul">
<li>Corn oil costs about $0.10 per fluid ounce (wholesale).</li>
<li>A fluid ounce carries about 240 dietary calories (kilo-calories).</li>
<li>A calorie is about 4.2 joules.</li>
</ul>
<p>
How many Megajoules of energy in the form of corn oil can you get for a dollar?
</p>

\begin{align}
\left(\frac{1\cancel{fluid-ounce}}{0.10\ dollar}\right)\left(\frac{240\ kilocalories}{\cancel{fluid- ounce}}\right) &amp;= \left(\frac{240\ \cancel{kilocalories}}{0.10\ dollar}\right)\left(\frac{10^3\ calories}{1\ \cancel{kilocalorie}}\right)\\
&amp;=\left(\frac{24\times 10^4\ \cancel{calories}}{0.10\ dollar}\right)\left(\frac{4.2\ joules}{1 \cancel{calorie}}\right)\\
&amp;=\left(\frac{100.8\times 10^4\ joules}{1 \times 10^{-1} dollar}\right)\\
&amp;=\left(\frac{1.008 \times 10^7 joules}{dollar}\right)\left(\frac{1\ megajoule}{10^6\ joules}\right)\\
&amp;= 1.008 \times 10^{1}\ \frac{megajoules}{dollar}\\
&amp;= 10.008
\end{align}
</div>

<div id="outline-container-org369e182" class="outline-3">
<h3 id="org369e182">Checking the Math</h3>
<div class="outline-text-3" id="text-org369e182">
<div class="highlight"><pre><span></span><span class="n">ounces_per_dollar</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">0.10</span>
<span class="n">kilocalories_per_ounce</span> <span class="o">=</span> <span class="mi">240</span>
<span class="n">joules_per_calorie</span> <span class="o">=</span> <span class="mf">4.2</span>
<span class="n">calories_per_kilocalorie</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

<span class="n">corn_megajoules_per_dollar</span> <span class="o">=</span> <span class="p">(</span><span class="n">ounces_per_dollar</span>
			      <span class="o">*</span> <span class="n">kilocalories_per_ounce</span>
			      <span class="o">*</span> <span class="n">calories_per_kilocalorie</span>
			      <span class="o">*</span> <span class="n">joules_per_calorie</span>
			      <span class="o">*</span> <span class="n">MEGAJOULES_PER_JOULE</span><span class="p">)</span>
<span class="n">corn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">corn_megajoules_per_dollar</span>
<span class="n">print_energy</span><span class="p">(</span><span class="n">corn_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Corn"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">corn</span><span class="p">,</span> <span class="s2">"Corn"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Corn provides 10.08 megajoules per dollar.
Corn costs $0.0992 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org98abcb8" class="outline-2">
<h2 id="org98abcb8">What Is the Ratio of the Cost of the Most Expensive to the Cheapest?</h2>
<div class="outline-text-2" id="text-org98abcb8">
<div class="highlight"><pre><span></span><span class="n">most_expensive</span><span class="p">,</span> <span class="n">cheapest</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">COSTS</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">COSTS</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The most expensive form of energy is </span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2"> "</span>
      <span class="sa">f</span><span class="s2">"at $</span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> per megajoule."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The cheapest form of energy is </span><span class="si">{</span><span class="n">cheapest</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2"> at "</span>
      <span class="sa">f</span><span class="s2">"$</span><span class="si">{</span><span class="n">cheapest</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> per megajoule."</span><span class="p">)</span>
</pre></div>

<pre class="example">
The most expensive form of energy is Corn at $0.10 per megajoule.
The cheapest form of energy is Coal at $0.0013 per megajoule.
</pre>


<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="o">/</span><span class="n">cheapest</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> "</span>
      <span class="sa">f</span><span class="s2">"times more expensive than </span><span class="si">{</span><span class="n">cheapest</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
</pre></div>

<pre class="example">
Corn is 79.37 times more expensive than Coal.
</pre>
</div>
</div>

<div id="outline-container-org907b3a3" class="outline-2">
<h2 id="org907b3a3">Source</h2>
<div class="outline-text-2" id="text-org907b3a3">
<ul class="org-ul">
<li><a href="posts/course-global-warming/">Global Warming I: The Science and Modeling of Climate Change</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/number-of-subsets-in-a-set/" class="u-url">Number of Subsets In a Set</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/number-of-subsets-in-a-set/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-27T13:09:06-07:00" itemprop="datePublished" title="2022-06-27 13:09">2022-06-27 13:09</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgf0e0672" class="outline-2">
<h2 id="orgf0e0672">Short Answer</h2>
<div class="outline-text-2" id="text-orgf0e0672">
<p>
The number of subsets for a set of <i>n</i> elements is \(2^n\).
</p>
</div>
</div>

<div id="outline-container-orgf657054" class="outline-2">
<h2 id="orgf657054">One Way To Remember It</h2>
<div class="outline-text-2" id="text-orgf657054">
<p>
Let's say we have a set of <i>n</i> things and we want to know how many different ways we can pick subsets of those things (including all of them or none of them). If we have three things, for instance, we might pick only the first item, or the first and the last item, or only the second item, etc.
</p>

<p>
We can represent the items as boxes in a row and if an item is in the subset we put a one in its box and if it isn't then we put a zero there. So for the three item example we can represent the subset that has the first and third item as <i>101</i> (the boxes are invisible and elastic). Writing it this way we can think of each element of the set as a binary digit and the number of subsets you can create is the same as the number of binary numbers with the same number of digits as the elements in our set.
</p>

<p>
To see all the possible subsets you can write out the binary numbers. For the case of three elements we represent them as three digits so finding the subsets will be the equivalent of counting from 0 to 7 in binary.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="org-right"></colgroup>
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right"> </th>
<th scope="col" class="org-right">Item 1</th>
<th scope="col" class="org-right">Item 2</th>
<th scope="col" class="org-right">Item 3</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">5</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">6</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">7</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
In this case we get 8 possibilities. More generally, for <i>n</i> digits we can count from \(0\) to \(2^n - 1\) for a total of \(2^n\) numbers so the total number of subsets of a set with <i>n</i> elements is \(2^n\).
</p>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/algorithms-illuminated-part-3/" class="u-url">Algorithms Illuminated - Part III: Greedy Algorithms and Dynamic Programming</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/algorithms-illuminated-part-3/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-27T13:03:04-07:00" itemprop="datePublished" title="2022-06-27 13:03">2022-06-27 13:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org62cd10e" class="outline-2">
<h2 id="org62cd10e">Citation</h2>
<div class="outline-text-2" id="text-org62cd10e">
<ul class="org-ul">
<li>[AI3] Roughgarden T. Algorithms illuminated. Part 3: Greedy algorithms and dynamic programming. First edition. San Francisco, CA: Soundlikeyourself Publishing, LLC; 2019. 217 p.</li>
</ul>
</div>
</div>
<div id="outline-container-org276ef67" class="outline-2">
<h2 id="org276ef67">On The Web</h2>
<div class="outline-text-2" id="text-org276ef67">
<ul class="org-ul">
<li>
<a href="https://algorithmsilluminated.org/">Algorithms Illuminated website</a>: Has links to all four books, videos, test cases, etc.</li>
<li><a href="https://timroughgarden.org/">Tim Roughgarden's (the author) Website</a></li>
</ul>
</div>
</div>
<div id="outline-container-org538c594" class="outline-2">
<h2 id="org538c594">Other Books in the Series</h2>
<div class="outline-text-2" id="text-org538c594">
<ul class="org-ul">
<li><a href="posts/algorithms-illuminated-part-1/">Algorithms Illuminated - Part 1: The Basics</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-knapsack-problem/" class="u-url">The Knapsack Problem</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-knapsack-problem/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-27T12:42:46-07:00" itemprop="datePublished" title="2022-06-27 12:42">2022-06-27 12:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/the-knapsack-problem/#orgab5276c">The Knapsack Problem(s)</a>
<ul>
<li><a href="posts/the-knapsack-problem/#org730a205">Imports</a></li>
<li><a href="posts/the-knapsack-problem/#orgbb5f9bb">Setup</a></li>
</ul>
</li>
<li>
<a href="posts/the-knapsack-problem/#org43f5506">The Brute Force Solution</a>
<ul>
<li><a href="posts/the-knapsack-problem/#org769431c">An Iterative Brute-Force Version</a></li>
<li><a href="posts/the-knapsack-problem/#orgd6baede">Checking the Brute</a></li>
<li><a href="posts/the-knapsack-problem/#org827f0b6">A Recursive Exhaustive Search</a></li>
<li><a href="posts/the-knapsack-problem/#org22ab021">Checking The Exhaustive</a></li>
</ul>
</li>
<li>
<a href="posts/the-knapsack-problem/#org98553f9">Levitin's Memory Function</a>
<ul>
<li>
<a href="posts/the-knapsack-problem/#orgfab1a2f">Some Pseudocode</a>
<ul>
<li><a href="posts/the-knapsack-problem/#orgebc1bb8">The Memoizer</a></li>
<li><a href="posts/the-knapsack-problem/#org228c778">A Reconstructor</a></li>
</ul>
</li>
<li>
<a href="posts/the-knapsack-problem/#org6c2b8ae">Memory-Function Knapsack</a>
<ul>
<li><a href="posts/the-knapsack-problem/#orge9cd126">Check the table maker</a></li>
<li><a href="posts/the-knapsack-problem/#org281e3a4">Check the Final Table</a></li>
<li><a href="posts/the-knapsack-problem/#org5f83a89">Check the Recovered Solution</a></li>
<li><a href="posts/the-knapsack-problem/#orge2ddcd1">Check It Against The Examples</a></li>
</ul>
</li>
<li><a href="posts/the-knapsack-problem/#org288b5bc">Compared to the Exhaustive Search</a></li>
</ul>
</li>
<li>
<a href="posts/the-knapsack-problem/#orgc94fb24">Dynamic Programming</a>
<ul>
<li><a href="posts/the-knapsack-problem/#orgf36c394">Some Pseudocode</a></li>
<li>
<a href="posts/the-knapsack-problem/#org95f0719">In Python</a>
<ul>
<li><a href="posts/the-knapsack-problem/#org33fad98">Check the table maker</a></li>
<li><a href="posts/the-knapsack-problem/#orgde62011">Check the Recovered Solution</a></li>
<li><a href="posts/the-knapsack-problem/#org4266323">Check It Against The Examples</a></li>
</ul>
</li>
<li><a href="posts/the-knapsack-problem/#orgf8fb00d">Compared</a></li>
</ul>
</li>
<li><a href="posts/the-knapsack-problem/#org8bf1f09">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgab5276c" class="outline-2">
<h2 id="orgab5276c">The Knapsack Problem(s)</h2>
<div class="outline-text-2" id="text-orgab5276c">
<p>
The basic premise of the <i>Knapsack Problem</i> is that we have a knapsack with a maximum capacity (<i>C</i>) and a selection of <i>n</i> items, each item having a weight (\(w_i\)) and a value (\(v_i\)), and we want to pick the items that give us the most total value without exceeding the capacity of our knapsack.
</p>

<p>
There are two forms of the problem. The first form is what <a href="posts/clrs/">CLRS</a> 
calls the \(\textit{0-1 Knapsack Problem}\) because we can either take the item (\(1\)) or not take the item (\(0\)) as opposed to the \(\textit{Fractional Knapsack Problem}\) where the "items" are things that we can take fractional portions of (if we're loading up on spices the \(\textit{0-1}\) problem might be pre-packaged spices while the \(\textit{fractional}\) problem involves scooping spices out of the bulk bins).
</p>

<p>
Although the problems look more or less the same, the fractional problem is one that can be solved using a greedy algorithm while the 0-1 problem can fail if you use a greedy approach so the all-or-nothing version is the more interesting case and the one we'll look at here.
</p>
</div>

<div id="outline-container-org730a205" class="outline-3">
<h3 id="org730a205">Imports</h3>
<div class="outline-text-3" id="text-org730a205">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">attrs</span> <span class="kn">import</span> <span class="n">define</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span><span class="n">be_below_or_equal</span><span class="p">,</span> <span class="n">contain_exactly</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span><span class="p">,</span>
		     <span class="n">raise_error</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>

<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># other monkey stuff</span>
<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">Timer</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgbb5f9bb" class="outline-3">
<h3 id="orgbb5f9bb">Setup</h3>
<div class="outline-text-3" id="text-orgbb5f9bb">
<div class="highlight"><pre><span></span><span class="n">Solution</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Solution"</span><span class="p">,</span> <span class="s2">"value inventory count"</span><span class="p">)</span>
<span class="n">TableSolution</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"TableSolution"</span><span class="p">,</span> <span class="s2">"value inventory count table"</span><span class="p">)</span>
<span class="n">NEGATIVE_INFINITY</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"-inf"</span><span class="p">)</span>
<span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>

<span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"the-knapsack-problem"</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="n">SLUG</span><span class="p">)</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-org43f5506" class="outline-2">
<h2 id="org43f5506">The Brute Force Solution</h2>
<div class="outline-text-2" id="text-org43f5506">
<p>
One way to find the optimal load for our knapsack is to find all the possible loads and taking the best load from those that will fit in the knapsack. This requires us to calculate the values for <a href="posts/number-of-subsets-in-a-set/">every subset</a> of items which means we'll have to do \(2^n\) calculations.
</p>
</div>

<div id="outline-container-org769431c" class="outline-3">
<h3 id="org769431c">An Iterative Brute-Force Version</h3>
<div class="outline-text-3" id="text-org769431c">
<p>
To have a reference solution I'll make a brute-force iterative version of the knapsack solver. This will have a greater runtime (\(n 2^n\)) but sometimes starting with something easy is useful, even if it's not the solution we ultimately want.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">brute_knapsack</span><span class="p">(</span><span class="n">capacity</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Solution</span><span class="p">:</span>
    <span class="sd">"""Finds the best selection of items to maximize value</span>

<span class="sd">    Args:</span>
<span class="sd">     capacity: maximum weight allowed</span>
<span class="sd">     values: value for each item available</span>
<span class="sd">     weights: how much each item weighs</span>

<span class="sd">    Returns:</span>
<span class="sd">     best-value, count of each item, count of loops</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="n">number_of_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_of_items</span>
    <span class="n">best_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">number_of_items</span><span class="p">)):</span>
	<span class="n">value</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">carry</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
	<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_items</span><span class="p">):</span>
	    <span class="n">increment</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+</span> <span class="n">carry</span>
	    <span class="n">keep</span> <span class="o">=</span> <span class="n">increment</span> <span class="o">%</span> <span class="mi">2</span>
	    <span class="n">carry</span> <span class="o">=</span> <span class="n">increment</span><span class="o">//</span><span class="mi">2</span>
	    <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
		<span class="n">value</span> <span class="o">+=</span> <span class="n">values</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
		<span class="n">weight</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
	    <span class="n">items</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep</span>
	    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;=</span> <span class="n">capacity</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">best_value</span><span class="p">:</span>
	    <span class="n">best_value</span> <span class="o">=</span> <span class="n">value</span>
	    <span class="n">solution</span> <span class="o">=</span> <span class="n">items</span><span class="p">[:]</span>

    <span class="k">return</span> <span class="n">Solution</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">best_value</span><span class="p">,</span> <span class="n">inventory</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgd6baede" class="outline-3">
<h3 id="orgd6baede">Checking the Brute</h3>
<div class="outline-text-3" id="text-orgd6baede">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">totals</span><span class="p">(</span><span class="n">inventory</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""Reduce the inventory values and weights to a total value and a total weight</span>

<span class="sd">    Args:</span>
<span class="sd">     inventory: list of item counts</span>
<span class="sd">     values: list of values for the items</span>
<span class="sd">     list of weights for the items</span>

<span class="sd">    Returns:</span>
<span class="sd">     value, weight for the inventory</span>
<span class="sd">    """</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">value</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="k">if</span> <span class="n">inventory</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="k">if</span> <span class="n">inventory</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">weight</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">:</span> <span class="n">Solution</span><span class="p">,</span>
		   <span class="n">expected_inventory</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
		   <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">capacity</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">"""Check that the solution matches the expected</span>

<span class="sd">    Args:</span>
<span class="sd">     solution: namedtuple with the knapsack solution</span>
<span class="sd">     expected_inventory: list of 0's and 1's representing which items to keep</span>
<span class="sd">     expected_value: total value expected for the solution</span>
<span class="sd">     values: values for the items</span>
<span class="sd">     weights: weights for the items</span>
<span class="sd">     capacity: maximum weight for the knapsack</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if something isn't the expected</span>
<span class="sd">    """</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected_inventory</span><span class="p">))</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">totals</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">expected_value</span><span class="p">,</span> <span class="n">expected_weight</span> <span class="o">=</span> <span class="n">totals</span><span class="p">(</span><span class="n">expected_inventory</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below_or_equal</span><span class="p">(</span><span class="n">capacity</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">expected_weight</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">expected_value</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_examples</span><span class="p">(</span><span class="n">solver</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Check the toy examples</span>

<span class="sd">    Args:</span>
<span class="sd">     solver: function to find the optimal knapsack load</span>
<span class="sd">    """</span>
    <span class="c1"># values and weights don't match</span>
    <span class="c1"># broken = lambda : solver(5, [0, 1], [2, 1, 3])</span>
    <span class="c1"># expect(broken).to(raise_error(AssertionError))</span>

    <span class="n">capacity</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">solution</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">check_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>

    <span class="n">capacity</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

    <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">check_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>

    <span class="n">capacity</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">check_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>

    <span class="c1"># this won't work for greedy algorithms</span>
    <span class="n">capacity</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span>

<span class="n">check_examples</span><span class="p">(</span><span class="n">brute_knapsack</span><span class="p">)</span>
</pre></div>

<p>
Let's look at a particular solution.
</p>

<div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">brute_knapsack</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Call Count: </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Chosen knapsack value </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Item inventory: </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

<pre class="example">
Call Count: 64
Chosen knapsack value 8
Item inventory: [0, 1, 0, 1]
</pre>


<p>
We have a solution that works, but the runtime is \(n2^n\) so let's make a version that does a little better.
</p>
</div>
</div>

<div id="outline-container-org827f0b6" class="outline-3">
<h3 id="org827f0b6">A Recursive Exhaustive Search</h3>
<div class="outline-text-3" id="text-org827f0b6">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">exhausted</span><span class="p">(</span><span class="n">capacity</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">this_item</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Solution</span><span class="p">:</span>
    <span class="sd">"""Find the optimal knapsack using an exhaustive search</span>

<span class="sd">    Args:</span>
<span class="sd">     capacity: how much weight the knapsack can hold</span>
<span class="sd">     values: how much the items are worth</span>
<span class="sd">     weights: hom much the items weigh</span>
<span class="sd">     this_item: index of the current item in the values and weights</span>
<span class="sd">     count: number of times this function is called</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="n">next_item</span> <span class="o">=</span> <span class="n">this_item</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># quit this branch if the knapsack is already out of space</span>
    <span class="k">if</span> <span class="n">capacity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
	 <span class="k">return</span> <span class="n">Solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">-</span> <span class="n">this_item</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># to save on an extra base-case call handle the last item separately here</span>
    <span class="k">if</span> <span class="n">next_item</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
	<span class="n">skip_this_item</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">capacity</span><span class="p">:</span>
	    <span class="k">return</span> <span class="n">skip_this_item</span>

	<span class="n">use_this_item</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">values</span><span class="p">[</span><span class="n">this_item</span><span class="p">],</span>
				 <span class="n">inventory</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="n">skip_this_item</span><span class="p">,</span> <span class="n">use_this_item</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="c1"># now on to the recursive cases</span>
    <span class="n">descendant_solution</span> <span class="o">=</span> <span class="n">exhausted</span><span class="p">(</span><span class="n">this_item</span><span class="o">=</span><span class="n">next_item</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span>
				    <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

    <span class="n">skip_count</span> <span class="o">=</span> <span class="n">descendant_solution</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">skip_this_item</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">descendant_solution</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
			      <span class="n">inventory</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">descendant_solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
			      <span class="n">count</span><span class="o">=</span><span class="n">skip_count</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">capacity</span> <span class="o">&lt;</span> <span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]:</span>
	<span class="n">solution</span> <span class="o">=</span> <span class="n">skip_this_item</span>
	<span class="n">count</span> <span class="o">=</span> <span class="n">skip_count</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">capacity_after_this_item_is_added</span> <span class="o">=</span> <span class="n">capacity</span> <span class="o">-</span> <span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span>
	<span class="n">descendant_solution</span> <span class="o">=</span> <span class="n">exhausted</span><span class="p">(</span>
	    <span class="n">this_item</span><span class="o">=</span><span class="n">next_item</span><span class="p">,</span>
	    <span class="n">capacity</span><span class="o">=</span><span class="n">capacity_after_this_item_is_added</span><span class="p">,</span>
	    <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
	    <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

	<span class="n">check_count</span> <span class="o">=</span> <span class="n">skip_count</span> <span class="o">+</span> <span class="n">descendant_solution</span><span class="o">.</span><span class="n">count</span>

	<span class="n">include_this_item</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">values</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span> <span class="o">+</span> <span class="n">descendant_solution</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
				     <span class="n">inventory</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">descendant_solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
				     <span class="n">count</span><span class="o">=</span><span class="n">check_count</span><span class="p">)</span>

	<span class="n">skip_this_item</span> <span class="o">=</span> <span class="n">Solution</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">skip_this_item</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
				  <span class="n">inventory</span><span class="o">=</span><span class="n">skip_this_item</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
				  <span class="n">count</span><span class="o">=</span><span class="n">check_count</span><span class="p">)</span>
	<span class="n">solution</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">skip_this_item</span><span class="p">,</span> <span class="n">include_this_item</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
	<span class="n">count</span> <span class="o">=</span> <span class="n">check_count</span>
    <span class="k">return</span> <span class="n">solution</span>

<span class="n">check_examples</span><span class="p">(</span><span class="n">exhausted</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org22ab021" class="outline-3">
<h3 id="org22ab021">Checking The Exhaustive</h3>
<div class="outline-text-3" id="text-org22ab021">
<p>
Let's look at that example that we looked at for the iterative brute-force version.
</p>

<div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">exhausted</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="n">brute_solution</span> <span class="o">=</span> <span class="n">brute_knapsack</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Call Count: </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Chosen knapsack value </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Item inventory: </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">brute_solution</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">brute_solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">))</span>
</pre></div>

<pre class="example">
Call Count: 12
Chosen knapsack value 8
Item inventory: [0, 1, 0, 1]
</pre>


<p>
So now the number calls has gone down to \(\approx 2^n\), which is better, but not what we want just yet.
</p>
</div>
</div>
</div>
<div id="outline-container-org98553f9" class="outline-2">
<h2 id="org98553f9">Levitin's Memory Function</h2>
<div class="outline-text-2" id="text-org98553f9">
<p>
This is a memoized function that is in <a href="posts/itdaa/">Levitin's book</a>. It looks slightly different from the other memoized functions in the other books (but they all look slightly different from each other anyway) but it's only cosmetic. I've been creating the final solution list of items to use in the functions themselves but I'm going to try doing it the way the books do and separate out the solution using a re-creation function afterwards.
</p>
</div>

<div id="outline-container-orgfab1a2f" class="outline-3">
<h3 id="orgfab1a2f">Some Pseudocode</h3>
<div class="outline-text-3" id="text-orgfab1a2f">
</div>
<div id="outline-container-orgebc1bb8" class="outline-4">
<h4 id="orgebc1bb8">The Memoizer</h4>
<div class="outline-text-4" id="text-orgebc1bb8">
<p>
<b><b>Note:</b></b> Levitin keeps the weights, values, and solution table in the global space so it doesn't appear in the pseudocode. I'm going to copy that here but change it when I get to implementing it.
I'm also going to change the variables a little to get them a little closer to the names I use. I'll call the eternal collections \(\textit{Table, Weights}\), and \(\textit{Values}\).
</p>

<p>
The \(Table\) is an \(items \times capacity\) table, with from 0 to number of items rows and 0 to the capacity columns. The 0 row and 0 column get initialized with 0 and the other cells with -1. If we have 4 items and a knapsack capacity of 5 we'd have an initial table like this.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="org-right"></colgroup>
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right"> </th>
<th scope="col" class="org-right">0</th>
<th scope="col" class="org-right">1</th>
<th scope="col" class="org-right">2</th>
<th scope="col" class="org-right">3</th>
<th scope="col" class="org-right">4</th>
<th scope="col" class="org-right">5</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">0</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
</tr>
</tbody>
</table>
<p>
Where the rows are the items and the columns are the used-capacities for the knapsack.
</p>

<pre id="memory-function-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Memory Function Knapsack Solver}
\begin{algorithmic}
\INPUT $i$: the number of the first items to consider.
\INPUT $c$: the knapsack's capacity.
\OUTPUT Value of the optimal subset of the first $i$ items that fit in the knapsack.
\PROCEDURE{MFKnapsack}{$i, c$}
\IF {\textit{Table}$[i, c] &lt; 0$}
 \IF {$c &lt; \textit{Weights}[i]$}
  \STATE $v \gets $ \textsc{MFKnapsack}($i - 1, c$)
 \ELSE
  \STATE $v \gets $ \textsc{Max}(\textsc{MFKnapsack}($i - 1, c$), $\textit{Values}[i] + $ \textsc{MFKnapsack}($i - 1, c - \textit{Weights}[i]$))
 \ENDIF
 \STATE $\textit{Table}[i, c] \gets v$
\ENDIF
\RETURN $\textit{Table}[i, c]$
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
To start the function you would pass in the total number of items as the argument for \(i\). Since we initialized the cells (other than the zero row and column) with -1 the initial <i>if</i> is a check to see if the item and capacity passed to the function is already in the table and if it isn't we run the body but if it is we can just return the value from the table.
</p>

<p>
In the body if the weight of the current item is beyond the remaining capacity of the knapsack we pick the value for the previous item using the current capacity. If the current item will fit in the knapsack then we pick the larger of the previous item's entry with the current capacity and the value of the current item plus the previous item's entry for the current capacity minus the weight of the current item - meaning we pick the bigger of the values we get if we skip this item or keep it.
</p>

<ol class="org-ol">
<li>If the item and capacity aren't in the table:
<ul class="org-ul">
<li>If the item's weight is greater than the remaining capacity use the previous item's value for the current capacity.</li>
<li>Otherwise use the greater of the previous item's value and this item's value plus the previous item's value for the current capacity minus the current item's weight (the capacity if you use the current item)</li>
<li>Whichever value you use, set it to the table's entry for this item and the current capacity</li>
</ul>
</li>
<li>Return the table entry for this item and the current capacity</li>
</ol>
</div>
</div>

<div id="outline-container-org228c778" class="outline-4">
<h4 id="org228c778">A Reconstructor</h4>
<div class="outline-text-4" id="text-org228c778">
<p>
The main algorithm builds a memo-table and returns the value of the optimal solution but doesn't tell you which  items are actually taken. For that we'll need a separate function. The pseudocode assumes that the weights (\(w_i\)) and values (\(v_i\)) are global variables.
</p>

<pre id="reconstruction-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Knapsack Inventory Reconstructor}
\begin{algorithmic}
\INPUT $A$: The table created to solve the knapsack problem
\INPUT $c$: the knapsack's capacity.
\OUTPUT An optimal knapsack solution
\PROCEDURE{KnapsackReconstruction}{$A, C$}

\STATE \( S \gets \emptyset \)
\STATE \(c \gets C \)
\FOR {\(i = n \ldots 1\)}
    \IF {\(w_i \leq c\) and \(A[i - 1][c - w_i] + v_i \geq A[i - 1][c]\)}
        \STATE \(S \gets S \cup \{i\}\)
        \STATE \(c \gets c - w_i\)
    \ENDIF
\ENDFOR
\RETURN \(S\)
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>
</div>


<div id="outline-container-org6c2b8ae" class="outline-3">
<h3 id="org6c2b8ae">Memory-Function Knapsack</h3>
<div class="outline-text-3" id="text-org6c2b8ae">
<p>
The counts and such are cluttering up the function so I'm going to make this class-based.
</p>

<div class="highlight"><pre><span></span><span class="nd">@define</span>
<span class="k">class</span> <span class="nc">Memorizer</span><span class="p">:</span>
    <span class="sd">"""Dynamic Programming solution to the knapsack problem</span>

<span class="sd">    Args:</span>
<span class="sd">     capacity: total capacity (by weight) of knapsack</span>
<span class="sd">     values: values for items to put in knapsack</span>
<span class="sd">     weights: weights for items to put in knapsack</span>
<span class="sd">    """</span>
    <span class="n">capacity</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">values</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">_items</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_table</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">_value</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_inventory</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
	<span class="sd">"""The number of items available for the knapsack</span>

<span class="sd">	Raises:</span>
<span class="sd">	 AssertionError: the number of values and weights don't match</span>

<span class="sd">	Returns:</span>
<span class="sd">	 number of items</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
	<span class="sd">"""The total value of the optimal knapsack"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">,</span>
					  <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">)</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
	<span class="sd">"""The memo table</span>

<span class="sd">	Returns:</span>
<span class="sd">	items + 1 x capacity + 1 list of lists: 0's in 0 column/row, -1 elsewhere</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="n">first_row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
	    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span>
	    <span class="n">table</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)]</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="p">[</span><span class="n">first_row</span><span class="p">]</span> <span class="o">+</span> <span class="n">table</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span>

    <span class="k">def</span> <span class="nf">find_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">capacity</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
	<span class="sd">"""Find the best total value for the knapsack</span>

<span class="sd">	Args:</span>
<span class="sd">	 item: the number of the item to use (0...item)</span>
<span class="sd">	 capacity: maximum weight allowed</span>

<span class="sd">	Returns:</span>
<span class="sd">	 best-value</span>
<span class="sd">	"""</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="c1"># the table is padded </span>
	<span class="c1"># so we need to adjust the item index for weights, values</span>
	<span class="n">this_item</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">capacity</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
	    <span class="n">previous_item</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-</span> <span class="mi">1</span>
	    <span class="n">previous_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_value</span><span class="p">(</span><span class="n">previous_item</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>

	    <span class="k">if</span> <span class="n">capacity</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]:</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">previous_value</span>
	    <span class="k">else</span><span class="p">:</span>
		<span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">previous_value</span><span class="p">,</span>
			    <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_value</span><span class="p">(</span>
				<span class="n">previous_item</span><span class="p">,</span>
				<span class="n">capacity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]))</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">capacity</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">capacity</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
	<span class="sd">"""Reconstructs the optimal knapsack load using the table</span>

<span class="sd">	Returns:</span>
<span class="sd">	 inventory of items in the optimal knapsack</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inventory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="c1"># make sure that the problem has already been solved</span>
	    <span class="bp">self</span><span class="p">()</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_inventory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
	    <span class="n">remaining_capacity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span>

	    <span class="k">for</span> <span class="n">table_item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="c1"># table_item is padded by one</span>
		<span class="n">this_item</span> <span class="o">=</span> <span class="n">previous_table_item</span> <span class="o">=</span> <span class="n">table_item</span> <span class="o">-</span> <span class="mi">1</span>

		<span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">remaining_capacity</span> <span class="ow">and</span>
		    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_table_item</span><span class="p">][</span>
			<span class="n">remaining_capacity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]]</span>
		    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span>
		    <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_table_item</span><span class="p">][</span><span class="n">remaining_capacity</span><span class="p">]):</span>
		    <span class="bp">self</span><span class="o">.</span><span class="n">_inventory</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
		    <span class="n">remaining_capacity</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inventory</span>            

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
	<span class="sd">"""Finds the best solution:</span>

<span class="sd">	As a side effect this also sets self.value</span>

<span class="sd">	Returns:</span>
<span class="sd">	 value for optimal knapsack</span>
<span class="sd">	"""</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>

<div id="outline-container-orge9cd126" class="outline-4">
<h4 id="orge9cd126">Check the table maker</h4>
<div class="outline-text-4" id="text-orge9cd126">
<div class="highlight"><pre><span></span><span class="n">capacity</span><span class="p">,</span> <span class="n">items</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">items</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">table</span>

<span class="c1"># one row per item plus a zero row</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">items</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># columns from 0...capacity</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">capacity</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># first row should be 0's</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># first column should be 0's</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># everything else should be -1 (items x capacity sub-array)</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">items</span> <span class="o">*</span> <span class="n">capacity</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org281e3a4" class="outline-4">
<h4 id="org281e3a4">Check the Final Table</h4>
<div class="outline-text-4" id="text-org281e3a4">
<div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">memoizer</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">)</span>
<span class="n">memoizer</span><span class="p">()</span>
<span class="n">expect</span><span class="p">(</span><span class="n">memoizer</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>

<span class="n">expected_table</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
		  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
		  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
		  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
		  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">]]</span>

<span class="k">for</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">memoizer</span><span class="o">.</span><span class="n">table</span><span class="p">):</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected_table</span><span class="p">[</span><span class="n">row_index</span><span class="p">]))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5f83a89" class="outline-4">
<h4 id="org5f83a89">Check the Recovered Solution</h4>
<div class="outline-text-4" id="text-org5f83a89">
<p>
Although knowing what the optimal value is for the knapsack is somewhat informative in that it tells us what we can expect to achieve, it isn't really the solution since we don't know what items actually give us this value, so we're going to need to reconstruct it from the table.
</p>

<div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">solution</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orge2ddcd1" class="outline-4">
<h4 id="orge2ddcd1">Check It Against The Examples</h4>
<div class="outline-text-4" id="text-orge2ddcd1">
<div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">solution</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Chosen knapsack value </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Item inventory: </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Call Count: </span><span class="si">{</span><span class="n">solution</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">check_examples</span><span class="p">(</span><span class="n">Memorizer</span><span class="p">)</span>
</pre></div>

<pre class="example">
Chosen knapsack value 8
Item inventory: [0, 1, 0, 1]
Call Count: 17
</pre>


<p>
Our solution is correct, but if you count all the function calls, not just the calls where the solution isn't in the table yet, it takes more calls than our exhaustive function. 
</p>
</div>
</div>
</div>

<div id="outline-container-org288b5bc" class="outline-3">
<h3 id="org288b5bc">Compared to the Exhaustive Search</h3>
<div class="outline-text-3" id="text-org288b5bc">
<div class="highlight"><pre><span></span><span class="n">sizes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">61</span><span class="p">))</span>

<span class="c1"># 0 weights break the Memorizer so make sure everything weighs at least 1</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)),</span> <span class="n">k</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">)),</span> <span class="n">k</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
	   <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">]</span>
<span class="n">capacities</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>

<span class="n">capacities_values_weights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">capacities</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">exhaustive_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">exhausted</span><span class="p">)(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">capacity</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">weights</span> <span class="ow">in</span> <span class="n">capacities_values_weights</span><span class="p">)</span>
</pre></div>

<pre class="example">
Started: 2022-07-11 02:35:10.337731
Ended: 2022-07-11 02:50:47.862952
Elapsed: 0:15:37.525221
</pre>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">memorizer_knapsack</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">memorizer</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">memorizer</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">memorizer</span>

<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">memorized_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">memorizer_knapsack</span><span class="p">)(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">capacity</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">weights</span> <span class="ow">in</span> <span class="n">capacities_values_weights</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exhaustive_output</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">memorized_output</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
	<span class="n">capacity</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">capacities_values_weights</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="n">b_value</span><span class="p">,</span> <span class="n">b_weight</span> <span class="o">=</span> <span class="n">totals</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
				   <span class="n">value</span><span class="p">,</span>
				   <span class="n">weight</span><span class="p">)</span>
	<span class="n">m_value</span><span class="p">,</span> <span class="n">m_weight</span> <span class="o">=</span> <span class="n">totals</span><span class="p">(</span><span class="n">memorized_output</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
				   <span class="n">value</span><span class="p">,</span>
				   <span class="n">weight</span><span class="p">)</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">m_value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">b_value</span><span class="p">))</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">m_weight</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below_or_equal</span><span class="p">(</span><span class="n">capacity</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
	<span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">capacities_values_weights</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Brute: </span><span class="si">{</span><span class="n">brute_knapsack</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
	<span class="k">raise</span>
</pre></div>

<pre class="example">
Started: 2022-07-11 05:00:50.158584
Ended: 2022-07-11 05:00:52.849549
Elapsed: 0:00:02.690965
</pre>


<div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Items"</span><span class="p">:</span> <span class="n">sizes</span><span class="p">,</span>
			  <span class="s2">"Exhaustive"</span><span class="p">:</span> <span class="p">[</span>
			      <span class="n">solution</span><span class="o">.</span><span class="n">count</span>
			      <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">exhaustive_output</span><span class="p">],</span>
			  <span class="s2">"Memoized"</span><span class="p">:</span> <span class="p">[</span>
			      <span class="n">solution</span><span class="o">.</span><span class="n">count</span>
			      <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">memorized_output</span><span class="p">]})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Items"</span><span class="p">],</span>
		    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Exhaustive"</span><span class="p">,</span> <span class="s2">"Memoized"</span><span class="p">],</span>
		    <span class="n">var_name</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Calls"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Items"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Calls"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Items"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Calls"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="s2">"Algorithm"</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Exhaustive vs Memoized Knapsack Solution"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"exhaustive-vs-memoized"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-knapsack-problem/exhaustive-vs-memoized.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
The height of those last points squashes the previous points down to make it look like the two algorithms do about the same until you hit 47 items, but if you trim off those end points you'll see that the exhaustive algorithm generally requires much more calls than the memoized version. The points aren't on a smooth line as a function of the number of items because whenever an item won't fit in the remaining capacity of the knapsack we skip the second recursive call.
</p>

<div class="highlight"><pre><span></span><span class="n">UPPER_BOUND</span> <span class="o">=</span> <span class="mi">47</span>
<span class="n">trimmed</span> <span class="o">=</span> <span class="n">melted</span><span class="p">[</span><span class="n">melted</span><span class="o">.</span><span class="n">Items</span> <span class="o">&lt;</span> <span class="n">UPPER_BOUND</span><span class="p">]</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">trimmed</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Items"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Calls"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Items"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Calls"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="s2">"Algorithm"</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Exhaustive vs Memoized Knapsack Solution (&lt; </span><span class="si">{</span><span class="n">UPPER_BOUND</span><span class="si">}</span><span class="s2">)"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"exhaustive-vs-memoized-trimmed"</span><span class="p">)</span>
</pre></div>


<object type="text/html" data="posts/the-knapsack-problem/exhaustive-vs-memoized-trimmed.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>

<div id="outline-container-orgc94fb24" class="outline-2">
<h2 id="orgc94fb24">Dynamic Programming</h2>
<div class="outline-text-2" id="text-orgc94fb24">
<p>
This is taken from <a href="posts/algorithms-illuminated-part-3/">Algorithms Illuminated Part 3</a>.
</p>
</div>

<div id="outline-container-orgf36c394" class="outline-3">
<h3 id="orgf36c394">Some Pseudocode</h3>
<div class="outline-text-3" id="text-orgf36c394">
<pre id="dynamic-programming-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Dynamic Programming Knapsack Solver}
\begin{algorithmic}
\INPUT Item Values: \(v_1, v_2, \ldots, v_n\)
\INPUT Item Weights: \(w_1, w_2, \ldots, w_n\)
\INPUT Knapsack Capacity \(C\)
\OUTPUT Subset \(S\) of items with maximum possible sum of values and size at most \(C\)
\PROCEDURE{DynamicKnapsack}{\(v, w, C\)}
\STATE \(A \gets (n + 1) \times (c + 1)\) two dimensional array.
\FOR {\(c \in \{0 \ldots C\}\)}
  \STATE \(A[0][c] \gets 0\)
\ENDFOR

\FOR {\(i \in \{1 \ldots n\}\)}
  \FOR {\(c \in \{0 \ldots C \}\)}
    \IF {\(w_i &gt; C \)}
      \STATE \(A[i][c] \gets A[i - 1][c]\)
    \ELSE
      \STATE \(A[i][c] \gets \)\textsc{Max}(\(A[i - 1][c], A[i - 1][c - w_i] + v_i\))
    \ENDIF
  \ENDFOR
\ENDFOR

\RETURN \(A[n][C]\)
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
This looks pretty much like the memoized-recursive version so it shouldn't be too hard to understand.
</p>
</div>
</div>

<div id="outline-container-org95f0719" class="outline-3">
<h3 id="org95f0719">In Python</h3>
<div class="outline-text-3" id="text-org95f0719">
<div class="highlight"><pre><span></span><span class="nd">@define</span>
<span class="k">class</span> <span class="nc">CaptainDynamic</span><span class="p">(</span><span class="n">Memorizer</span><span class="p">):</span>
    <span class="sd">"""Dynamic Programming solution to the knapsack problem</span>

<span class="sd">    Args:</span>
<span class="sd">     capacity: total capacity (by weight) of knapsack</span>
<span class="sd">     values: values for items to put in knapsack</span>
<span class="sd">     weights: weights for items to put in knapsack</span>
<span class="sd">    """</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
	<span class="sd">"""The total value of the optimal knapsack"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_value</span><span class="p">()</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="k">def</span> <span class="nf">find_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
	<span class="sd">"""Finds the optimal value"""</span>
	<span class="k">for</span> <span class="n">item_row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
	    <span class="n">previous_item</span> <span class="o">=</span> <span class="n">this_item</span> <span class="o">=</span> <span class="n">item_row</span> <span class="o">-</span> <span class="mi">1</span>
	    <span class="k">for</span> <span class="n">capacity</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		<span class="n">skip_this_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_item</span><span class="p">][</span><span class="n">capacity</span><span class="p">]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">capacity</span><span class="p">:</span>
		    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">item_row</span><span class="p">][</span><span class="n">capacity</span><span class="p">]</span> <span class="o">=</span> <span class="n">skip_this_item</span>
		<span class="k">else</span><span class="p">:</span>
		    <span class="n">use_this_item</span> <span class="o">=</span> <span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_item</span><span class="p">][</span>
			    <span class="n">capacity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">this_item</span><span class="p">]]</span> <span class="o">+</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">this_item</span><span class="p">])</span>

		    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">item_row</span><span class="p">][</span><span class="n">capacity</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
			<span class="p">(</span><span class="n">skip_this_item</span><span class="p">,</span> <span class="n">use_this_item</span><span class="p">)</span>
		    <span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">]</span>
</pre></div>
</div>

<div id="outline-container-org33fad98" class="outline-4">
<h4 id="org33fad98">Check the table maker</h4>
<div class="outline-text-4" id="text-org33fad98">
<div class="highlight"><pre><span></span><span class="n">capacity</span><span class="p">,</span> <span class="n">items</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">items</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">CaptainDynamic</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">table</span>

<span class="c1"># one row per item plus a zero row</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">items</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># columns from 0...capacity</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">capacity</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># first row should be 0's</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># first column should be 0's</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># everything else should be -1 (items x capacity sub-array)</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">items</span> <span class="o">*</span> <span class="n">capacity</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgde62011" class="outline-4">
<h4 id="orgde62011">Check the Recovered Solution</h4>
<div class="outline-text-4" id="text-orgde62011">
<p>
Although knowing what the optimal value is for the knapsack is somewhat informative in that it tells us what we can expect to achieve, it isn't really the solution since we don't know what items actually give us this value, so we're going to need to reconstruct it from the table.
</p>

<div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">solution</span> <span class="o">=</span> <span class="n">CaptainDynamic</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">m_solution</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">capacity</span><span class="o">=</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">m_solution</span><span class="o">.</span><span class="n">inventory</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org4266323" class="outline-4">
<h4 id="org4266323">Check It Against The Examples</h4>
<div class="outline-text-4" id="text-org4266323">
<div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">d_solution</span> <span class="o">=</span> <span class="n">CaptainDynamic</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Captain Dynamic"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Chosen knapsack value </span><span class="si">{</span><span class="n">d_solution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Item inventory: </span><span class="si">{</span><span class="n">d_solution</span><span class="o">.</span><span class="n">inventory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Call Count: </span><span class="si">{</span><span class="n">d_solution</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">check_examples</span><span class="p">(</span><span class="n">CaptainDynamic</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Memorizer"</span><span class="p">)</span>
<span class="n">m_solution</span> <span class="o">=</span> <span class="n">Memorizer</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Chosen knapsack value: </span><span class="si">{</span><span class="n">m_solution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Item inventory: </span><span class="si">{</span><span class="n">m_solution</span><span class="o">.</span><span class="n">inventory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Call Count: </span><span class="si">{</span><span class="n">m_solution</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">check_examples</span><span class="p">(</span><span class="n">Memorizer</span><span class="p">)</span>
</pre></div>

<pre class="example">
Captain Dynamic
Chosen knapsack value 8
Item inventory: [0, 1, 0, 1]
Call Count: 28

Memorizer
Chosen knapsack value: 8
Item inventory: [0, 1, 0, 1]
Call Count: 17
</pre>


<p>
Our solution is correct, but if you count all the function calls, not just the calls where the solution isn't in the table yet, it takes more calls than our exhaustive function. 
</p>
</div>
</div>
</div>


<div id="outline-container-orgf8fb00d" class="outline-3">
<h3 id="orgf8fb00d">Compared</h3>
<div class="outline-text-3" id="text-orgf8fb00d">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dynamic_knapsack</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">captain</span> <span class="o">=</span> <span class="n">CaptainDynamic</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="n">captain</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">captain</span>

<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">dynamic_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">dynamic_knapsack</span><span class="p">)(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">capacity</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">weights</span> <span class="ow">in</span> <span class="n">capacities_values_weights</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exhaustive_output</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">dynamic_output</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
	<span class="n">capacity</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">capacities_values_weights</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="n">b_value</span><span class="p">,</span> <span class="n">b_weight</span> <span class="o">=</span> <span class="n">totals</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
				   <span class="n">value</span><span class="p">,</span>
				   <span class="n">weight</span><span class="p">)</span>
	<span class="n">m_value</span><span class="p">,</span> <span class="n">m_weight</span> <span class="o">=</span> <span class="n">totals</span><span class="p">(</span><span class="n">dynamic_output</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
				   <span class="n">value</span><span class="p">,</span>
				   <span class="n">weight</span><span class="p">)</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">m_value</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">b_value</span><span class="p">))</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">m_weight</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below_or_equal</span><span class="p">(</span><span class="n">capacity</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
	<span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">capacities_values_weights</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Brute: </span><span class="si">{</span><span class="n">brute_knapsack</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
	<span class="k">raise</span>
</pre></div>

<pre class="example">
Started: 2022-07-11 05:08:19.593276
Ended: 2022-07-11 05:08:21.585963
Elapsed: 0:00:01.992687
</pre>


<div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Items"</span><span class="p">:</span> <span class="n">sizes</span><span class="p">,</span>
			  <span class="s2">"Dynamic"</span><span class="p">:</span> <span class="p">[</span>
			      <span class="n">solution</span><span class="o">.</span><span class="n">count</span>
			      <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">dynamic_output</span><span class="p">],</span>
			  <span class="s2">"cN"</span><span class="p">:</span> <span class="p">[</span>
			      <span class="n">solution</span><span class="o">.</span><span class="n">capacity</span> <span class="o">*</span> <span class="n">solution</span><span class="o">.</span><span class="n">items</span>
			      <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">dynamic_output</span><span class="p">],</span>
			  <span class="s2">"Memoized"</span><span class="p">:</span> <span class="p">[</span>
			      <span class="n">solution</span><span class="o">.</span><span class="n">count</span>
			      <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">memorized_output</span><span class="p">]})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Items"</span><span class="p">],</span>
		    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Dynamic"</span><span class="p">,</span> <span class="s2">"Memoized"</span><span class="p">,</span> <span class="s2">"cN"</span><span class="p">],</span>
		    <span class="n">var_name</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Calls"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Items"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Calls"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Algorithm"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Items"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Calls"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="s2">"Algorithm"</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Dynamic vs Memoized Knapsack Solution"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"dynamic-vs-memoized"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-knapsack-problem/dynamic-vs-memoized.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>

<div id="outline-container-org8bf1f09" class="outline-2">
<h2 id="org8bf1f09">Sources</h2>
<div class="outline-text-2" id="text-org8bf1f09">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
<li><a href="posts/algorithms-illuminated-part-3/">Algorithms Illuminated - Part III: Greedy Algorithms and Dynamic Programming</a></li>
<li><a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms (Levitin)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("memory-function-algorithm"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("reconstruction-algorithm"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("dynamic-programming-algorithm"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/latpaps/" class="u-url">Learning Algorithms Through Programming and Problem Solving</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/latpaps/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-16T15:19:29-07:00" itemprop="datePublished" title="2022-06-16 15:19">2022-06-16 15:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orga2c6b41" class="outline-2">
<h2 id="orga2c6b41">Table Of Contents (Partial)</h2>
<div class="outline-text-2" id="text-orga2c6b41">
</div>
<div id="outline-container-orgeb38e20" class="outline-3">
<h3 id="orgeb38e20">Algorithms and Complexity</h3>
<div class="outline-text-3" id="text-orgeb38e20">
<ul class="org-ul">
<li>What is an Algorithm?</li>
<li>Pseudocode</li>
<li>Problem Versus Problem Instance</li>
<li>Correct Versus Incorrect Algorithms</li>
<li>Fast Versus Slow Algorithms</li>
<li>Big-O Notation</li>
</ul>
</div>
</div>
<div id="outline-container-org325ee7f" class="outline-3">
<h3 id="org325ee7f">Algorithm Design Techniques</h3>
<div class="outline-text-3" id="text-org325ee7f">
<ul class="org-ul">
<li>Exhaustive Search Algorithms</li>
<li>Branch-and-Bound Algorithms</li>
<li>Greedy Algorithms</li>
<li>Dynamic Programming Algorithms</li>
<li>Recursive Algorithms</li>
<li>Divide-and-Conquer Algorithms</li>
<li>Randomized Algorithms</li>
</ul>
</div>
</div>
<div id="outline-container-orgf2974b0" class="outline-3">
<h3 id="orgf2974b0">Programming Challenges</h3>
<div class="outline-text-3" id="text-orgf2974b0">
<ul class="org-ul">
<li>Sum of Two Digits</li>
<li>Maximum Pairwise Product
<ul class="org-ul">
<li>Naive Algorithm</li>
<li>Fast Algorithm</li>
<li>Testing and Debugging</li>
<li>Can You Tell Me What Error I Have Made?</li>
<li>Stress Testing</li>
<li>Even Faster Algorithm</li>
<li>A More Compact Algorithm</li>
</ul>
</li>
<li>Solving a Programming Challenge in Five Easy Steps
<ul class="org-ul">
<li>Reading the Problem Statement</li>
<li>Designing an Algorithm</li>
<li>Implementing an Algorithm</li>
<li>Testing and Debugging</li>
<li>Submitting the Grading System</li>
</ul>
</li>
<li>Good Programming Practices</li>
</ul>
</div>
</div>
<div id="outline-container-org6365894" class="outline-3">
<h3 id="org6365894">Algorithmic Warm Up</h3>
<div class="outline-text-3" id="text-org6365894">
<ul class="org-ul">
<li>Fibonacci Numbers</li>
<li>Last Digit of a Fibonacci Number</li>
<li>Greatest Common Divisor</li>
<li>Least Common Multiple</li>
<li>Fibonacci Numbers Again</li>
<li>Last Digit of the Sum of Fibonacci Numbers</li>
<li>Last Digit of the Sum of Fibonacci Numbers Again</li>
</ul>
</div>
</div>
<div id="outline-container-org04d4d00" class="outline-3">
<h3 id="org04d4d00">Greedy Algorithms</h3>
<div class="outline-text-3" id="text-org04d4d00">
<ul class="org-ul">
<li>Money Change</li>
<li>Maximum Value of the Loot</li>
<li>Maximum Advertisement Revenue</li>
<li>Collecting Signatures</li>
<li>Maximum Number of Prizes</li>
<li>Maximum Salary</li>
</ul>
</div>
</div>
<div id="outline-container-orgabba6b3" class="outline-3">
<h3 id="orgabba6b3">Divide and Conquer</h3>
<div class="outline-text-3" id="text-orgabba6b3">
<ul class="org-ul">
<li>Binary Search</li>
<li>Majority Element</li>
<li>Improving QuickSort</li>
<li>Number of Inversions</li>
<li>Organizing a Lottery</li>
<li>Closest Points</li>
</ul>
</div>
</div>
<div id="outline-container-orgb7edd96" class="outline-3">
<h3 id="orgb7edd96">Dynamic Programming</h3>
<div class="outline-text-3" id="text-orgb7edd96">
<ul class="org-ul">
<li>Money Change Again</li>
<li>Primitive Calculator</li>
<li>Edit Distance</li>
<li>Longest Common Subsequence of Two Sequences</li>
<li>Longest Common Subsequence of Three Sequences</li>
<li>Maximum Amount of Gold</li>
<li>Partitioning Souvenirs</li>
<li>Maximum Value of an Arithmetic Expression</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org7f4ddbc" class="outline-2">
<h2 id="org7f4ddbc">Citation</h2>
<div class="outline-text-2" id="text-org7f4ddbc">
<ul class="org-ul">
<li>Kulikov A. Learning algorithms through programming and puzzle solving. La Jolla, CA: Active Learning Technologies; 2018.</li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-coin-changing-problem/" class="u-url">The Coin Changing Problem</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-coin-changing-problem/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-16T15:11:33-07:00" itemprop="datePublished" title="2022-06-16 15:11">2022-06-16 15:11</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/the-coin-changing-problem/#orgd70f15c">The Change Problem</a></li>
<li>
<a href="posts/the-coin-changing-problem/#org1c5dfbd">SetUp</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org14780bf">Imports</a></li>
<li><a href="posts/the-coin-changing-problem/#org95a1333">Setup</a></li>
</ul>
</li>
<li>
<a href="posts/the-coin-changing-problem/#org4e3c340">The Cashier's Algorithm</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org3c5b71e">Pseudocode</a></li>
<li>
<a href="posts/the-coin-changing-problem/#orge0c42f9">Python Implementation</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#orgb1e0f09">A First Test</a></li>
<li><a href="posts/the-coin-changing-problem/#org713cefa">U.S. Denominations</a></li>
</ul>
</li>
<li>
<a href="posts/the-coin-changing-problem/#org0dce98e">Plotting the Coin Counts/Loops</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org95bd8db">The Double-Dime</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/the-coin-changing-problem/#org79d8cfa">A Greedy Version</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org5d5e1b3">In Pseudocode</a></li>
<li><a href="posts/the-coin-changing-problem/#org447c7ec">In Python</a></li>
<li>
<a href="posts/the-coin-changing-problem/#orgff9666a">Testing It Out</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#orge2ef52c">A First Test</a></li>
<li><a href="posts/the-coin-changing-problem/#org3e56bcb">U.S. Denominations</a></li>
<li><a href="posts/the-coin-changing-problem/#orga3d3486">The Double-Dime</a></li>
</ul>
</li>
<li><a href="posts/the-coin-changing-problem/#org22aa6cc">Plotting</a></li>
</ul>
</li>
<li>
<a href="posts/the-coin-changing-problem/#org73d2989">A Brute Force Changer</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#orgf9d7267">Plotting</a></li>
</ul>
</li>
<li>
<a href="posts/the-coin-changing-problem/#orgae069c1">Memoized Changer</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org9fa6be5">Checking the Memoized Changer</a></li>
<li>
<a href="posts/the-coin-changing-problem/#orgf2c3d93">Plotting</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org0016168">All the Methods So Far</a></li>
<li><a href="posts/the-coin-changing-problem/#orgfc599f1">Obsolete Coins</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/the-coin-changing-problem/#orgc57b1d6">Iterative Dynamic Programming</a>
<ul>
<li><a href="posts/the-coin-changing-problem/#org4070527">Plotting</a></li>
</ul>
</li>
<li><a href="posts/the-coin-changing-problem/#org7378d5a">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgd70f15c" class="outline-2">
<h2 id="orgd70f15c">The Change Problem</h2>
<div class="outline-text-2" id="text-orgd70f15c">
<p>
The <i>Change Problem (Coin Changing Problem)</i> asks us to convert some amount of money into denominations using the fewest coins.
</p>

<p>
<b><b>Input:</b></b> An integer (<i>money</i>) and an array of <i>d</i> denominations (\(c = c_1, c_2, \ldots, c_d\)) in decreasing order of value (\(c_1 &gt; c_2&gt; \cdots &gt; c_d\)).
</p>

<p>
<b><b>Output:</b></b> A list of <i>d</i> integers \(i_1, i_2, \ldots, i_d\) such that \(c_1 \cdot i_1 + c_2 \cdot i_2 + \cdots + c_d \cdot i_d = money\)  and \(i_1 + i_2 + \cdots + i_d\) is as small as possible.
</p>
</div>
</div>
<div id="outline-container-org1c5dfbd" class="outline-2">
<h2 id="org1c5dfbd">SetUp</h2>
<div class="outline-text-2" id="text-org1c5dfbd">
</div>
<div id="outline-container-org14780bf" class="outline-3">
<h3 id="org14780bf">Imports</h3>
<div class="outline-text-3" id="text-org14780bf">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">contain_exactly</span><span class="p">,</span> <span class="n">expect</span><span class="p">,</span> <span class="n">equal</span>

<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># my stuff</span>
<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
</pre></div>
</div>
</div>

<div id="outline-container-org95a1333" class="outline-3">
<h3 id="org95a1333">Setup</h3>
<div class="outline-text-3" id="text-org95a1333">
<div class="highlight"><pre><span></span><span class="n">ChangeCounts</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"ChangeCounts"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"coin_counts"</span><span class="p">,</span> <span class="s2">"run_count"</span><span class="p">])</span>
<span class="n">ChangeCountsTable</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"ChangeCounts"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"coin_counts"</span><span class="p">,</span> <span class="s2">"run_count"</span><span class="p">,</span> <span class="s2">"table"</span><span class="p">])</span>

<span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"the-coin-changing-problem"</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="n">SLUG</span><span class="p">)</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>

<span class="n">PlotParameters</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"PlotParameters"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"height"</span><span class="p">,</span> <span class="s2">"width"</span><span class="p">],</span>
			    <span class="n">defaults</span><span class="o">=</span><span class="p">[</span><span class="mi">525</span><span class="p">,</span> <span class="mi">750</span><span class="p">])()</span>

<span class="n">Denominations</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Denominations"</span><span class="p">,</span> <span class="s2">"US double_dime obsolete"</span><span class="p">,</span>
			   <span class="n">defaults</span><span class="o">=</span><span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
				    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
				    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])()</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-org4e3c340" class="outline-2">
<h2 id="org4e3c340">The Cashier's Algorithm</h2>
<div class="outline-text-2" id="text-org4e3c340">
<p>
The way many cashier's make change for customers is using a greedy approach.
</p>
</div>

<div id="outline-container-org3c5b71e" class="outline-3">
<h3 id="org3c5b71e">Pseudocode</h3>
<div class="outline-text-3" id="text-org3c5b71e">
<pre id="cashiers-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{CashiersChange}
\begin{algorithmic}
\INPUT Amount owed ($money$) and a supply of coins ($c$).
\PROCEDURE{CashiersChange}{$money, c$}
\WHILE {\(money &gt; 0\)}
  \STATE \(coin \gets\) Coin with the largest denomination that doesn't exceed \(money\).
  \STATE Give $coin$ to the customer.
  \STATE \(money \gets money - coin\)
\ENDWHILE
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-orge0c42f9" class="outline-3">
<h3 id="orge0c42f9">Python Implementation</h3>
<div class="outline-text-3" id="text-orge0c42f9">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cashier_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChangeCounts</span><span class="p">:</span>
    <span class="sd">"""Implements the cashier's method for making change</span>

<span class="sd">    Args:</span>
<span class="sd">     amount: the value of the change needed</span>
<span class="sd">     denominations: values for coins (in descending order)</span>

<span class="sd">    Returns:</span>
<span class="sd">     list of coin-counts, number of loops ran</span>
<span class="sd">    """</span>
    <span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominations</span><span class="p">)</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="n">amount</span>
    <span class="n">loop_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">denomination</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">denominations</span><span class="p">):</span>
	<span class="n">coin_count</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">while</span> <span class="n">denomination</span> <span class="o">&lt;=</span> <span class="n">remainder</span><span class="p">:</span>
	    <span class="n">coin_count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">loop_count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span> <span class="o">-</span> <span class="n">denomination</span>

	<span class="n">coins</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">coin_count</span>
    <span class="k">return</span> <span class="n">ChangeCounts</span><span class="p">(</span><span class="n">coin_counts</span><span class="o">=</span><span class="n">coins</span><span class="p">,</span> <span class="n">run_count</span><span class="o">=</span><span class="n">loop_count</span><span class="p">)</span>
</pre></div>
</div>

<div id="outline-container-orgb1e0f09" class="outline-4">
<h4 id="orgb1e0f09">A First Test</h4>
<div class="outline-text-4" id="text-orgb1e0f09">
<p>
Examples from <a href="posts/latpaps/">LATPAPS</a>.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_coins</span><span class="p">(</span><span class="n">answer</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
		<span class="n">expected_coins</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
		<span class="n">expected_total</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Check that our answer matches the expected</span>

<span class="sd">    Args:</span>
<span class="sd">     answer: list of counts for each denomination</span>
<span class="sd">     denominations: list of coin denominations available</span>
<span class="sd">     expected_coins: the expected list of counts for each denomination</span>
<span class="sd">     expected_total: what the value our coins should add up to</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError: something about our answer doesn't match the expected</span>
<span class="sd">    """</span>
    <span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">answer</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">expected_coins</span><span class="p">)))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected_coins</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">count</span> <span class="o">*</span> <span class="n">coin</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">coin</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">answer</span><span class="p">,</span> <span class="n">denominations</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
	<span class="n">equal</span><span class="p">(</span><span class="n">expected_total</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="c1"># case 1</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"case 1: </span><span class="si">{</span><span class="n">actual</span><span class="o">.</span><span class="n">run_count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># case 2</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"case 2: </span><span class="si">{</span><span class="n">actual</span><span class="o">.</span><span class="n">run_count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># case 3</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"case 2: </span><span class="si">{</span><span class="n">actual</span><span class="o">.</span><span class="n">run_count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
case 1: 2
case 2: 6
case 2: 14
</pre>


<p>
The number of loops is dependent on the change owed, with an upper limit based on the denominations. In this case if we assume you wouldn't give out more than 99 cents in change then we would cap out at \( 9 \times 10 + 1 \times 5 + 4 \times 1\) = 14 coins/loops.
</p>
</div>
</div>

<div id="outline-container-org713cefa" class="outline-4">
<h4 id="org713cefa">U.S. Denominations</h4>
<div class="outline-text-4" id="text-org713cefa">
<p>
This is a quick check using the U.S. coins most commonly used by cashiers. By adding a 25 cent piece we reduce the upper limit on the amount of coins needed to \(3 \times 25 + 2 \times 10 + 4 \times 1\) = 9 coins.
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span>
</pre></div>

<pre class="example">
[25, 10, 5, 1]
</pre>


<div class="highlight"><pre><span></span><span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="n">money</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org0dce98e" class="outline-3">
<h3 id="org0dce98e">Plotting the Coin Counts/Loops</h3>
<div class="outline-text-3" id="text-org0dce98e">
<div class="highlight"><pre><span></span><span class="n">PLOT_AMOUNTS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">CASHIER_COUNTS</span> <span class="o">=</span> <span class="p">[</span><span class="n">cashier_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		  <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>

<span class="n">PLOT_FRAME</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Amount to Change"</span><span class="p">:</span> <span class="n">PLOT_AMOUNTS</span><span class="p">,</span>
			       <span class="s2">"Coins"</span><span class="p">:</span> <span class="n">CASHIER_COUNTS</span><span class="p">})</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">PLOT_FRAME</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Coins"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Coins"</span><span class="p">])</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Cashier's Change Coin Counts (Common U.S. Coins)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"cashiers-change-us-coins"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/cashiers-change-us-coins.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>

<div id="outline-container-org95bd8db" class="outline-4">
<h4 id="org95bd8db">The Double-Dime</h4>
<div class="outline-text-4" id="text-org95bd8db">
<p>
Our cashier algorithm turns out to work for the specific set of coins that cashiers commonly use, but will it work for other coins as well?
</p>

<p>
According to Wikipedia, there was at one time a proposal in the United States for a <a href="https://en.wikipedia.org/wiki/Twenty-cent_piece_(United_States_coin)">twenty-cent piece</a> (and at one time there were <a href="https://en.wikipedia.org/wiki/Obsolete_denominations_of_United_States_currency#Coinage">half-cent, two-cent, and three-cent coins</a>).If we include the twenty cent piece amongst our denominations, we find that there are cases where the cashier algorithm will miss the optimal solution.
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">)</span>
</pre></div>

<pre class="example">
[25, 20, 10, 5, 1]
</pre>


<div class="highlight"><pre><span></span><span class="n">money</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"AssertionError: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
AssertionError: 
expected: 3 to equal 2
</pre>


<p>
Because the cashier algorithm always takes the largest possible coins first, it ends up using 25¢ + 10¢ + 5¢ as the solution instead of the optimal 20¢ + 20¢. While it might seem artificial, given the characterization of this as a solution to making change, it's important to note that generalizing the cashier algorithm beyond the curated denominations or even beyond coins specifically leaves it vulnerable to cases where it will fail.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org79d8cfa" class="outline-2">
<h2 id="org79d8cfa">A Greedy Version</h2>
<div class="outline-text-2" id="text-org79d8cfa">
<p>
As noted, the Cashier's Algorithm is a greedy algorithm, but let's translate it into a silghtly smarter version which uses a little arithmetic to get to the same point.
</p>
</div>

<div id="outline-container-org5d5e1b3" class="outline-3">
<h3 id="org5d5e1b3">In Pseudocode</h3>
<div class="outline-text-3" id="text-org5d5e1b3">
<pre id="greedy-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{GreedyChange}
\begin{algorithmic}
\INPUT An integer ($money$) and an array of $d$ denominations (\(c = c_1, c_2, \ldots, c_d\)) in decreasing order of value (\(c_1 &gt; c_2&gt; \cdots &gt; c_d\)).
\OUTPUT A list of $d$ integers \(i_1, i_2, \ldots, i_d\) such that \(c_1 \cdot i_1 + c_2 \cdot i_2 + \cdots + c_d \cdot i_d = money\)  and \(i_1 + i_2 + \cdots + i_d\) is as small as possible.
\PROCEDURE{CashiersChange}{$money, c$}
\STATE $remainder \gets money$
\STATE $d \gets $ \textsc{Length}($c$)
\FOR {$k \in \{1 \ldots d\}$}
  \STATE $i_k \gets \lfloor \frac{remainder}{c_k} \rfloor$
  \STATE $remainder \gets remainder - c_k \cdot i_k$
\ENDFOR
\RETURN $(i_1, i_2, \ldots, i_d)$
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>
<div id="outline-container-org447c7ec" class="outline-3">
<h3 id="org447c7ec">In Python</h3>
<div class="outline-text-3" id="text-org447c7ec">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">greedy_changer</span><span class="p">(</span><span class="n">money</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChangeCounts</span><span class="p">:</span>
    <span class="sd">"""Make change using the fewest coins</span>

<span class="sd">    Args:</span>
<span class="sd">     money: the amount to change</span>
<span class="sd">     denominations: list of coin denominations in decreasing order</span>

<span class="sd">    Returns:</span>
<span class="sd">     Number of each denomination needed to make the change, loop-count</span>
<span class="sd">    """</span>
    <span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominations</span><span class="p">)</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="n">money</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">location</span><span class="p">,</span> <span class="n">denomination</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">denominations</span><span class="p">):</span>
	<span class="n">coins</span><span class="p">[</span><span class="n">location</span><span class="p">]</span> <span class="o">=</span> <span class="n">remainder</span> <span class="o">//</span> <span class="n">denomination</span>
	<span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span> <span class="o">-</span> <span class="n">denomination</span> <span class="o">*</span> <span class="n">coins</span><span class="p">[</span><span class="n">location</span><span class="p">]</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ChangeCounts</span><span class="p">(</span><span class="n">coins</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgff9666a" class="outline-3">
<h3 id="orgff9666a">Testing It Out</h3>
<div class="outline-text-3" id="text-orgff9666a">
</div>
<div id="outline-container-orge2ef52c" class="outline-4">
<h4 id="orge2ef52c">A First Test</h4>
<div class="outline-text-4" id="text-orge2ef52c">
<div class="highlight"><pre><span></span><span class="c1"># case 1</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">greedy_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="c1"># case 2</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">greedy_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3e56bcb" class="outline-4">
<h4 id="org3e56bcb">U.S. Denominations</h4>
<div class="outline-text-4" id="text-org3e56bcb">
<div class="highlight"><pre><span></span><span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">greedy_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="n">money</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">greedy_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-orga3d3486" class="outline-4">
<h4 id="orga3d3486">The Double-Dime</h4>
<div class="outline-text-4" id="text-orga3d3486">
<p>
Looking at the greedy-algorithm you can see that it only has one loop that traverses the denominations of coins - so it is a very quick algorithm, but while our greedy algorithm turns out to work for the specific set of coins that cashiers use, it also falls prey to sometimes missing the optimal solution.
</p>

<div class="highlight"><pre><span></span><span class="n">money</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">greedy_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"AssertionError: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
AssertionError: 
expected: 3 to equal 2
</pre>
</div>
</div>
</div>

<div id="outline-container-org22aa6cc" class="outline-3">
<h3 id="org22aa6cc">Plotting</h3>
<div class="outline-text-3" id="text-org22aa6cc">
<div class="highlight"><pre><span></span><span class="n">greedy_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">greedy_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		 <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>
<span class="n">GREEDY_FRAME</span> <span class="o">=</span> <span class="n">PLOT_FRAME</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Coins"</span><span class="p">:</span> <span class="s2">"Cashier"</span><span class="p">})</span>
<span class="n">GREEDY_FRAME</span><span class="p">[</span><span class="s2">"Greedy"</span><span class="p">]</span> <span class="o">=</span> <span class="n">greedy_counts</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">GREEDY_FRAME</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			   <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Greedy"</span><span class="p">,</span> <span class="s2">"Cashier"</span><span class="p">],</span>
			   <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			   <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Cashier's and Greedy Change Coin Counts (Common U.S. Coins)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"cashiers-greedy-change-us-coins"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/cashiers-greedy-change-us-coins.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
Since the Cashier works by repeated subtraction instead of division it goes up with the amount of change owed, and so generally does worse than the Greedy changer, except in the cases where it takes fewer coins to make the change than the number of denominations there are. If I had included the fifty cent piece it would have done a little better in the second half of the plot.
</p>
</div>
</div>
</div>

<div id="outline-container-org73d2989" class="outline-2">
<h2 id="org73d2989">A Brute Force Changer</h2>
<div class="outline-text-2" id="text-org73d2989">
<p>
To get around the limitations of the greedy-style of change making we'll figure out all the ways we can make change for a particular amount and pick the solution with the fewest coins.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">brute_changer</span><span class="p">(</span><span class="n">money</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChangeCounts</span><span class="p">:</span>
    <span class="sd">"""Make change using the fewest coins</span>

<span class="sd">    Args:</span>
<span class="sd">     money: the amount to change</span>
<span class="sd">     denominations: list of coin denominations in decreasing order</span>

<span class="sd">    Returns:</span>
<span class="sd">     Number of each denomination needed to make the change, loop_count</span>
<span class="sd">    """</span>
    <span class="n">best</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>
    <span class="n">number_of_denominations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominations</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">first</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_denominations</span><span class="p">):</span>
	<span class="n">remainder</span> <span class="o">=</span> <span class="n">money</span>
	<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_of_denominations</span>
	<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">next_location</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">number_of_denominations</span><span class="p">):</span>
	    <span class="n">denomination</span> <span class="o">=</span> <span class="n">denominations</span><span class="p">[</span><span class="n">next_location</span><span class="p">]</span>
	    <span class="n">count</span> <span class="o">=</span> <span class="n">remainder</span><span class="o">//</span><span class="n">denomination</span>
	    <span class="n">remainder</span> <span class="o">=</span> <span class="n">remainder</span> <span class="o">-</span> <span class="n">count</span> <span class="o">*</span> <span class="n">denomination</span>
	    <span class="n">counts</span><span class="p">[</span><span class="n">next_location</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
	    <span class="n">total</span> <span class="o">+=</span> <span class="n">count</span>
	    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">total</span> <span class="o">&lt;</span> <span class="n">best</span><span class="p">:</span>
	    <span class="n">best_counts</span> <span class="o">=</span> <span class="n">counts</span>
	    <span class="n">best</span> <span class="o">=</span> <span class="n">total</span>
    <span class="k">return</span> <span class="n">ChangeCounts</span><span class="p">(</span><span class="n">best_counts</span><span class="p">,</span> <span class="n">counter</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="c1"># case 1</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="c1"># case 2</span>
<span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="n">money</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">coins</span><span class="p">)</span>
<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">coins</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>
</pre></div>

<p>
And now our double-dime case.
</p>

<div class="highlight"><pre><span></span><span class="n">money</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">money</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">)</span>

<span class="n">check_coins</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
</pre></div>

<pre class="example">
ChangeCounts(coin_counts=[0, 2, 0, 0, 0], run_count=15)
</pre>


<p>
The Brute-Force Changer fixes our double-dimes case, and has a constant runtime of:
</p>

<p>
\[
T(n) = \sum_{i = 1}^{n} = \frac{n(n + 1)}{2}
\]
</p>

<p>
Where \(n\) is the number of denominations, not the input amount. 
</p>


<p>
Let's make sure our functions all agree.
</p>

<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">cashiers_change</span> <span class="o">=</span> <span class="n">cashier_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">coin_counts</span>
    <span class="n">greedy_change</span> <span class="o">=</span> <span class="n">greedy_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">coin_counts</span>
    <span class="n">brute_change</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">coin_counts</span>

    <span class="n">check_coins</span><span class="p">(</span><span class="n">answer</span><span class="o">=</span><span class="n">cashiers_change</span><span class="p">,</span> <span class="n">denominations</span><span class="o">=</span><span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span>
		<span class="n">expected_coins</span><span class="o">=</span><span class="n">greedy_change</span><span class="p">,</span> <span class="n">expected_total</span><span class="o">=</span><span class="n">amount</span><span class="p">)</span>
    <span class="n">check_coins</span><span class="p">(</span><span class="n">answer</span><span class="o">=</span><span class="n">brute_change</span><span class="p">,</span> <span class="n">denominations</span><span class="o">=</span><span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span>
		<span class="n">expected_coins</span><span class="o">=</span><span class="n">greedy_change</span><span class="p">,</span> <span class="n">expected_total</span><span class="o">=</span><span class="n">amount</span><span class="p">)</span>
</pre></div>
</div>

<div id="outline-container-orgf9d7267" class="outline-3">
<h3 id="orgf9d7267">Plotting</h3>
<div class="outline-text-3" id="text-orgf9d7267">
<p>
Let's compare the three methods we've created so far using the typical U.S. Coins.
</p>

<div class="highlight"><pre><span></span><span class="n">brute_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">brute_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		<span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>
<span class="n">GREEDY_FRAME</span><span class="p">[</span><span class="s2">"Brute-Force"</span><span class="p">]</span> <span class="o">=</span> <span class="n">brute_counts</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">GREEDY_FRAME</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			   <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Greedy"</span><span class="p">,</span> <span class="s2">"Cashier"</span><span class="p">,</span> <span class="s2">"Brute-Force"</span><span class="p">],</span>
			   <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			   <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Greedy Change &amp; Brute-Force Coin Counts (Common U.S. Coins)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"brute-force-change-us-coins"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/brute-force-change-us-coins.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
The Greedy and Brute-Force methods both have a loop-count based on the number of coin denominations we have. Since we have four denominations (25, 10, 5, and 1) the Greedy method has four loops and the Brute-Force method has ten loops \(\left(^{4(4 + 1)}/_{2} = 10\right)\), so it does a little more calculating but not much, although in this case the benefit it has is wasted since we shouldn't find sub-optimal solutions with the greedy approach and using the coins that we did.
</p>
</div>
</div>
</div>

<div id="outline-container-orgae069c1" class="outline-2">
<h2 id="orgae069c1">Memoized Changer</h2>
<div class="outline-text-2" id="text-orgae069c1">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">memoized_changer</span><span class="p">(</span><span class="n">money</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		     <span class="n">counter</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChangeCounts</span><span class="p">:</span>
    <span class="sd">"""Make change using the fewest coins</span>

<span class="sd">    Args:</span>
<span class="sd">     money: the amount to change</span>
<span class="sd">     denominations: list of coin denominations in decreasing order</span>
<span class="sd">     table: memoization table (largest denomination, amount to change): best coin counts</span>
<span class="sd">     counter: number of times the function is called</span>

<span class="sd">    Returns:</span>
<span class="sd">     Number of each denomination needed to make the change, call_count</span>
<span class="sd">    """</span>
    <span class="n">table</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">table</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">money</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
	<span class="k">return</span> <span class="n">ChangeCounts</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominations</span><span class="p">),</span> <span class="n">counter</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">denominations</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">money</span><span class="p">)</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
	<span class="k">return</span> <span class="n">ChangeCounts</span><span class="p">(</span><span class="n">table</span><span class="p">[(</span><span class="n">denominations</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">money</span><span class="p">)],</span> <span class="n">counter</span><span class="p">)</span>

    <span class="n">last_denomination</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">best</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>
    <span class="n">best_counts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">current</span><span class="p">,</span> <span class="n">denomination</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">denominations</span><span class="p">):</span>
	<span class="n">count</span> <span class="o">=</span> <span class="n">money</span><span class="o">//</span><span class="n">denomination</span>
	<span class="n">remaining</span> <span class="o">=</span> <span class="n">money</span> <span class="o">-</span> <span class="n">count</span> <span class="o">*</span> <span class="n">denomination</span>

	<span class="k">if</span> <span class="n">current</span> <span class="o">==</span> <span class="n">last_denomination</span><span class="p">:</span>
	    <span class="k">if</span> <span class="n">remaining</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">count</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>
	    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">count</span><span class="p">]</span>
	    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">counts</span><span class="p">,</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">memoized_changer</span><span class="p">(</span>
		<span class="n">remaining</span><span class="p">,</span> <span class="n">denominations</span><span class="p">[</span><span class="n">current</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">table</span><span class="p">,</span> <span class="n">counter</span><span class="p">)</span>
	    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span>

	<span class="n">total_counts</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">total_counts</span> <span class="o">&lt;</span> <span class="n">best</span><span class="p">:</span>
	    <span class="n">best</span> <span class="o">=</span> <span class="n">total_counts</span>
	    <span class="n">best_counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">current</span> <span class="o">+</span> <span class="n">counts</span>
	<span class="n">table</span><span class="p">[(</span><span class="n">denomination</span><span class="p">,</span> <span class="n">money</span><span class="p">)]</span> <span class="o">=</span> <span class="n">counts</span>
    <span class="k">return</span> <span class="n">ChangeCounts</span><span class="p">(</span><span class="n">best_counts</span><span class="p">,</span> <span class="n">counter</span><span class="p">)</span>
</pre></div>
</div>

<div id="outline-container-org9fa6be5" class="outline-3">
<h3 id="org9fa6be5">Checking the Memoized Changer</h3>
<div class="outline-text-3" id="text-org9fa6be5">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_changers</span><span class="p">(</span><span class="n">changer</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="sd">"""Check that the changer matches the brute-force solution</span>

<span class="sd">    Arguments:</span>
<span class="sd">     changer: change-function to compare to brute-force</span>
<span class="sd">     amount: cents to change</span>
<span class="sd">     denominations: descending list of coin-denominations</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError: there's a discrepancy somewhere</span>
<span class="sd">    """</span>
    <span class="n">brute_counts</span> <span class="o">=</span> <span class="n">brute_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">denominations</span><span class="p">)</span>
    <span class="n">check_counts</span> <span class="o">=</span> <span class="n">changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">denominations</span><span class="p">)</span>
    <span class="n">check_coins</span><span class="p">(</span><span class="n">check_counts</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">denominations</span><span class="p">,</span> <span class="n">brute_counts</span><span class="o">.</span><span class="n">coin_counts</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_cases</span><span class="p">(</span><span class="n">changer</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Check the pre-picked cases are okay</span>

<span class="sd">    Arguments:</span>
<span class="sd">     changer: the dynamic-programming changer to check</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if something doesn't check out</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">changer</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">changer</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">double_dime</span><span class="p">)</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">changer</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">obsolete</span><span class="p">)</span>

	<span class="n">money</span> <span class="o">=</span> <span class="mi">2</span>
	<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">memoized_changer</span><span class="p">,</span> <span class="n">money</span><span class="p">,</span>  <span class="n">coins</span><span class="p">)</span>

	<span class="n">money</span> <span class="o">=</span> <span class="mi">28</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">memoized_changer</span><span class="p">,</span> <span class="n">money</span><span class="p">,</span>  <span class="n">coins</span><span class="p">)</span>

	<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">memoized_changer</span><span class="p">,</span> <span class="n">money</span><span class="p">,</span>  <span class="n">coins</span><span class="p">)</span>

	<span class="n">money</span> <span class="o">=</span> <span class="mi">14</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">memoized_changer</span><span class="p">,</span> <span class="n">money</span><span class="p">,</span>  <span class="n">coins</span><span class="p">)</span>

	<span class="c1"># the double-dimes</span>
	<span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
	<span class="n">money</span> <span class="o">=</span> <span class="mi">40</span>
	<span class="n">check_changers</span><span class="p">(</span><span class="n">memoized_changer</span><span class="p">,</span> <span class="n">money</span><span class="p">,</span>  <span class="n">coins</span><span class="p">)</span>
	<span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">check_cases</span><span class="p">(</span><span class="n">memoized_changer</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgf2c3d93" class="outline-3">
<h3 id="orgf2c3d93">Plotting</h3>
<div class="outline-text-3" id="text-orgf2c3d93">
</div>
<div id="outline-container-org0016168" class="outline-4">
<h4 id="org0016168">All the Methods So Far</h4>
<div class="outline-text-4" id="text-org0016168">
<div class="highlight"><pre><span></span><span class="n">memoized_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">memoized_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">run_count</span>
		   <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>
<span class="n">GREEDY_FRAME</span><span class="p">[</span><span class="s2">"Memoized"</span><span class="p">]</span> <span class="o">=</span> <span class="n">memoized_counts</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">GREEDY_FRAME</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			   <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Greedy"</span><span class="p">,</span> <span class="s2">"Cashier"</span><span class="p">,</span> <span class="s2">"Brute-Force"</span><span class="p">,</span>
				       <span class="s2">"Memoized"</span><span class="p">],</span>
			   <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			   <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Greedy, Brute-Force &amp; Memoized Change Counts (Common U.S. Coins)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"memoized-change-us-coins"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/memoized-change-us-coins.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
With a Brute-Force ceiling of 10 loops it's hard to see a marked improvement, given how much easier it is to write the Brute-Force method rather than the memoized one, but let's get rid of the two greedy methods and compare the brute force and memoized with more obsolete coins added in.
</p>
</div>
</div>

<div id="outline-container-orgfc599f1" class="outline-4">
<h4 id="orgfc599f1">Obsolete Coins</h4>
<div class="outline-text-4" id="text-orgfc599f1">
<p>
First, we'll check to make sure that the brute-force and memoized methods agree on the best coins for making change with our new denominations, which include some that were once used in the United States but aren't any more.
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Denominations</span><span class="o">.</span><span class="n">obsolete</span><span class="p">)</span>
</pre></div>

<pre class="example">
[25, 20, 10, 5, 3, 2, 1]
</pre>



<p>
Now let's see how the run-times compare.
</p>

<div class="highlight"><pre><span></span><span class="n">BRUTE_OBSOLETE</span> <span class="o">=</span> <span class="p">[</span><span class="n">brute_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">obsolete</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		  <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>
<span class="n">MEMOIZED_OBSOLETE</span> <span class="o">=</span> <span class="p">[</span><span class="n">memoized_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">obsolete</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">run_count</span>
		     <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>

<span class="n">OBSOLETE_FRAME</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Amount to Change"</span><span class="p">:</span> <span class="n">PLOT_AMOUNTS</span><span class="p">,</span>
				   <span class="s2">"Brute-Force"</span><span class="p">:</span> <span class="n">BRUTE_OBSOLETE</span><span class="p">,</span>
				   <span class="s2">"Memoized"</span><span class="p">:</span> <span class="n">MEMOIZED_OBSOLETE</span><span class="p">})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">OBSOLETE_FRAME</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			   <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Brute-Force"</span><span class="p">,</span>
				       <span class="s2">"Memoized"</span><span class="p">],</span>
			   <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			   <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Brute-Force &amp; Memoized Change Counts (Including Obsolete Coins)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"memoized-change-obsolete"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/memoized-change-obsolete.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
This time we have seven coin denominations so the brute-force method takes \(^7(8)/_2 = 28\) loops. Now that we have more coins the memoized does slightly (very slightly) worse than the brute-force for larger amounts, but in the examples so far I've been creating a new memo-table for every amount - what happens if we build one table and re-use it as we find the change for new amounts?
</p>

<div class="highlight"><pre><span></span><span class="n">OBSOLETE_TABLE</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">MEMOIZED_OBSOLETE_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">memoized_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span>
					<span class="n">Denominations</span><span class="o">.</span><span class="n">obsolete</span><span class="p">,</span>
					<span class="n">OBSOLETE_TABLE</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		       <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>

<span class="n">OBSOLETE_FRAME_2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Amount to Change"</span><span class="p">:</span> <span class="n">PLOT_AMOUNTS</span><span class="p">,</span>
			  <span class="s2">"Brute-Force"</span><span class="p">:</span> <span class="n">BRUTE_OBSOLETE</span><span class="p">,</span>
			  <span class="s2">"Memoized"</span><span class="p">:</span> <span class="n">MEMOIZED_OBSOLETE_2</span><span class="p">})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">OBSOLETE_FRAME_2</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			       <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Brute-Force"</span><span class="p">,</span>
					   <span class="s2">"Memoized"</span><span class="p">],</span>
			       <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			       <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Brute-Force &amp; Memoized Change Counts (Obsolete Coins, Re-Used Table)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"memoized-change-obsolete-keep-table"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/memoized-change-obsolete-keep-table.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
Re-using the table allows us to avoid some re-calculating and the number of calls eventually drops down to the number of coins we have, the same as the number of loops for the greedy method, although in this case we can handle cases where the greedy method fails.
</p>

<p>
Even better, now that we have the table built with all our allowed values, we can just look things up and don't need to run the function (although I will here just to make sure nothing funky is going on), so it has a cost of one.
</p>

<div class="highlight"><pre><span></span><span class="n">MEMOIZED_OBSOLETE_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">memoized_changer</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span>
					<span class="n">Denominations</span><span class="o">.</span><span class="n">obsolete</span><span class="p">,</span>
					<span class="n">OBSOLETE_TABLE</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		       <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>

<span class="n">OBSOLETE_FRAME_3</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Amount to Change"</span><span class="p">:</span> <span class="n">PLOT_AMOUNTS</span><span class="p">,</span>
			  <span class="s2">"Brute-Force"</span><span class="p">:</span> <span class="n">BRUTE_OBSOLETE</span><span class="p">,</span>
			  <span class="s2">"Memoized"</span><span class="p">:</span> <span class="n">MEMOIZED_OBSOLETE_3</span><span class="p">})</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">OBSOLETE_FRAME_3</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			       <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Brute-Force"</span><span class="p">,</span>
					   <span class="s2">"Memoized"</span><span class="p">],</span>
			       <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			       <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Brute-Force &amp; Memoized Change Counts (Obsolete Coins, Pre-Filled Table)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"memoized-change-obsolete-pre-filled-table"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/memoized-change-obsolete-pre-filled-table.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc57b1d6" class="outline-2">
<h2 id="orgc57b1d6">Iterative Dynamic Programming</h2>
<div class="outline-text-2" id="text-orgc57b1d6">
<p>
The idea behind this problem (making change) is to show how Dynamic Programming can eleminate redundant calculations, so this is the point where I'll switch to an iterative approach that uses Dynamic Programming. The iterative, top-down approach works in the opposite direction of the memoized approach, starting with the smallest values and then moving to ever increasing values, storing the outcomes as we go so that we can re-use the lower solutions as the values increase. This is where I was stumped for a while - since the memoized function I used is based on the remainders left over after subtracting a coin's value from it (e.g. 26 cents minus a quarter has a remainder of 1 cent so we use the stored 1-cent solution from the memo-table rather than re-calculating it) in order to create an iterative version we somehow have to store the values in the table before they are needed, but the scheme I used where we iterate over the coin-denominations doesn't work (or it makes it really convoluted to force it to work). From what I can tell this is because I didn't really make a dynamic programming solution with the memoized version. With Dynamic Programming our memo-table should be built around the change we need to give out, so you would have a table with all the possible amounts, not just the ones needed as remainders. This works with our depth-first version because we're starting at the leaf nodes and working back up the tree, but it doesn't work with the iterative version because we don't know ahead of time which remainders we need later on in the table. For example, if we can only use 1-cent and 10-cent coins and we need to make change for 11 cents, then we have to have an entry for 1-cent in the table before we get to figuring out the solution that includes the 10-cent piece. If we need to break 12 cents, though, we need to have an entry for 2 cents before we get to calculating the entry for 10 cents. But how do we know which values we need to enter into the table for the 1-cent piece before we get to the 10 cent piece? 
</p>

<p>
The solution is to fill out the table completely from 1 to the amount to make change for each coin before moving on to the next larger denomination. So, for our 12-cent example we need entries for \(1 \ldots 12\) cents for the 1 cent piece filled out before we move on to calculating the entries for the 10 cent piece so that no matter what remainder we have when we reach the 10-cent piece we can look it up in the table (we actually only need up to 9 cents, but since the denominations aren't fixed doing the trimming once again adds to the complexity more than I'd like). So, I'll just fill out the table and we can see how it goes.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">centaur</span><span class="p">(</span><span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChangeCountsTable</span><span class="p">:</span>
    <span class="sd">"""Make change using the fewest coins</span>

<span class="sd">    Warning:</span>
<span class="sd">     To keep the answers matching the other functions it's assumed that the denominations</span>
<span class="sd">     are in decreasing order and the solution will also be match a decreasing order</span>

<span class="sd">    Args:</span>
<span class="sd">     money: the amount to change</span>
<span class="sd">     denominations: list of coin denominations in decreasing order</span>
<span class="sd">     table: memoization table (largest denomination, amount to change): best coin counts</span>

<span class="sd">    Returns:</span>
<span class="sd">     Number of each denomination needed to make the change, call_count, lookup table</span>
<span class="sd">    """</span>
    <span class="c1"># the denominations need to be in ascending order, the opposite of the other methods</span>
    <span class="n">denominations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">denominations</span><span class="p">))</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">table</span><span class="p">:</span>
	<span class="n">table</span> <span class="o">=</span> <span class="p">{</span><span class="n">denomination</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">amount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">denomination</span> <span class="ow">in</span> <span class="n">denominations</span><span class="p">}</span>
	<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">denomination</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">denominations</span><span class="p">):</span>
	    <span class="n">table</span><span class="p">[</span><span class="n">denomination</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">best</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>
    <span class="n">best_counts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">owed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">amount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">denomination</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">denominations</span><span class="p">):</span>
	    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">count</span> <span class="o">=</span> <span class="n">owed</span><span class="o">//</span><span class="n">denomination</span>
	    <span class="n">remainder</span> <span class="o">=</span> <span class="n">owed</span> <span class="o">-</span> <span class="n">count</span> <span class="o">*</span> <span class="n">denomination</span>
	    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">count</span><span class="p">]</span>

	    <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">counts</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">denominations</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]][</span><span class="n">remainder</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span>

	    <span class="n">table</span><span class="p">[</span><span class="n">denomination</span><span class="p">][</span><span class="n">owed</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts</span>

	    <span class="k">if</span> <span class="n">amount</span> <span class="o">==</span> <span class="n">owed</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">best</span><span class="p">:</span>
		<span class="n">best</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
		<span class="n">best_counts</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">denominations</span><span class="p">)</span> <span class="o">-</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># put solution in descending order to match other functions</span>
    <span class="n">best_counts</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ChangeCountsTable</span><span class="p">(</span><span class="n">best_counts</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">check_cases</span><span class="p">(</span><span class="n">centaur</span><span class="p">)</span>
</pre></div>
</div>

<div id="outline-container-org4070527" class="outline-3">
<h3 id="org4070527">Plotting</h3>
<div class="outline-text-3" id="text-org4070527">
<p>
Since the iterative version works differently from the others the loop-counts aren't really easy to compare.
</p>

<div class="highlight"><pre><span></span><span class="n">centaur_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">centaur</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">Denominations</span><span class="o">.</span><span class="n">US</span><span class="p">)</span><span class="o">.</span><span class="n">run_count</span>
		   <span class="k">for</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">PLOT_AMOUNTS</span><span class="p">]</span>
<span class="n">GREEDY_FRAME</span><span class="p">[</span><span class="s2">"Iterative"</span><span class="p">]</span> <span class="o">=</span> <span class="n">centaur_counts</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">GREEDY_FRAME</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">],</span>
			   <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Greedy"</span><span class="p">,</span> <span class="s2">"Cashier"</span><span class="p">,</span> <span class="s2">"Brute-Force"</span><span class="p">,</span>
				       <span class="s2">"Memoized"</span><span class="p">,</span> <span class="s2">"Iterative"</span><span class="p">],</span>
			   <span class="n">var_name</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">,</span>
			   <span class="n">value_name</span><span class="o">=</span><span class="s2">"Loop Count"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Amount to Change"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Loop Count"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Amount to Change"</span><span class="p">,</span> <span class="s2">"Loop Count"</span><span class="p">,</span> <span class="s2">"Change Method"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Change Method"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Coin Change Counts (Common U.S. Coins)"</span><span class="p">,</span>
	<span class="n">width</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="n">PlotParameters</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"all-change-us-coins"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-coin-changing-problem/all-change-us-coins.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
Since I'm filling out the whole table for the iterative function the loop is dependent on the amount of change owed, not the number of coin-denominations as with the other functions so it increases linearly. There's something I'm missing here as to why either the memoized-version is incorrect or there is an advantage to using the iterative version, but I haven't figured it out yet. The solutions seem to be the same in either case, though, and the linear growth for the number of loops is still tractable so I'll move on for now.
</p>
</div>
</div>
</div>

<div id="outline-container-org7378d5a" class="outline-2">
<h2 id="org7378d5a">Sources</h2>
<div class="outline-text-2" id="text-org7378d5a">
<ul class="org-ul">
<li>[LATPAPS] <a href="posts/latpaps/">Learning Algorithms Through Programming and Problem Solving</a>
</li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("cashiers-algorithm"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("greedy-algorithm"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/course-global-warming/" class="u-url">Global Warming I: The Science and Modeling of Climate Change</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/course-global-warming/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-15T18:51:20-07:00" itemprop="datePublished" title="2022-06-15 18:51">2022-06-15 18:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org5b2510e" class="outline-2">
<h2 id="org5b2510e">Syllabus</h2>
<div class="outline-text-2" id="text-org5b2510e">
</div>
<div id="outline-container-org5f55f62" class="outline-3">
<h3 id="org5f55f62">Overview</h3>
</div>
<div id="outline-container-org30e12ea" class="outline-3">
<h3 id="org30e12ea">Heat, Light, and Energy</h3>
</div>
<div id="outline-container-org05896f7" class="outline-3">
<h3 id="org05896f7">First Climate Model</h3>
</div>
<div id="outline-container-org7928b7d" class="outline-3">
<h3 id="org7928b7d">Greenhouse Gasses and the Atmosphere</h3>
</div>
</div>
<div id="outline-container-orgabab8a0" class="outline-2">
<h2 id="orgabab8a0">Source</h2>
<div class="outline-text-2" id="text-orgabab8a0">
<ul class="org-ul">
<li>Global Warming I: The Science and Modeling of Climate Change [Internet]. Coursera. [cited 2022 Jun 15]. Available from: <a href="https://www.coursera.org/learn/global-warming">https://www.coursera.org/learn/global-warming</a>
</li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-much-coal-to-power-a-light-bulb/" class="u-url">How much coal does it take to power a light bulb?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/how-much-coal-to-power-a-light-bulb/" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-15T17:28:30-07:00" itemprop="datePublished" title="2022-06-15 17:28">2022-06-15 17:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/how-much-coal-to-power-a-light-bulb/#org08c862d">How many Joules of energy does it take to power a 100 Watt light bulb for one day?</a></li>
<li><a href="posts/how-much-coal-to-power-a-light-bulb/#orgf5a7f57">Double-Check The Math</a></li>
<li><a href="posts/how-much-coal-to-power-a-light-bulb/#org71e2e0b">Source</a></li>
</ul>
</div>
</div>
<div id="outline-container-org08c862d" class="outline-2">
<h2 id="org08c862d">How many Joules of energy does it take to power a 100 Watt light bulb for one day?</h2>
<div class="outline-text-2" id="text-org08c862d">
<p>
<b><b>Given:</b></b>
</p>

<p>
\[
1 Watt = 1 \frac{Joule}{Second}
\]
</p>

<p>
For a 100 Watt Bulb:
</p>

<p>
\[
\require{cancel}
(100 \cancel{Watt})\left(1 \frac{\frac{Joule}{Second}}{\cancel{Watt}}\right) = 100 \frac{Joule}{Second}
\]
</p>

<p>
For One Minute:
</p>

<p>
\[
\left(100 \frac{Joule}{\cancel{Second}}\right) \left(60 \frac{\cancel{Second}}{Minute}\right) = 6{,}000 \frac{Joule}{Minute}
\]
</p>

<p>
For One Hour:
</p>

<p>
\[
\left(6 \times 10^3 \frac{Joule}{\cancel{Minute}}\right)\left(60 \frac{\cancel{Minute}}{Hour}\right) = 3.6 \times 10^5 \frac{Joule}{Hour}
\]
</p>

<p>
For One Day:
</p>

<p>
\[
\left(3.6 \times 10^5 \frac{Joule}{\cancel{Hour}}\right)\left(24 \frac{\cancel{Hour}}{Day}\right) = 8.64 \times 10^6 \frac{Joule}{Day}
\]
</p>
</div>
</div>

<div id="outline-container-orgf5a7f57" class="outline-2">
<h2 id="orgf5a7f57">Double-Check The Math</h2>
<div class="outline-text-2" id="text-orgf5a7f57">
<div class="highlight"><pre><span></span><span class="n">bulb</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Watt (Joule/Second)</span>
<span class="n">per_minute</span> <span class="o">=</span> <span class="n">bulb</span> <span class="o">*</span> <span class="mi">60</span> <span class="c1"># Second/Minute</span>
<span class="n">per_hour</span> <span class="o">=</span> <span class="n">per_minute</span> <span class="o">*</span> <span class="mi">60</span> <span class="c1"># Minute/Hour</span>
<span class="n">per_day</span> <span class="o">=</span> <span class="n">per_hour</span> <span class="o">*</span> <span class="mi">24</span> <span class="c1"># Hour/Day</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"A 100 Watt Light bulb uses </span><span class="si">{</span><span class="n">per_day</span><span class="si">:</span><span class="s2">0.2e</span><span class="si">}</span><span class="s2"> Joules per day."</span><span class="p">)</span>
</pre></div>

<pre class="example">
A 100 Watt Light bulb uses 8.64e+06 Joules per day.
</pre>
</div>
</div>
<div id="outline-container-org71e2e0b" class="outline-2">
<h2 id="org71e2e0b">Source</h2>
<div class="outline-text-2" id="text-org71e2e0b">
<ul class="org-ul">
<li><a href="posts/course-global-warming/">Global Warming I: The Science and Modeling of Climate Change</a></li>
</ul>
</div>
</div>
    </div>
    </article>
</div>

        <ul class="pager postindexpager clearfix">
<li class="next"><a href="index-7.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script><!--End of body content--><footer id="footer"><a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
 <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
