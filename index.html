<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Striking out for data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bowling For Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/index.html">
<link rel="next" href="index-7.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/bubba-sort-page-2/index.html" type="text/html">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href=".">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="pages/" class="nav-link">Pages</a>
                </li>
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Monkey Pages</a>
            <div class="dropdown-menu">
                    <a href="https://necromuralist.github.io/" class="dropdown-item">The Cloistered Monkey</a>
                    <a href="https://necromuralist.github.io/Ape-Iron/" class="dropdown-item">Ape Iron</a>
                    <a href="https://necromuralist.github.io/Beach-Pig-Thigh/" class="dropdown-item">Beach-Pig Rump &amp; Thigh</a>
                    <a href="https://necromuralist.github.io/Neurotic-Networking/" class="dropdown-item">Neurotic Networking</a>
                    <a href="https://necromuralist.github.io/Visions-Voices-Data/" class="dropdown-item">Visions, Voices, Data</a>
            </div>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/bubba-sort-page-2/index.html" class="u-url">A Ray</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/bubba-sort-page-2/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-24T16:57:36-07:00" itemprop="datePublished" title="2023-03-24 16:57">2023-03-24 16:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
<img src="posts/bubba-sort-page-2/bubba-004-1250.png" alt="Panel 4"></p>

<p>
<img src="posts/bubba-sort-page-2/bubba-005-1250px.png" alt="Panel 5"></p>

<p>
<img src="posts/bubba-sort-page-2/bubba-006.webp" alt="Panel 6"></p>

<p>
<a href="posts/bubba-sort-page-1/">Previous Bubba</a>
</p>

<p>
<a href="pages/bubba-sort/bubba-sort-pages/">Table of Contents</a>
</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/nyc-shootings-python-version/index.html" class="u-url">NYC Shootings (Python Version)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/nyc-shootings-python-version/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-22T13:18:14-07:00" itemprop="datePublished" title="2023-03-22 13:18">2023-03-22 13:18</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li>
<a href="posts/nyc-shootings-python-version/index.html#org64b4ed3">NYPD Shooting Incident Data Version 2 (with python)</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org728dfee">Imports and Setup</a></li>
</ul>
</li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orgd8e8a83">The Data</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org8f426c3">Loading It</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgf539cbf">The Columns</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgce6f148">Missing Data</a></li>
</ul>
</li>
<li><a href="posts/nyc-shootings-python-version/index.html#org72407fc">Incident Key</a></li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#org3157945">OCCUR_DATE and OCCUR_TIME</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org4497f90">Shootings By Month</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org9ab793a">90 Day Rolling Window</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgb7f75f1">By Year</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org5b51f8f">Monthly By Year</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgd4e184e">Medain By Month</a></li>
</ul>
</li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orgec616b1">Location</a>
<ul>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orge08e565">Descriptions</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#orga4dc220">BORO</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgf1a2579">PRECINCT &amp; JURISDICTION_CODE</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org1ec5757">LOCATION_DESC</a></li>
</ul>
</li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orgd7b6677">Coordinates</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org424e5d3">X_COORD_CD &amp; Y_COORD_CD</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org98096f1">Latitude &amp; Longitude</a></li>
</ul>
</li>
<li><a href="posts/nyc-shootings-python-version/index.html#org0377c8b">With GeoPandas</a></li>
</ul>
</li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#org942e262">Murder or Not</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org62c52a3">By Year</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org9a5fbfc">By Month</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgab955bf">By Coordinate</a></li>
</ul>
</li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orgdcaac13">Victims and Perpetrators</a>
<ul>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orgf0dd83c">Perpetrators</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org3335cad">PERP_AGE_GROUP</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgaa382e6">PEPR_SEX</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org489fecc">PERP_RACE</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org9c9c574">Handling the Unknowns</a></li>
</ul>
</li>
<li>
<a href="posts/nyc-shootings-python-version/index.html#orgd13c407">Victims</a>
<ul>
<li><a href="posts/nyc-shootings-python-version/index.html#org5387ebd">VIC_AGE_GROUP</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#orge9d1cfb">VIC_SEX</a></li>
<li><a href="posts/nyc-shootings-python-version/index.html#org1f69448">VIC_RACE</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/nyc-shootings-python-version/index.html#orgfc57088">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-org64b4ed3" class="outline-2">
<h2 id="org64b4ed3">NYPD Shooting Incident Data Version 2 (with python)</h2>
<div class="outline-text-2" id="text-org64b4ed3">
<p>
This is a replication (more or less) of the <a href="posts/nypd-shooting-incident-data/">NYPD Shooting Incident Data</a> post which we did using R but this time we'll use python and pandas instead. Once again we'll be looking at the <a href="https://catalog.data.gov/dataset/nypd-shooting-incident-data-historic">NYPD Shooting Incident Data (Historic)</a> from the <a href="https://catalog.data.gov/dataset">DATA.gov</a> catalog of datasets, which lists every shooting from 2006 through the last updated incident (as of March 22, 2023 it shows that it was last updated June 9, 2022 but we'll have to look at it to see what the date of the last incident was).
</p>
</div>

<div id="outline-container-org728dfee" class="outline-3">
<h3 id="org728dfee">Imports and Setup</h3>
<div class="outline-text-3" id="text-org728dfee">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
</pre></div>

<p>
First, let's double-check which version of python we're using.
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</pre></div>

<pre class="example">
3.9.9 (main, Dec  3 2021, 01:15:49) 
[GCC 10.2.1 20210110]
</pre>


<p>
We're running python 3.9.9. I was running it in pypy but for some reason the pandas' <code>groupby</code> method would hang so this is done in cPython.
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">altair</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>

<pre class="example">
5.0.0rc1
</pre>


<p>
I found out after I'd been struggling with altair for a little while that they're about to make a major release that breaks some of the ways you use it (in the prior versions). Since it's been a while since I've used altair I decided to go with the newer, upcoming version rather than re-learn the current one and then learn the new version of altair once it's released.
</p>

<p>
This next bit is a little setup to make nicer tables.
</p>

<div class="highlight"><pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">)</span>
</pre></div>

<p>
This is to help with the plotting.
</p>

<div class="highlight"><pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"nyc-shootings-python-version"</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="n">SLUG</span><span class="p">)</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">650</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-orgd8e8a83" class="outline-2">
<h2 id="orgd8e8a83">The Data</h2>
<div class="outline-text-2" id="text-orgd8e8a83">
</div>
<div id="outline-container-org8f426c3" class="outline-3">
<h3 id="org8f426c3">Loading It</h3>
<div class="outline-text-3" id="text-org8f426c3">
<p>
The data is available to download as a CSV so we'll pass the URL for the CSV to pandas and make a dataframe.
</p>

<div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">"https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Rows: </span><span class="si">{</span><span class="n">rows</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="se">\t</span><span class="s2">Columns: </span><span class="si">{</span><span class="n">columns</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
Rows: 25,596	Columns: 19
</pre>
</div>
</div>

<div id="outline-container-orgf539cbf" class="outline-3">
<h3 id="orgf539cbf">The Columns</h3>
<div class="outline-text-3" id="text-orgf539cbf">
<p>
We'll start looking at the data by examining what's in the columns. We saw from the data frame's shape that we have 19 columns, how many of them does pandas think are numeric?
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">showindex</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left"> </th>
<th scope="col" class="org-right">INCIDENT_KEY</th>
<th scope="col" class="org-right">PRECINCT</th>
<th scope="col" class="org-right">JURISDICTION_CODE</th>
<th scope="col" class="org-right">X_COORD_CD</th>
<th scope="col" class="org-right">Y_COORD_CD</th>
<th scope="col" class="org-right">Latitude</th>
<th scope="col" class="org-right">Longitude</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">count</td>
<td class="org-right">25596</td>
<td class="org-right">25596</td>
<td class="org-right">25594</td>
<td class="org-right">25596</td>
<td class="org-right">25596</td>
<td class="org-right">25596</td>
<td class="org-right">25596</td>
</tr>
<tr>
<td class="org-left">mean</td>
<td class="org-right">1.12383e+08</td>
<td class="org-right">65.8694</td>
<td class="org-right">0.331601</td>
<td class="org-right">1.00945e+06</td>
<td class="org-right">207894</td>
<td class="org-right">40.7372</td>
<td class="org-right">-73.909</td>
</tr>
<tr>
<td class="org-left">std</td>
<td class="org-right">6.78612e+07</td>
<td class="org-right">27.2019</td>
<td class="org-right">0.742266</td>
<td class="org-right">18421.4</td>
<td class="org-right">31857.4</td>
<td class="org-right">0.087447</td>
<td class="org-right">0.0664265</td>
</tr>
<tr>
<td class="org-left">min</td>
<td class="org-right">9.95324e+06</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">914928</td>
<td class="org-right">125757</td>
<td class="org-right">40.5116</td>
<td class="org-right">-74.2493</td>
</tr>
<tr>
<td class="org-left">25%</td>
<td class="org-right">6.15936e+07</td>
<td class="org-right">44</td>
<td class="org-right">0</td>
<td class="org-right">1.00001e+06</td>
<td class="org-right">182782</td>
<td class="org-right">40.6683</td>
<td class="org-right">-73.9431</td>
</tr>
<tr>
<td class="org-left">50%</td>
<td class="org-right">8.64373e+07</td>
<td class="org-right">69</td>
<td class="org-right">0</td>
<td class="org-right">1.00772e+06</td>
<td class="org-right">194038</td>
<td class="org-right">40.6991</td>
<td class="org-right">-73.9153</td>
</tr>
<tr>
<td class="org-left">75%</td>
<td class="org-right">1.66661e+08</td>
<td class="org-right">81</td>
<td class="org-right">0</td>
<td class="org-right">1.01684e+06</td>
<td class="org-right">239429</td>
<td class="org-right">40.8238</td>
<td class="org-right">-73.8824</td>
</tr>
<tr>
<td class="org-left">max</td>
<td class="org-right">2.3849e+08</td>
<td class="org-right">123</td>
<td class="org-right">2</td>
<td class="org-right">1.06682e+06</td>
<td class="org-right">271128</td>
<td class="org-right">40.9108</td>
<td class="org-right">-73.702</td>
</tr>
</tbody>
</table>
<p>
Just seven of them, and four are coordinates and the other three are categorical. This isn't really surprising, since the data isn't measuring anything but is rather a listing of shooting incidents reported (each row represents a single incident).
</p>

<p>
There's a table on the <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Shooting-Incident-Data-Historic-/833y-fsy8">NYPD-Shooting-Incident-Data</a> page that describes the columns.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Column Name</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Type</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">INCIDENT_KEY</td>
<td class="org-left">Randomly generated persistent ID for each arrest</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">OCCUR_DATE</td>
<td class="org-left">Exact date of the shooting incident</td>
<td class="org-left">Date &amp; Time</td>
</tr>
<tr>
<td class="org-left">OCCUR_TIME</td>
<td class="org-left">Exact time of the shooting incident</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">BORO</td>
<td class="org-left">Borough where the shooting incident occurred</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">PRECINCT</td>
<td class="org-left">Precinct where the shooting incident occurred</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">JURISDICTIONAL_CODE</td>
<td class="org-left">Jurisdiction where it occurred</td>
<td class="org-left">Number</td>
</tr>
<tr>
<td class="org-left">LOCATION_DESC</td>
<td class="org-left">Location of the incident</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">STATISTICAL_MURDER_FLAG</td>
<td class="org-left">Victim died</td>
<td class="org-left">Checkbox</td>
</tr>
<tr>
<td class="org-left">PERP_AGE_GROUP</td>
<td class="org-left">Perpetrator's age within a category</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">PERP_SEX</td>
<td class="org-left">Pepetrator's sex.</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">PERP_RACE</td>
<td class="org-left">Perpetrator's race.</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">VIC_AGE_GROUP</td>
<td class="org-left">Victim's age with a category.</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">VIC_SEX</td>
<td class="org-left">Victim's sex.</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">VIC_RACE</td>
<td class="org-left">Victim's Race</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">X_COORD_CD</td>
<td class="org-left">Midblock X-coordinate for New York State Plane Coordinate System</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">Y_COORD_CD</td>
<td class="org-left">Midblock Y-coordinate</td>
<td class="org-left">Plain Text</td>
</tr>
<tr>
<td class="org-left">Latitude</td>
<td class="org-left">Latitude coordinate</td>
<td class="org-left">Number</td>
</tr>
<tr>
<td class="org-left">Longitude</td>
<td class="org-left">Longitude</td>
<td class="org-left">Number</td>
</tr>
<tr>
<td class="org-left">Lon_Lat</td>
<td class="org-left">Longitude and Latitude Coordinate for mapping</td>
<td class="org-left">Point</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgce6f148" class="outline-3">
<h3 id="orgce6f148">Missing Data</h3>
<div class="outline-text-3" id="text-orgce6f148">
<div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">missing</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"index"</span><span class="p">:</span> <span class="s2">"Column"</span><span class="p">,</span>
	     <span class="mi">0</span><span class="p">:</span> <span class="s2">"Missing"</span><span class="p">})</span>

<span class="n">some_missing</span> <span class="o">=</span> <span class="n">missing</span><span class="p">[</span><span class="n">missing</span><span class="o">.</span><span class="n">Missing</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">some_missing</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"Fraction"</span><span class="p">]</span> <span class="o">=</span> <span class="n">some_missing</span><span class="o">.</span><span class="n">Missing</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">some_missing</span><span class="p">))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Column</th>
<th scope="col" class="org-right">Missing</th>
<th scope="col" class="org-right">Fraction</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">JURISDICTION_CODE</td>
<td class="org-right">2</td>
<td class="org-right">7.81372e-05</td>
</tr>
<tr>
<td class="org-left">LOCATION_DESC</td>
<td class="org-right">14977</td>
<td class="org-right">0.58513</td>
</tr>
<tr>
<td class="org-left">PERP_AGE_GROUP</td>
<td class="org-right">9344</td>
<td class="org-right">0.365057</td>
</tr>
<tr>
<td class="org-left">PERP_SEX</td>
<td class="org-right">9310</td>
<td class="org-right">0.363729</td>
</tr>
<tr>
<td class="org-left">PERP_RACE</td>
<td class="org-right">9310</td>
<td class="org-right">0.363729</td>
</tr>
</tbody>
</table>
<p>
Most entries are missing location descriptions for some reason, and quite a lot of perpertator data is missing, possibly because they didn't catch whoever did the shooting in those cases.
</p>
</div>
</div>
</div>
<div id="outline-container-org72407fc" class="outline-2">
<h2 id="org72407fc">Incident Key</h2>
<div class="outline-text-2" id="text-org72407fc">
<p>
The incident key is an identifier for a specific incident so it's only really useful if you need to look up or refer to one or more of them, but we'll be looking at things in aggregate making them less useful for us, except maybe for looking at anomalies. Let's just make sure that the identifiers are unique as I'm asserting that they are.
</p>

<div class="highlight"><pre><span></span><span class="n">id_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">INCIDENT_KEY</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">incidents</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Identifiers: </span><span class="si">{</span><span class="n">id_count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="se">\t</span><span class="s2">Incidents: </span><span class="si">{</span><span class="n">incidents</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"There are </span><span class="si">{</span><span class="n">incidents</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">id_count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> more rows than incident IDs."</span><span class="p">)</span>
</pre></div>

<pre class="example">
Identifiers: 20,126	Incidents: 25,596
There are 5,470 more rows than incident IDs.
</pre>


<p>
It appears that I wasn't correct in my assumption… let's take a look at one of the incidents.
</p>

<div class="highlight"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">INCIDENT_KEY</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">up_counts</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">top_id</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Incident: </span><span class="si">{</span><span class="n">top_id</span><span class="si">}</span><span class="se">\t</span><span class="s2">Count: </span><span class="si">{</span><span class="n">top</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
Incident: 173354054	Count: 18
</pre>


<p>
Inspecting the dataframe it looks like in some cases more than one person was shot per incident, so there's multiple rows (one per person shot) for a single incident. Kind of scary that eighteen people got shot at one incident, if my interpretation is correct, but that's life in the big city, I guess. Reading the <a href="https://data.cityofnewyork.us/api/views/833y-fsy8/files/e4e3d86c-348f-4a16-a17f-19480c089429?download=true&amp;filename=NYPD_Shootings_Incident_Level_Data_Footnotes.pdf">Footnotes</a> (link is to a PDF) it says:
</p>

<blockquote>
<p>
A shooting incident can have multiple victims involved and as a result duplicate INCIDENT_KEYs are produced.
</p>
</blockquote>

<p>
So it appears each row represents the victim of a shooting and each <code>INCIDENT_KEY</code> represents a shooting where one or more person was shot. The footnotes also note that only incidents where a victim was shot are included. If someone fired a gun but didn't hit anyone then it isn't represented in the data set.
</p>

<p>
<b><b>Note:</b></b> There's actually a slight discrepancy between the descriptions of the <code>INCIDENT_KEY</code> between the web-page and the PDF footnotes. According to the Web-Page the ID is for each arrest while the footnotes make it sound like they represent cases where there was at least one victim, whether or not someone was arrested. For our purposes this won't matter, since we're only using the data as a source for data visualization, but if one were really trying to understand what was happening in NYC knowing exactly what the data represents might be important (assuming not all cases with a shooting victim leads to an arrest).
</p>

<div class="highlight"><pre><span></span><span class="n">use_counts</span> <span class="o">=</span> <span class="n">up_counts</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">use_counts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"INCIDENT_KEY"</span><span class="p">,</span>
		 <span class="nb">type</span><span class="o">=</span><span class="s2">"nominal"</span><span class="p">,</span>
		 <span class="n">sort</span><span class="o">=</span><span class="s2">"-y"</span><span class="p">,</span>
		 <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"INCIDENT_KEY"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"nominal"</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"count"</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
   <span class="n">title</span><span class="o">=</span><span class="s2">"Incidents with Multiple Shots"</span><span class="p">,</span>
   <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
   <span class="n">height</span><span class="o">=</span><span class="mi">525</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"multiple_shot_incidents"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/multiple_shot_incidents.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
It looks like a lot of entries have more than one row. Does this mean many incidents have more than one victim? More than one shooter?
</p>

<div class="highlight"><pre><span></span><span class="n">fractions</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">counts</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">fractions</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Percent of Rows"</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">"count"</span><span class="p">:</span> <span class="s2">"Rows"</span><span class="p">})</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">fractions</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Rows"</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">fractions</span><span class="p">[</span><span class="s2">"Percent of Rows"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Percent of Rows"</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">70</span><span class="p">))),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Rows"</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Percent of Rows"</span><span class="p">)])</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
		 <span class="n">title</span><span class="o">=</span><span class="s2">"Percent Of Incidents with Multiple Rows"</span><span class="p">,</span>
		 <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
		 <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"fraction_row_incidents"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/fraction_row_incidents.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
The majority of the incidents do have only one row in the dataset. Perhaps it's not as unusual as I think it is to have multiple people involved in a shooting.
</p>
</div>
</div>

<div id="outline-container-org3157945" class="outline-2">
<h2 id="org3157945">OCCUR_DATE and OCCUR_TIME</h2>
<div class="outline-text-2" id="text-org3157945">
<p>
There are two columns that tell us when the shooting is supposed to have happened.
</p>

<div class="highlight"><pre><span></span><span class="n">example</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">INCIDENT_KEY</span><span class="o">==</span><span class="n">top_id</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"OCCUR_DATE: </span><span class="si">{</span><span class="n">example</span><span class="o">.</span><span class="n">OCCUR_DATE</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">OCCUR_DATE</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"OCCUR_TIME: </span><span class="si">{</span><span class="n">example</span><span class="o">.</span><span class="n">OCCUR_TIME</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">OCCUR_TIME</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>

<pre class="example">
OCCUR_DATE: 01/06/2018 (object)
OCCUR_TIME: 21:05:00 (object)
</pre>


<p>
Pandas interpreted both of these as strings, but it'd probably be more useful for us if they were datetime objects.
</p>

<div class="highlight"><pre><span></span><span class="n">MONTH</span><span class="p">,</span> <span class="n">DAY</span><span class="p">,</span> <span class="n">YEAR</span> <span class="o">=</span> <span class="s2">"%m"</span><span class="p">,</span> <span class="s2">"</span><span class="si">%d</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"%Y"</span>
<span class="n">HOUR</span><span class="p">,</span> <span class="n">MINUTE</span><span class="p">,</span> <span class="n">SECOND</span> <span class="o">=</span> <span class="s2">"%H"</span><span class="p">,</span> <span class="s2">"%M"</span><span class="p">,</span> <span class="s2">"%S"</span>
<span class="n">DATE_FORMAT</span> <span class="o">=</span> <span class="s2">"/"</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">MONTH</span><span class="p">,</span> <span class="n">DAY</span><span class="p">,</span> <span class="n">YEAR</span><span class="p">))</span>
<span class="n">TIME_FORMAT</span> <span class="o">=</span> <span class="s2">":"</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">HOUR</span><span class="p">,</span> <span class="n">MINUTE</span><span class="p">,</span> <span class="n">SECOND</span><span class="p">))</span>
<span class="n">FORMAT</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">DATE_FORMAT</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">TIME_FORMAT</span><span class="si">}</span><span class="s2">"</span>
<span class="n">DATE_COLUMN</span> <span class="o">=</span> <span class="s2">"date_time"</span>
<span class="n">data</span><span class="p">[</span><span class="n">DATE_COLUMN</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">OCCUR_DATE</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">OCCUR_TIME</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">FORMAT</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">check_date</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">INCIDENT_KEY</span><span class="o">==</span><span class="n">top_id</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"OCCUR_DATE: </span><span class="si">{</span><span class="n">check_date</span><span class="o">.</span><span class="n">OCCUR_DATE</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"New Date: </span><span class="si">{</span><span class="n">check_date</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"OCCUR_TIME: </span><span class="si">{</span><span class="n">check_date</span><span class="o">.</span><span class="n">OCCUR_TIME</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"New Time: </span><span class="si">{</span><span class="n">check_date</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
OCCUR_DATE: 01/06/2018
New Date: 2018-01-06
OCCUR_TIME: 21:05:00
New Time: 21:05:00
</pre>


<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">OCCUR_DATE</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">OCCUR_DATE</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>

<pre class="example">
01/01/2006
12/31/2021
</pre>


<p>
Our dataset covers the years from 2006 throught 20021. Let's see how many there are from month to month.
</p>
</div>

<div id="outline-container-org4497f90" class="outline-3">
<h3 id="org4497f90">Shootings By Month</h3>
<div class="outline-text-3" id="text-org4497f90">
<div class="highlight"><pre><span></span><span class="n">indexed</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">DATE_COLUMN</span><span class="p">)</span>
<span class="n">monthly</span> <span class="o">=</span> <span class="n">indexed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s2">"M"</span><span class="p">))</span>
<span class="n">monthly_counts</span> <span class="o">=</span> <span class="n">monthly</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">"INCIDENT_KEY"</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"INCIDENT_KEY"</span><span class="p">:</span> <span class="s2">"Shootings"</span><span class="p">,</span>
	     <span class="s2">"date_time"</span><span class="p">:</span> <span class="s2">"Month"</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"Shootings"</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">MONTH_YEAR</span> <span class="o">=</span> <span class="s2">"%B %Y"</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">monthly_counts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"temporal"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">MONTH_YEAR</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Shootings By Month"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"monthly_incidents"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/monthly_incidents.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
It looks like shootings went down in 2013 then shot back up again in the Summer of 2020.
</p>
</div>
</div>

<div id="outline-container-org9ab793a" class="outline-3">
<h3 id="org9ab793a">90 Day Rolling Window</h3>
<div class="outline-text-3" id="text-org9ab793a">
<div class="highlight"><pre><span></span><span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"Rolling Mean"</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"Shootings"</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span>
    <span class="n">halflife</span><span class="o">=</span><span class="s2">"90 days"</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">monthly_counts</span><span class="o">.</span><span class="n">Month</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">pre_melt</span> <span class="o">=</span> <span class="n">monthly_counts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Shootings"</span><span class="p">:</span> <span class="s2">"Sum"</span><span class="p">})</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">pre_melt</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">"Aggregation"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Aggregated Value"</span><span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	       <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">),</span>
	       <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Aggregated Value"</span><span class="p">),</span>
	       <span class="n">color</span><span class="o">=</span><span class="s2">"Aggregation"</span><span class="p">,</span>
	       <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">MONTH_YEAR</span><span class="p">),</span>
			<span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Aggregated Value"</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Shootings By 90 Day Exponential Weighted Mean"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"monthly_rolling_incidents"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/monthly_rolling_incidents.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
Using a ninety-day window gives a little better sense of the overall trend downwards until 2020 reversed it.
</p>
</div>
</div>

<div id="outline-container-orgb7f75f1" class="outline-3">
<h3 id="orgb7f75f1">By Year</h3>
<div class="outline-text-3" id="text-orgb7f75f1">
<div class="highlight"><pre><span></span><span class="n">yearly</span> <span class="o">=</span> <span class="n">indexed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">))</span>
<span class="n">yearly_counts</span> <span class="o">=</span> <span class="n">yearly</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">"INCIDENT_KEY"</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"INCIDENT_KEY"</span><span class="p">:</span> <span class="s2">"Shootings"</span><span class="p">}</span>
<span class="p">)</span>

<span class="n">yearly_counts</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">yearly_counts</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">expect</span><span class="p">(</span><span class="n">yearly_counts</span><span class="p">[</span><span class="s2">"Shootings"</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">yearly_counts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"ordinal"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Shootings By year"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"yearly_incidents"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/yearly_incidents.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
Although 2020 had that crazy summer, 2021 still exceeded it overall.
</p>
</div>
</div>

<div id="outline-container-org5b51f8f" class="outline-3">
<h3 id="org5b51f8f">Monthly By Year</h3>
<div class="outline-text-3" id="text-org5b51f8f">
<div class="highlight"><pre><span></span><span class="n">monthly_counts</span> <span class="o">=</span> <span class="n">monthly</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">"INCIDENT_KEY"</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"INCIDENT_KEY"</span><span class="p">:</span> <span class="s2">"Shootings"</span><span class="p">}</span>
<span class="p">)</span>
<span class="c1"># monthly_counts = monthly_counts.rename(columns={"Month": "date-time"})</span>

<span class="n">month_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="s2">"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec"</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"date_time"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"Month"</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"date_time"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">month</span><span class="p">:</span> <span class="n">month_map</span><span class="p">[</span><span class="n">month</span><span class="p">])</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">selection</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">],</span>
				   <span class="n">bind</span><span class="o">=</span><span class="s2">"legend"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">monthly_counts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span>
	       <span class="n">sort</span><span class="o">=</span><span class="n">monthly_counts</span><span class="p">[</span><span class="s2">"date_time"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"nominal"</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"date_time"</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Month"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">MONTH_YEAR</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">)],</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span>
			     <span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.8</span><span class="p">),</span>
			     <span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Monthly Shootings By year"</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"month_year_shootings"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/month_year_shootings.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
Click on a year in the legend to isolate it from the other lines in the plot and on a space somewhere on the legend to highlight all the years again.
</p>

<p>
It looks like there was an unusually large surge in the Summer of 2020 after years of declining shootings, but regardless of the year there's at least a slight increase in shootings during the Summer months.
</p>
</div>
</div>

<div id="outline-container-orgd4e184e" class="outline-3">
<h3 id="orgd4e184e">Medain By Month</h3>
<div class="outline-text-3" id="text-orgd4e184e">
<div class="highlight"><pre><span></span><span class="n">by_month_median</span> <span class="o">=</span> <span class="n">monthly_counts</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">by_month_median</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">month_map</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Shootings"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">),]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Median Shootings By Month (2006 through 2012)"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"monthly_shootings"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/monthly_shootings.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
It looks like there's a definite seasonal effect on shootings. Must be all those farmer's kids off from school to work the fields and shoot each other.
</p>
</div>
</div>
</div>

<div id="outline-container-orgec616b1" class="outline-2">
<h2 id="orgec616b1">Location</h2>
<div class="outline-text-2" id="text-orgec616b1">
</div>
<div id="outline-container-orge08e565" class="outline-3">
<h3 id="orge08e565">Descriptions</h3>
<div class="outline-text-3" id="text-orge08e565">
</div>
<div id="outline-container-orga4dc220" class="outline-4">
<h4 id="orga4dc220">BORO</h4>
<div class="outline-text-4" id="text-orga4dc220">
<p>
The <code>BORO</code> column identifies which of the <a href="https://en.wikipedia.org/wiki/Boroughs_of_New_York_City?useskin=vector">five boroughs of New York City</a> the victim was shot in.
</p>

<p>
<img src="https://upload.wikimedia.org/wikipedia/commons/3/34/5_Boroughs_Labels_New_York_City_Map.svg" alt="Five Boroughs"></p>


<ol class="org-ol">
<li>Manhattan</li>
<li>Brooklyn</li>
<li>Queens</li>
<li>Bronx</li>
<li>Staten Island</li>
</ol>
<div class="highlight"><pre><span></span><span class="n">boroughs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BORO</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">BORO</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="s2">"Shootings"</span><span class="p">))</span>


<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">boroughs</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Shootings"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Borough"</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">520</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Shootings by Borough"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"shootings-by-borough"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/shootings-by-borough.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<div class="highlight"><pre><span></span><span class="n">borough_monthly</span> <span class="o">=</span> <span class="n">monthly</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">"BORO"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
			       <span class="s2">"INCIDENT_KEY"</span><span class="p">:</span> <span class="s2">"count"</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
				   <span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">BORO</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span> <span class="n">INCIDENT_KEY</span><span class="o">=</span><span class="s2">"Shootings"</span><span class="p">,</span> <span class="n">date_time</span><span class="o">=</span><span class="s2">"Month"</span><span class="p">))</span>

<span class="n">selection</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">"Borough"</span><span class="p">],</span> <span class="n">bind</span><span class="o">=</span><span class="s2">"legend"</span><span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">borough_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	       <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">),</span>
	       <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">),</span>
	       <span class="n">color</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span>
	       <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
		   <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Borough"</span><span class="p">),</span>
		   <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">MONTH_YEAR</span><span class="p">),</span>
		   <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Shootings"</span><span class="p">)</span>
	       <span class="p">],</span>
	       <span class="n">opacity</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span>
					<span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.8</span><span class="p">),</span>
					<span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Monthly Borough Shootings"</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"borough-monthly-shootings"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/borough-monthly-shootings.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
The Bronx and Brooklyn look like they have the most shootings, although I didn't weight it by population so I don't know how they compare as a fraction of the population.
</p>

<div class="highlight"><pre><span></span><span class="n">borough_bar</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">"BORO"</span><span class="p">,</span> <span class="s2">"date_time"</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">BORO</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">))</span>
<span class="n">borough_bar</span><span class="p">[</span><span class="s2">"Month"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">({</span>
    <span class="s2">"year"</span><span class="p">:</span> <span class="n">borough_bar</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
    <span class="s2">"month"</span><span class="p">:</span> <span class="n">borough_bar</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
    <span class="s2">"day"</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">borough_bar</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Month"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	<span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
	<span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
	<span class="n">title</span><span class="o">=</span><span class="s2">"Monthly Shootings With Borough Breakdowns"</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"borough-monthly-bar-chart"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/borough-monthly-bar-chart.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
By clicking on the legend you can isolate plot-lines by borough and it makes it clearer that the surge in 2020 happened primarily in the Bronx and Manhattan, although the plot is a little deceptive since Manhattan had some months where there were no shootings, but I didn't infill them with zeros so it doesn't show those months dropping back down.
</p>
</div>
</div>


<div id="outline-container-orgf1a2579" class="outline-4">
<h4 id="orgf1a2579">PRECINCT &amp; JURISDICTION_CODE</h4>
<div class="outline-text-4" id="text-orgf1a2579">
<p>
There are seventy-seven police precincts in New York City, subdividing the boroughs. This might be useful for isolating where the shootings are occuring even further, but I'll skip it. Same with the JURISDICTION_CODE.
</p>
</div>
</div>
<div id="outline-container-org1ec5757" class="outline-4">
<h4 id="org1ec5757">LOCATION_DESC</h4>
<div class="outline-text-4" id="text-org1ec5757">
<div class="highlight"><pre><span></span><span class="n">missing_locations</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">LOCATION_DESC</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">LOCATION_DESC</span><span class="o">=</span><span class="s2">"Location Description"</span><span class="p">))</span>
<span class="n">missing_locations</span> <span class="o">=</span> <span class="n">missing_locations</span><span class="p">[[</span><span class="s2">"Location Description"</span><span class="p">,</span> <span class="s2">"date_time"</span><span class="p">,</span> <span class="s2">"BORO"</span><span class="p">]]</span>
<span class="n">missing_locations</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_locations</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">missing_locations</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"ordinal"</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"count()"</span><span class="p">),</span> <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"BORO"</span><span class="p">),</span> <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"BORO"</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Missing Location Descriptions by Year"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"missing-locations-descriptions"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/missing-locations-descriptions.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
I was hoping the missing locations might be because they only started recording it after some point, but it looks like it's an ongoing problem not local to any one borough, so the location descriptions are interesting, but the number of missing entries makes it hard to say that they're meaningful.
</p>

<div class="highlight"><pre><span></span><span class="n">locations</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">LOCATION_DESC</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span> <span class="n">LOCATION_DESC</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">))</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Location"</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">locations</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
	       <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labelAngle</span><span class="o">=</span><span class="mi">30</span><span class="p">)),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Count"</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Location"</span><span class="p">),</span> <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Count"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Shooting Location Counts"</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"shooting-locations-count"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/shooting-locations-count.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
It looks like most shootings happened at homes, and to avoid being shot you should move to a storage facility.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd7b6677" class="outline-3">
<h3 id="orgd7b6677">Coordinates</h3>
<div class="outline-text-3" id="text-orgd7b6677">
</div>
<div id="outline-container-org424e5d3" class="outline-4">
<h4 id="org424e5d3">X_COORD_CD &amp; Y_COORD_CD</h4>
<div class="outline-text-4" id="text-org424e5d3">
<p>
These coordinates use the State Plane Coordinate System (see <a href="https://www.usgs.gov/faqs/what-state-plane-coordinate-system-can-gps-provide-coordinates-these-values">What is the State Plane Coordinate System?</a>) Long Island Zone. The coordinates are mid-block locations with the units in feet.
</p>

<div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">data</span><span class="p">[[</span><span class="s2">"X_COORD_CD"</span><span class="p">,</span> <span class="s2">"Y_COORD_CD"</span><span class="p">,</span> <span class="s2">"BORO"</span><span class="p">]])</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	<span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"X_COORD_CD"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">X_COORD_CD</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">X_COORD_CD</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span>
	<span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Y_COORD_CD"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Y_COORD_CD</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">Y_COORD_CD</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span>
	<span class="n">color</span><span class="o">=</span><span class="s2">"BORO"</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Shootings By Coordinates"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"shootings-by-coordinates"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/shootings-by-coordinates.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">"X_COORD_CD"</span><span class="p">,</span> <span class="s2">"Y_COORD_CD"</span><span class="p">,</span>
		    <span class="s2">"BORO"</span><span class="p">,</span> <span class="s2">"date_time"</span><span class="p">,</span>
		    <span class="s2">"Longitude"</span><span class="p">,</span> <span class="s2">"Latitude"</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">BORO</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span>
    <span class="n">X_COORD_CD</span><span class="o">=</span><span class="s2">"X-Coordinate"</span><span class="p">,</span>
    <span class="n">Y_COORD_CD</span><span class="o">=</span><span class="s2">"Y-Coordinate"</span>
<span class="p">))</span>

<span class="n">coordinates</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

<span class="n">select_year</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">],</span>
    <span class="n">bind</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">2006</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">2021</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">),</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[{</span><span class="s2">"Year"</span><span class="p">:</span> <span class="mi">2006</span><span class="p">}],</span>
<span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"X-Coordinate"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span>
	<span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="s2">"X-Coordinate"</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
		<span class="n">coordinates</span><span class="p">[</span><span class="s2">"X-Coordinate"</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Y-Coordinate"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span>
	<span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="s2">"Y-Coordinate"</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
		<span class="n">coordinates</span><span class="p">[</span><span class="s2">"Y-Coordinate"</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Borough"</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"date_time"</span><span class="p">)],</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Shootings By Coordinates and Year"</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">select_year</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">select_year</span><span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"shootings-by-coordinates-and-year"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/shootings-by-coordinates-and-year.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>
</div>
</div>

<div id="outline-container-org98096f1" class="outline-4">
<h4 id="org98096f1">Latitude &amp; Longitude</h4>
</div>
</div>

<div id="outline-container-org0377c8b" class="outline-3">
<h3 id="org0377c8b">With GeoPandas</h3>
<div class="outline-text-3" id="text-org0377c8b">
<p>
It turns out than the boroughs of New York City are one of the three datasets that come with GeoPandas so we can bring it in to make a map.
</p>

<div class="highlight"><pre><span></span><span class="n">path_to_data</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s2">"nybb"</span><span class="p">)</span>
<span class="n">nyc_geopandas</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nyc_geopandas</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

<pre class="example">
   BoroCode       BoroName     Shape_Leng    Shape_Area   
0         5  Staten Island  330470.010332  1.623820e+09  \

                                            geometry  
0  MULTIPOLYGON (((970217.022 145643.332, 970227....  
</pre>


<p>
Let's look at a map colored with the 2021 shooting counts.
</p>

<div class="highlight"><pre><span></span><span class="n">BOROUGH_COLUMN</span> <span class="o">=</span> <span class="s2">"BoroName"</span>
<span class="n">SHOOTINGS_COLUMN</span> <span class="o">=</span> <span class="s2">"Shootings"</span>
<span class="n">latest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">==</span><span class="mi">2021</span><span class="p">]</span>
<span class="n">latest_count</span> <span class="o">=</span> <span class="n">latest</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"BORO"</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">expect</span><span class="p">(</span><span class="n">latest_count</span><span class="o">.</span><span class="n">INCIDENT_KEY</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">latest</span><span class="p">)))</span>
<span class="n">latest_count</span> <span class="o">=</span> <span class="n">latest_count</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">BORO</span><span class="o">=</span><span class="n">BOROUGH_COLUMN</span><span class="p">))</span>
<span class="n">latest_count</span><span class="p">[</span><span class="n">BOROUGH_COLUMN</span><span class="p">]</span> <span class="o">=</span> <span class="n">latest_count</span><span class="p">[</span><span class="n">BOROUGH_COLUMN</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
<span class="n">latest_count</span><span class="p">[</span><span class="n">SHOOTINGS_COLUMN</span><span class="p">]</span> <span class="o">=</span> <span class="n">latest_count</span><span class="p">[</span><span class="s2">"INCIDENT_KEY"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">latest_count</span> <span class="o">=</span> <span class="n">latest_count</span><span class="p">[[</span><span class="n">BOROUGH_COLUMN</span><span class="p">,</span> <span class="n">SHOOTINGS_COLUMN</span><span class="p">]]</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">nyc_geopandas</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">latest_count</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">BOROUGH_COLUMN</span><span class="p">)</span>

<span class="n">merged</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[[</span><span class="n">BOROUGH_COLUMN</span><span class="p">,</span> <span class="n">SHOOTINGS_COLUMN</span><span class="p">,</span> <span class="s2">"geometry"</span><span class="p">]]</span>
<span class="n">explorer</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">SHOOTINGS_COLUMN</span><span class="p">,</span>
			  <span class="n">tooltip</span><span class="o">=</span><span class="n">BOROUGH_COLUMN</span><span class="p">,</span>
			  <span class="n">popup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">explorer</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">OUTPUT_PATH</span><span class="si">}</span><span class="s2">/nyc-shootings-explore.html"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/nyc-shootings-explore.html" style="width:100%" height="800">
  <p>Figure Missing</p>
</object>

<p>
This is probably most interesting to someone like me who doesn't know much about New York City. I wonder why Queens has so much fewer shootings than Brooklyn or the Bronx when it sits between them? Demographics?
</p>
</div>
</div>
</div>

<div id="outline-container-org942e262" class="outline-2">
<h2 id="org942e262">Murder or Not</h2>
<div class="outline-text-2" id="text-org942e262">
</div>
<div id="outline-container-org62c52a3" class="outline-3">
<h3 id="org62c52a3">By Year</h3>
<div class="outline-text-3" id="text-org62c52a3">
<div class="highlight"><pre><span></span><span class="n">MURDER_FLAG</span> <span class="o">=</span> <span class="s2">"STATISTICAL_MURDER_FLAG"</span>
<span class="n">MURDERED</span> <span class="o">=</span> <span class="s2">"Murdered"</span>
<span class="n">BOROUGH</span> <span class="o">=</span> <span class="s2">"Borough"</span>
<span class="n">YEAR</span> <span class="o">=</span> <span class="s2">"Year"</span>
<span class="n">data</span><span class="p">[</span><span class="n">YEAR</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="n">yearly_murders</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">YEAR</span><span class="p">,</span> <span class="s2">"BORO"</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">MURDER_FLAG</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
	<span class="n">columns</span><span class="o">=</span><span class="p">{</span>
	    <span class="s2">"BORO"</span><span class="p">:</span> <span class="n">BOROUGH</span><span class="p">,</span>
	    <span class="n">MURDER_FLAG</span><span class="p">:</span> <span class="n">MURDERED</span><span class="p">})</span>
<span class="n">yearly_murders</span> <span class="o">=</span> <span class="n">yearly_murders</span><span class="p">[[</span><span class="n">YEAR</span><span class="p">,</span> <span class="n">BOROUGH</span><span class="p">,</span> <span class="n">MURDERED</span><span class="p">]]</span>

<span class="n">SELECTION</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">BOROUGH</span><span class="p">],</span> <span class="n">bind</span><span class="o">=</span><span class="s2">"legend"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">yearly_murders</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	       <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">YEAR</span><span class="p">),</span>
	       <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="n">MURDERED</span><span class="p">),</span>
	       <span class="n">color</span><span class="o">=</span><span class="n">BOROUGH</span><span class="p">,</span>
	       <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">YEAR</span><span class="p">),</span>
			<span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">MURDERED</span><span class="p">),</span>
			<span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">BOROUGH</span><span class="p">)],</span>
	       <span class="n">opacity</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">SELECTION</span><span class="p">,</span>
					<span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.8</span><span class="p">),</span>
					<span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
	   <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">SELECTION</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	       <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
	       <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
	       <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Murders By Year"</span>
	   <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"yearly_borough_murders"</span><span class="p">)</span>
<span class="c1">#+end_src</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/yearly_borough_murders.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>
</div>
</div>

<div id="outline-container-org9a5fbfc" class="outline-3">
<h3 id="org9a5fbfc">By Month</h3>
<div class="outline-text-3" id="text-org9a5fbfc">
<div class="highlight"><pre><span></span><span class="n">MONTH</span> <span class="o">=</span> <span class="s2">"Month"</span>
<span class="n">data</span><span class="p">[</span><span class="n">MONTH</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s2">"M"</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="n">murdered</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">MONTH</span><span class="p">,</span> <span class="s2">"BORO"</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">MURDER_FLAG</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">murdered</span> <span class="o">=</span> <span class="n">murdered</span><span class="p">[[</span><span class="n">MONTH</span><span class="p">,</span> <span class="s2">"BORO"</span><span class="p">,</span> <span class="n">MURDER_FLAG</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">"BORO"</span><span class="p">:</span> <span class="n">BOROUGH</span><span class="p">,</span>
    <span class="n">MURDER_FLAG</span><span class="p">:</span> <span class="n">MURDERED</span><span class="p">,</span>    
<span class="p">})</span>

<span class="n">SELECTION</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">BOROUGH</span><span class="p">],</span> <span class="n">bind</span><span class="o">=</span><span class="s2">"legend"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">murdered</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"filled"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
	   <span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	       <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">MONTH</span><span class="p">),</span>
	       <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="n">MURDERED</span><span class="p">),</span>
	       <span class="n">color</span><span class="o">=</span><span class="n">BOROUGH</span><span class="p">,</span>
	       <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">MONTH</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">MONTH_YEAR</span><span class="p">),</span>
			<span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">MURDERED</span><span class="p">),</span>
			<span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="n">BOROUGH</span><span class="p">)],</span>
	       <span class="n">opacity</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">SELECTION</span><span class="p">,</span>
					<span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.8</span><span class="p">),</span>
					<span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
	   <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">SELECTION</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	       <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
	       <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
	       <span class="n">title</span><span class="o">=</span><span class="s2">"NYC Murders By Month"</span>
	   <span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"monthly_borough_murders"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/monthly_borough_murders.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>

<p>
It looks like Brooklyn lead in murders in the Summer of 2020, 
</p>
</div>
</div>

<div id="outline-container-orgab955bf" class="outline-3">
<h3 id="orgab955bf">By Coordinate</h3>
<div class="outline-text-3" id="text-orgab955bf">
<div class="highlight"><pre><span></span><span class="n">murdered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">MURDER_FLAG</span><span class="p">]]</span>

<span class="n">murder_coordinates</span> <span class="o">=</span> <span class="n">murdered</span><span class="p">[[</span><span class="s2">"BORO"</span><span class="p">,</span> <span class="s2">"date_time"</span><span class="p">,</span>
			       <span class="s2">"Longitude"</span><span class="p">,</span> <span class="s2">"Latitude"</span>
			       <span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
				   <span class="n">BORO</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span>
			       <span class="p">))</span>
<span class="n">murder_coordinates</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">murder_coordinates</span><span class="o">.</span><span class="n">date_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span><span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">murder_coordinates</span><span class="p">)</span>
	 <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
	 <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	     <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Longitude"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span>
		 <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">murder_coordinates</span><span class="p">[</span><span class="s2">"Longitude"</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
			 <span class="n">murder_coordinates</span><span class="p">[</span><span class="s2">"Longitude"</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span>
	     <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Latitude"</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span>
		 <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">murder_coordinates</span><span class="p">[</span><span class="s2">"Latitude"</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
			 <span class="n">murder_coordinates</span><span class="p">[</span><span class="s2">"Latitude"</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span>
	     <span class="n">color</span><span class="o">=</span><span class="s2">"Borough"</span><span class="p">,</span>
	     <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Borough"</span><span class="p">),</span>
		      <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"date_time"</span><span class="p">)],</span>
	 <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
	     <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
	     <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
	     <span class="n">title</span><span class="o">=</span><span class="s2">"Murders By Longitude, Latitude and Year"</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">select_year</span><span class="p">)</span>
	 <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">select_year</span><span class="p">))</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"murders-by-coordinates-and-year"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/nyc-shootings-python-version/murders-by-coordinates-and-year.html" style="width:100%" height="650">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>

<div id="outline-container-orgdcaac13" class="outline-2">
<h2 id="orgdcaac13">Victims and Perpetrators</h2>
<div class="outline-text-2" id="text-orgdcaac13">
</div>
<div id="outline-container-orgf0dd83c" class="outline-3">
<h3 id="orgf0dd83c">Perpetrators</h3>
<div class="outline-text-3" id="text-orgf0dd83c">
</div>
<div id="outline-container-org3335cad" class="outline-4">
<h4 id="org3335cad">PERP_AGE_GROUP</h4>
<div class="outline-text-4" id="text-org3335cad">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_AGE_GROUP</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">PERP_AGE_GROUP</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">nan</td>
<td class="org-right">9344</td>
</tr>
<tr>
<td class="org-right">18-24</td>
<td class="org-right">5844</td>
</tr>
<tr>
<td class="org-right">25-44</td>
<td class="org-right">5202</td>
</tr>
<tr>
<td class="org-right">UNKNOWN</td>
<td class="org-right">3148</td>
</tr>
<tr>
<td class="org-right">&lt;18</td>
<td class="org-right">1463</td>
</tr>
<tr>
<td class="org-right">45-64</td>
<td class="org-right">535</td>
</tr>
<tr>
<td class="org-right">65+</td>
<td class="org-right">57</td>
</tr>
<tr>
<td class="org-right">1020</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">940</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">224</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgaa382e6" class="outline-4">
<h4 id="orgaa382e6">PEPR_SEX</h4>
<div class="outline-text-4" id="text-orgaa382e6">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_SEX</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">PERP_SEX</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">M</td>
<td class="org-right">14416</td>
</tr>
<tr>
<td class="org-left">nan</td>
<td class="org-right">9310</td>
</tr>
<tr>
<td class="org-left">U</td>
<td class="org-right">1499</td>
</tr>
<tr>
<td class="org-left">F</td>
<td class="org-right">371</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org489fecc" class="outline-4">
<h4 id="org489fecc">PERP_RACE</h4>
<div class="outline-text-4" id="text-org489fecc">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_RACE</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">PERP_RACE</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">BLACK</td>
<td class="org-right">10668</td>
</tr>
<tr>
<td class="org-left">nan</td>
<td class="org-right">9310</td>
</tr>
<tr>
<td class="org-left">WHITE HISPANIC</td>
<td class="org-right">2164</td>
</tr>
<tr>
<td class="org-left">UNKNOWN</td>
<td class="org-right">1836</td>
</tr>
<tr>
<td class="org-left">BLACK HISPANIC</td>
<td class="org-right">1203</td>
</tr>
<tr>
<td class="org-left">WHITE</td>
<td class="org-right">272</td>
</tr>
<tr>
<td class="org-left">ASIAN / PACIFIC ISLANDER</td>
<td class="org-right">141</td>
</tr>
<tr>
<td class="org-left">AMERICAN INDIAN/ALASKAN NATIVE</td>
<td class="org-right">2</td>
</tr>
</tbody>
</table>
<p>
It looks like besides the <code>NaN</code> values, missing data is also classified as <code>U</code> or <code>UNKNOWN</code>. 
</p>
</div>
</div>
<div id="outline-container-org9c9c574" class="outline-4">
<h4 id="org9c9c574">Handling the Unknowns</h4>
<div class="outline-text-4" id="text-org9c9c574">
<p>
Let's try and unify the missing values.
</p>

<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_AGE_GROUP</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span> <span class="o">=</span> <span class="s2">"UNKNOWN"</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_AGE_GROUP</span> <span class="o">==</span> <span class="s2">"U"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"UNKNOWN"</span>

<span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_AGE_GROUP</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">PERP_AGE_GROUP</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">UNKNOWN</td>
<td class="org-right">12492</td>
</tr>
<tr>
<td class="org-right">18-24</td>
<td class="org-right">5844</td>
</tr>
<tr>
<td class="org-right">25-44</td>
<td class="org-right">5202</td>
</tr>
<tr>
<td class="org-right">&lt;18</td>
<td class="org-right">1463</td>
</tr>
<tr>
<td class="org-right">45-64</td>
<td class="org-right">535</td>
</tr>
<tr>
<td class="org-right">65+</td>
<td class="org-right">57</td>
</tr>
<tr>
<td class="org-right">1020</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">940</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">224</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_SEX</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span> <span class="o">=</span> <span class="s2">"UNKNOWN"</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_SEX</span> <span class="o">==</span> <span class="s2">"U"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"UNKNOWN"</span>

<span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_SEX</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">PERP_SEX</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">M</td>
<td class="org-right">14416</td>
</tr>
<tr>
<td class="org-left">UNKNOWN</td>
<td class="org-right">10809</td>
</tr>
<tr>
<td class="org-left">F</td>
<td class="org-right">371</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_RACE</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span> <span class="o">=</span> <span class="s2">"UNKNOWN"</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_RACE</span> <span class="o">==</span> <span class="s2">"U"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"UNKNOWN"</span>

<span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">PERP_RACE</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">PERP_RACE</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">UNKNOWN</td>
<td class="org-right">11166</td>
</tr>
<tr>
<td class="org-left">BLACK</td>
<td class="org-right">10650</td>
</tr>
<tr>
<td class="org-left">WHITE HISPANIC</td>
<td class="org-right">2164</td>
</tr>
<tr>
<td class="org-left">BLACK HISPANIC</td>
<td class="org-right">1201</td>
</tr>
<tr>
<td class="org-left">WHITE</td>
<td class="org-right">272</td>
</tr>
<tr>
<td class="org-left">ASIAN / PACIFIC ISLANDER</td>
<td class="org-right">141</td>
</tr>
<tr>
<td class="org-left">AMERICAN INDIAN/ALASKAN NATIVE</td>
<td class="org-right">2</td>
</tr>
</tbody>
</table>
<p>
So, the first thing we can notice is that the <code>UNKNOWN</code> counts don't match so sometims some attributes were known but not others, so they don't just represent cases where the perpetrator wasn't caught like I thought it might be. The second thing is that for age and race the unknowns have the highest counts. For all three categories the numbers of unknowns are so high that it's hard to say how they might affect the cases where the values are known.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd13c407" class="outline-3">
<h3 id="orgd13c407">Victims</h3>
<div class="outline-text-3" id="text-orgd13c407">
</div>
<div id="outline-container-org5387ebd" class="outline-4">
<h4 id="org5387ebd">VIC_AGE_GROUP</h4>
<div class="outline-text-4" id="text-org5387ebd">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">VIC_AGE_GROUP</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">VIC_AGE_GROUP</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">UNKNOWN</td>
<td class="org-right">10863</td>
</tr>
<tr>
<td class="org-right">25-44</td>
<td class="org-right">6500</td>
</tr>
<tr>
<td class="org-right">18-24</td>
<td class="org-right">5389</td>
</tr>
<tr>
<td class="org-right">&lt;18</td>
<td class="org-right">1657</td>
</tr>
<tr>
<td class="org-right">45-64</td>
<td class="org-right">1070</td>
</tr>
<tr>
<td class="org-right">65+</td>
<td class="org-right">117</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orge9d1cfb" class="outline-4">
<h4 id="orge9d1cfb">VIC_SEX</h4>
<div class="outline-text-4" id="text-orge9d1cfb">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">VIC_SEX</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">VIC_SEX</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">M</td>
<td class="org-right">13182</td>
</tr>
<tr>
<td class="org-left">UNKNOWN</td>
<td class="org-right">10809</td>
</tr>
<tr>
<td class="org-left">F</td>
<td class="org-right">1598</td>
</tr>
<tr>
<td class="org-left">U</td>
<td class="org-right">7</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org1f69448" class="outline-4">
<h4 id="org1f69448">VIC_RACE</h4>
<div class="outline-text-4" id="text-org1f69448">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">VIC_RACE</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">VIC_RACE</th>
<th scope="col" class="org-right">count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">UNKNOWN</td>
<td class="org-right">10851</td>
</tr>
<tr>
<td class="org-left">BLACK</td>
<td class="org-right">9962</td>
</tr>
<tr>
<td class="org-left">WHITE HISPANIC</td>
<td class="org-right">2515</td>
</tr>
<tr>
<td class="org-left">BLACK HISPANIC</td>
<td class="org-right">1528</td>
</tr>
<tr>
<td class="org-left">WHITE</td>
<td class="org-right">485</td>
</tr>
<tr>
<td class="org-left">ASIAN / PACIFIC ISLANDER</td>
<td class="org-right">249</td>
</tr>
<tr>
<td class="org-left">AMERICAN INDIAN/ALASKAN NATIVE</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>
<p>
Somewhat unexpectedly, the unknowns are also alarmingly high for the victims, suggesting that they represent poor case records and perhaps the demographic information isn't reliable enough to be useful.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfc57088" class="outline-2">
<h2 id="orgfc57088">Sources</h2>
<div class="outline-text-2" id="text-orgfc57088">
<ul class="org-ul">
<li>
<a href="https://commons.wikimedia.org/wiki/File:5_Boroughs_Labels_New_York_City_Map.svg">New York City Map</a> via WikiMedia Commons</li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/bubba-sort-page-1/index.html" class="u-url">I, Bubba</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/bubba-sort-page-1/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-16T19:54:06-07:00" itemprop="datePublished" title="2023-03-16 19:54">2023-03-16 19:54</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
<img src="posts/bubba-sort-page-1/bubba_001_small.webp" alt="Bubba Panel One"></p>

<p>
<img src="posts/bubba-sort-page-1/bubba_002_1.webp" alt="Bubba Panel Two"></p>

<p>
<img src="posts/bubba-sort-page-1/bubba_003.webp" alt="Panel Three"></p>

<p>
<a href="posts/bubba-sort-page-2/">Next Bubba</a>
</p>

<p>
<a href="pages/bubba-sort/bubba-sort-pages/">Table of Contents</a>
</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/activity-selector-implementation/index.html" class="u-url">Activity Selector Implementations</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/activity-selector-implementation/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-09-12T16:11:44-07:00" itemprop="datePublished" title="2022-09-12 16:11">2022-09-12 16:11</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/activity-selector-implementation/index.html#org58a56f3">Example Data</a></li>
<li><a href="posts/activity-selector-implementation/index.html#org1622e06">A Recursive Selector</a></li>
<li><a href="posts/activity-selector-implementation/index.html#org1078381">An Iterative Selector</a></li>
</ul>
</div>
</div>
<div class="highlight"><pre><span></span><span class="c1"># from pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">contain_exactly</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>

<div id="outline-container-org58a56f3" class="outline-2">
<h2 id="org58a56f3">Example Data</h2>
<div class="outline-text-2" id="text-org58a56f3">
<div class="highlight"><pre><span></span><span class="n">PADDING</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="n">PADDING</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">finish</span> <span class="o">=</span> <span class="p">[</span><span class="n">PADDING</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">expected_activities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">finish</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org1622e06" class="outline-2">
<h2 id="org1622e06">A Recursive Selector</h2>
<div class="outline-text-2" id="text-org1622e06">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">recursive_activity_selector</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Selects the optimal activities</span>

<span class="sd">    Note:</span>
<span class="sd">     This assumes that the start and finish lists are pre-padded with </span>
<span class="sd">    zeros (1 each).</span>


<span class="sd">    Args:</span>
<span class="sd">     start: list of start times for each activity</span>
<span class="sd">     finish: list of end times for each activity</span>
<span class="sd">     k: the current activity (index)</span>

<span class="sd">    Returns:</span>
<span class="sd">     optimal list of activities</span>
<span class="sd">    """</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">start</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">finish</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
	<span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
	<span class="k">return</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">+</span> <span class="n">recursive_activity_selector</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">activities</span> <span class="o">=</span> <span class="n">recursive_activity_selector</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected_activities</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span>
</pre></div>

<pre class="example">
[1, 4, 8, 11]
</pre>
</div>
</div>

<div id="outline-container-org1078381" class="outline-2">
<h2 id="org1078381">An Iterative Selector</h2>
<div class="outline-text-2" id="text-org1078381">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">iterative_activity_selector</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">finish</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""An iterative activity selector</span>

<span class="sd">    Note:</span>
<span class="sd">     This assumes that the start and finish lists are pre-padded with </span>
<span class="sd">    dummy values.</span>

<span class="sd">    Args:</span>
<span class="sd">     start: list of starting times</span>
<span class="sd">     finish: list of end times</span>
<span class="sd">    """</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="n">activities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">start</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">finish</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
	    <span class="n">activities</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span>
	    <span class="n">k</span> <span class="o">=</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">activities</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">activities</span> <span class="o">=</span> <span class="n">iterative_activity_selector</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected_activities</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span>
</pre></div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-activity-selection-problem/index.html" class="u-url">The Activity Selection Problem</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-activity-selection-problem/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-08-04T17:25:35-07:00" itemprop="datePublished" title="2022-08-04 17:25">2022-08-04 17:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/the-activity-selection-problem/index.html#org00f0a88">What is the Activity Selection Problem?</a></li>
<li><a href="posts/the-activity-selection-problem/index.html#org08fc928">The Greedy Choice</a></li>
<li>
<a href="posts/the-activity-selection-problem/index.html#orgdb6b3e9">The Recursive Activity Selector</a>
<ul>
<li><a href="posts/the-activity-selection-problem/index.html#orgb92d888">Padding The Start</a></li>
</ul>
</li>
<li><a href="posts/the-activity-selection-problem/index.html#org215fa34">The Iterative Activity Selector</a></li>
<li><a href="posts/the-activity-selection-problem/index.html#org282bc5a">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-org00f0a88" class="outline-2">
<h2 id="org00f0a88">What is the Activity Selection Problem?</h2>
<div class="outline-text-2" id="text-org00f0a88">
<ul class="org-ul">
<li>In this problem we have a set of <i>n</i> activities \(S = \{a_1, a_2, \ldots, a_n\}\).</li>
<li>Assume the activities are sorted by increasing finish time</li>
<li>Each activity has a start time \(s_i\) and a finish time \(f_i\)</li>
<li>Only one activity can happen at a time.</li>
<li>Two activities are <i>compatible</i> if the earlier event finishes before the start time of the other event.</li>
</ul>
<p>
The problem we want to solve is finding the most compatible activities we can from our set of activities. This differs from a more common scheduling problem in that the times are fixed - we can't re-arrange activities to make them fit so they either can happen or they can't.
</p>
</div>
</div>

<div id="outline-container-org08fc928" class="outline-2">
<h2 id="org08fc928">The Greedy Choice</h2>
<div class="outline-text-2" id="text-org08fc928">
<p>
<a href="posts/clrs/">CLRS</a> goes into the more formal aspects of finding the optimal substructure and proving that a greedy strategy works, but in this case the reasoning is fairly intuitive (and I didn't find the proof so easy to follow) so I'll skip the formal stuff. The thing to recognize is just that the sooner the first activity you schedule finishes the more time there is for other activities. So if after each activity you pick you the next pick you make is the remaining  activity that doesn't collide with the current pick and finishes first you will be maximizing the number of activities that you can schedule.
</p>
</div>
</div>

<div id="outline-container-orgdb6b3e9" class="outline-2">
<h2 id="orgdb6b3e9">The Recursive Activity Selector</h2>
<div class="outline-text-2" id="text-orgdb6b3e9">
<pre id="recursive-activity-selector" style="display:hidden;">
\begin{algorithm}
\caption{Recursive Activity Selector}
\begin{algorithmic}
\REQUIRE The activities are sorted in non-decreasing order of finish time
\INPUT $s$: The array of start times for the activities.
\INPUT $f$: The array of finish times for the activities.
\INPUT $k$: The last activity selected so far.
\INPUT $n$: The number of activities.
\OUTPUT The activities that maximize the number of compatible activities.
\PROCEDURE{RecursiveActivitySelector}{$s, f, k, n$}

\STATE \(m \gets k + 1\)

\WHILE {\(m \le n\) and \(s[m] &lt; f[k]\)}
  \STATE \(m \gets m + 1\)
\ENDWHILE

\IF {\(m \le n\)}
  \RETURN \(\{a_m\} \cup \) \textsc{RecursiveActivitySelector}(\(s, f, m, n\))
\ELSE
  \RETURN \{\}
\ENDIF

\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
<b><b>Note:</b></b> The activity set (\(\{a_1, a_2, \ldots, a_n\}\)) is treated as a global collection so it is used in the function but not passed in as an argument.
</p>
</div>

<div id="outline-container-orgb92d888" class="outline-3">
<h3 id="orgb92d888">Padding The Start</h3>
<div class="outline-text-3" id="text-orgb92d888">
<p>
Because the recursive algorithm is looking for the next earliest finish time after the first event we need to pad the activities with a dummy activity that has a finish time of 0 (\(f_0 = 0\)) and then when the function is first called the <i>k</i> value is set to 0:
</p>

<p>
\[
RecursiveActivitySelector(s, f, 0, n)
\]
</p>
</div>
</div>
</div>

<div id="outline-container-org215fa34" class="outline-2">
<h2 id="org215fa34">The Iterative Activity Selector</h2>
<div class="outline-text-2" id="text-org215fa34">
<pre id="greedy-activity-selector" style="display:hidden;">
\begin{algorithm}
\caption{Greedy Activity Selector}
\begin{algorithmic}
\REQUIRE The activities are sorted in non-decreasing order of finish time
\INPUT $s$: The array of start times for the activities.
\INPUT $f$: The array of finish times for the activities.
\OUTPUT The activities that maximize the number of compatible activities.
\PROCEDURE{GreedyActivitySelector}{\(s, f\)}

\STATE \(n \gets s.length \)
\STATE \(A \gets \{a_1\} \)
\STATE \(k \gets 1 \)

\FOR {\(m  \in \{2, \ldots, n \}\)}
  \IF {\( s[m] \ge f[k] \)}
    \STATE \(A \gets A \cup \{a_m\}\)
    \STATE \(k \gets m \)
  \ENDIF
\ENDFOR

\RETURN \(A\)
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org282bc5a" class="outline-2">
<h2 id="org282bc5a">Sources</h2>
<div class="outline-text-2" id="text-org282bc5a">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("recursive-activity-selector"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("greedy-activity-selector"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/weighted-completion-times/index.html" class="u-url">Weighted Completion Times</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/weighted-completion-times/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-07-20T16:33:47-07:00" itemprop="datePublished" title="2022-07-20 16:33">2022-07-20 16:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li>
<a href="posts/weighted-completion-times/index.html#org58a8ea8">The Weighted Scheduling Problem</a>
<ul>
<li><a href="posts/weighted-completion-times/index.html#org3c864b4">Completion Time</a></li>
</ul>
</li>
<li><a href="posts/weighted-completion-times/index.html#org6f45b85">Greedy Metrics</a></li>
<li><a href="posts/weighted-completion-times/index.html#orgba58152">Source</a></li>
</ul>
</div>
</div>
<div id="outline-container-org58a8ea8" class="outline-2">
<h2 id="org58a8ea8">The Weighted Scheduling Problem</h2>
<div class="outline-text-2" id="text-org58a8ea8">
<p>
This is a look at the problem of arranging a schedule of jobs so that their completion times are lowest, while accounting for different priorities for each job.
</p>

<p>
<b><b>Input:</b></b> \(n\) jobs with positive lengths \(l_1, l_2, \ldots, l_n\) and positive weights \(w_1, w_2,\ldots,w_n\). The larger the weight, the higher the priority.
</p>

<p>
<b><b>Output:</b></b> A job sequence (the schedule) that minimizes the sum of the weight completion times \(w_1l_1 + w_2 l_2 + \cdots + w_n l_n\).
</p>
</div>

<div id="outline-container-org3c864b4" class="outline-3">
<h3 id="org3c864b4">Completion Time</h3>
<div class="outline-text-3" id="text-org3c864b4">
<p>
The output above is a little confusing (I'll have to re-write that later). What we're minimizing is the sum of <i>completion times</i>. A job's completion time is the total of all the times for the jobs that precede it as well as the time to finish the job. This means the completion time for the first job is the time to run that job, the completion time for the second job is the time for the first job plus the time for the second job, and so on.
</p>
</div>
</div>
</div>
<div id="outline-container-org6f45b85" class="outline-2">
<h2 id="org6f45b85">Greedy Metrics</h2>
<div class="outline-text-2" id="text-org6f45b85">
<p>
The greedy method for this problem involves finding a metric such that when the jobs are sorted by the metric they form the optimal schedule. One possible metric is the <i>Greedy Difference</i> which is the weight for a job minus the time the job takes (\(w_i - l_i\)).
</p>

<p>
Another possible metric is the <i>Greedy Ratio</i> which is the ratio of job-weight to job-length (\(\frac{w_i}{l_i}\)).
</p>
</div>
</div>
<div id="outline-container-orgba58152" class="outline-2">
<h2 id="orgba58152">Source</h2>
<div class="outline-text-2" id="text-orgba58152">
<ul class="org-ul">
<li><a href="posts/algorithms-illuminated-part-3/">Algorithms Illuminated - Part III: Greedy Algorithms and Dynamic Programming</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/longest-common-subsequence/index.html" class="u-url">Longest Common Subsequence</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/longest-common-subsequence/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-07-13T17:02:30-07:00" itemprop="datePublished" title="2022-07-13 17:02">2022-07-13 17:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/longest-common-subsequence/index.html#org3c41224">The Longest Common Subsequence Problem</a></li>
<li>
<a href="posts/longest-common-subsequence/index.html#org169246c">Finding The LCS</a>
<ul>
<li><a href="posts/longest-common-subsequence/index.html#org6526da1">The Length-Finder</a></li>
<li><a href="posts/longest-common-subsequence/index.html#org08da7a1">Implementation</a></li>
</ul>
</li>
<li><a href="posts/longest-common-subsequence/index.html#org278c44e">Printing The Sequence</a></li>
<li><a href="posts/longest-common-subsequence/index.html#org78e1221">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-org3c41224" class="outline-2">
<h2 id="org3c41224">The Longest Common Subsequence Problem</h2>
<div class="outline-text-2" id="text-org3c41224">
<p>
A <i>subsequence</i> of a sequence is the original sequence with zero or more elements removed from it. A <i>common subsequence</i> of two sequences is a subsequence that belongs to both sequences. With the <i>Longest Common Subsequence (LCS)</i> problem you are given two sequences - \(X = \langle x_1, x_2,\ldots,x_m\rangle\) and \(Y = \langle y_1, y_2,\ldots,y_n\rangle\) and you want to find a common subsequence of \(X\) and \(Y\) that has the maximum length (there might be more than one common subsequence that have the maximum length).
</p>

<p>
<b><b>Note:</b></b> The elements of the subsequence have to be in both sequences in the same relative order, but don't need to be consecutive. "AK" is a common subsequence of "ARK" and "BACK" because "A" and "K" appears in both sequences and the "A" comes before the "K," even though there are letters between them in both of the original sequences.
</p>
</div>
</div>

<div id="outline-container-org169246c" class="outline-2">
<h2 id="org169246c">Finding The LCS</h2>
<div class="outline-text-2" id="text-org169246c">
<p>
We basically have to look at three cases.
</p>

<p>
\[
c[i,j] = \begin{cases}
  0 &amp; \text{if } i = 0 \text{ or } j = 0\\
  c[i - 1, j - 1] + 1 &amp; \text{if } i,j &gt; 0 \text{ and } x_i = y_j\\
  \text{Max}(c[i, j-1], c[i - 1, j) &amp; \text{if } i, j &gt; 0 \text{ and } x_i \neq y_j
\end{cases}
\]
</p>

<ul class="org-ul">
<li>\(c\) is the lookup table that we will build</li>
<li>\(i\) is the index of an element in \(X\) and a row in \(c\)</li>
<li>\(j\) is the index of an element in \(Y\) and a column in \(c\)</li>
<li>\(X\) and \(Y\) use 1-based indices, not 0-based</li>
</ul>
</div>

<div id="outline-container-org6526da1" class="outline-3">
<h3 id="org6526da1">The Length-Finder</h3>
<div class="outline-text-3" id="text-org6526da1">
<p>
As with the other Dynamic Programming algorithms, our function is going to find the length of the longest sequence, not the actual sequence (this is left to another function).
</p>

<pre id="longest-common-subsequence-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Longest Common Subsequence Length Finder}
\begin{algorithmic}
\INPUT $X$: Sequence of elements
\INPUT $Y$: Sequence of elements
\OUTPUT Table of common subsequence lengths, table to reconstruct the best subsequence.
\PROCEDURE{LCS-Length}{$X, Y$}
\STATE \(m \gets X.length\)
\STATE \(n \gets Y.length\)
\STATE \(b[1\ldots m, 1 \ldots n]\) and \(c[0 \ldots m, 0 \ldots n]\) are new tables.
\FOR {\(i \in \{1 \ldots m\}\)}
    \STATE \(c[i, 0] \gets 0\)
\ENDFOR

\FOR {\(j \in \{0 \ldots n\}\)}
    \STATE \(c[0, j] \gets 0\)
\ENDFOR

\FOR {\(i \in \{1 \ldots m\}\)}
  \FOR {\(j \in \{1 \ldots n\}\)}
      \IF {\(X_i = Y_j\)}
          \STATE \(c[i, j] \gets c[i - 1, j - 1] + 1\)
          \STATE \(b[i, j] \gets "\nwarrow"\)
      \ELSEIF {\(c[i - 1, j] \geq c[i, j-1]\)}
          \STATE \(c[i, j] \gets c[i - 1, j]\)
          \STATE \(b[i, j] \gets "\uparrow" \)
      \ELSE
          \STATE \(c[i, j] \gets c[i, j - 1]\)
          \STATE \(b[i,j] \gets "\leftarrow"\)
      \ENDIF
  \ENDFOR
\ENDFOR
\RETURN $c, b$
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org08da7a1" class="outline-3">
<h3 id="org08da7a1">Implementation</h3>
<div class="outline-text-3" id="text-org08da7a1">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">attrs</span> <span class="kn">import</span> <span class="n">define</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">contain_only</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">Direction</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"Direction"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"up_left"</span><span class="p">,</span> <span class="s2">"up"</span><span class="p">,</span> <span class="s2">"left"</span><span class="p">],</span>
		       <span class="n">defaults</span><span class="o">=</span><span class="p">[</span><span class="s2">"</span><span class="se">\\</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"|"</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">])()</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="nd">@define</span>
<span class="k">class</span> <span class="nc">LongestCommonSubsequence</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Finds the longest common subsequence of two sequences</span>

<span class="sd">    Args:</span>
<span class="sd">     x: first sequence</span>
<span class="sd">     y: second sequence</span>
<span class="sd">    """</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">_table</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_trace_table</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_length</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""The memoization table"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
			   <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
	    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">trace_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""Table to reconstruct longest common subsequence"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_trace_table</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
				 <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))]</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_table</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""Number of characters in longest common subsequence"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
		    <span class="n">previous_row</span><span class="p">,</span> <span class="n">previous_column</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span>
		    <span class="n">unpadded_row</span><span class="p">,</span> <span class="n">unpadded_column</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span>
		    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">previous_row</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">previous_column</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_row</span><span class="p">][</span><span class="n">previous_column</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">unpadded_row</span><span class="p">][</span><span class="n">unpadded_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up_left</span>
		    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">previous_column</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">previous_row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">unpadded_row</span><span class="p">][</span><span class="n">unpadded_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up</span>
		    <span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">previous_column</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">unpadded_row</span><span class="p">][</span><span class="n">unpadded_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">left</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span>

    <span class="k">def</span> <span class="nf">print_lcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">"""Prints the elements of the longest common subsequence</span>

<span class="sd">	Note:</span>
<span class="sd">	 to start row and column should match the last cell in the trace table.</span>

<span class="sd">	Args:</span>
<span class="sd">	 row: row in the trace_table to start with</span>
<span class="sd">	 column: column in the trace_table to start with</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">column</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
	    <span class="k">return</span>

	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up_left</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
	    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
	<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">up</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
	<span class="k">return</span>

    <span class="k">def</span> <span class="nf">print_longest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">print_lcs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
	<span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s2">"A B C B D A B"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="s2">"B D C A B A"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">lcs</span> <span class="o">=</span> <span class="n">LongestCommonSubsequence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_only</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))))</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">trace_table</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">trace_table</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">lcs</span><span class="o">.</span><span class="n">length</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org278c44e" class="outline-2">
<h2 id="org278c44e">Printing The Sequence</h2>
<div class="outline-text-2" id="text-org278c44e">
<pre id="print-lcs-algorithm" style="display:hidden;">
\begin{algorithm}
\caption{Longest Common Subsequence Printer}
\begin{algorithmic}
\INPUT $b$: Table of directions from \textsc{LCS-Length}
\INPUT $X$: Sequence of elements
\INPUT $Y$: Sequence of elements
\INPUT $i$: Row number in $b$
\INPUT $j$: Column number in $b$
\PROCEDURE{Print-LCS}{$b, X, i, j$}
\IF {\(i = 0 \text{ or } j = 0\)}
    \RETURN
\ENDIF
\IF {\(b[i, j] = "\nwarrow" \)}
    \STATE \textsc{PrintLCS}(\(b, X, i - 1, j - 1\))
    \STATE \textsc{Print}(\(X_i\))
\ELSEIF {\(b[i, j] = "\uparrow" \)}
    \STATE \textsc{PrintLCS}(\(b, X, i- 1, j \))
\ELSE
    \STATE \textsc{PrintLCS}(\(b, X, i, j - 1\))
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="n">lcs</span><span class="o">.</span><span class="n">print_longest</span><span class="p">()</span>
</pre></div>

<pre class="example">
B
C
B
A
</pre>
</div>
</div>

<div id="outline-container-org78e1221" class="outline-2">
<h2 id="org78e1221">Sources</h2>
<div class="outline-text-2" id="text-org78e1221">
<ul class="org-ul"><li>
</li></ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("longest-common-subsequence-algorithm"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("print-lcs-algorithm"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/comparing-energy-prices/index.html" class="u-url">Comparing Energy Prices</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/comparing-energy-prices/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-07-12T13:13:00-07:00" itemprop="datePublished" title="2022-07-12 13:13">2022-07-12 13:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li>
<a href="posts/comparing-energy-prices/index.html#org64d75c4">How Many Megajoules For a Dollar of Gas?</a>
<ul>
<li><a href="posts/comparing-energy-prices/index.html#orgcb800fc">Chain-Link Conversion</a></li>
<li><a href="posts/comparing-energy-prices/index.html#orgf2d3def">In Python</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/index.html#orgcc24775">How Many MegaJoules For a Dollar of Electricity?</a>
<ul>
<li><a href="posts/comparing-energy-prices/index.html#org42729eb">Kilowatt-Hour To Joules</a></li>
<li><a href="posts/comparing-energy-prices/index.html#org1444a80">A Dollar's Worth Of Megajoules</a></li>
<li><a href="posts/comparing-energy-prices/index.html#org8815b2c">Check The Math</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/index.html#org97943a3">How Many Megajoules For a Dollar Of Natural Gas?</a>
<ul>
<li><a href="posts/comparing-energy-prices/index.html#orgb5b6897">Check The Math</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/index.html#orgc3c008a">How Many Megajoules For a Dollar of Coal?</a>
<ul>
<li><a href="posts/comparing-energy-prices/index.html#orgfe5e6b2">Checking the Math</a></li>
</ul>
</li>
<li>
<a href="posts/comparing-energy-prices/index.html#orgbeb7510">How Many Megajoules Per Dollar In Corn (Biodiesel)?</a>
<ul>
<li><a href="posts/comparing-energy-prices/index.html#org7064d50">Checking the Math</a></li>
</ul>
</li>
<li><a href="posts/comparing-energy-prices/index.html#org8f186f5">What Is the Ratio of the Cost of the Most Expensive to the Cheapest?</a></li>
<li><a href="posts/comparing-energy-prices/index.html#org3e95e01">Source</a></li>
</ul>
</div>
</div>
<div class="highlight"><pre><span></span><span class="c1"># from python</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>

<span class="k">def</span> <span class="nf">print_energy</span><span class="p">(</span><span class="n">megajoules_per_dollar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Print the energy provided by the source.</span>

<span class="sd">    Args:</span>
<span class="sd">     megajoules_per_dollar: how many megajoules provided by the source for each dollar</span>
<span class="sd">     source: where the energy is coming from</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> provides </span><span class="si">{</span><span class="n">megajoules_per_dollar</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> megajoules per dollar."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> costs $</span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">megajoules_per_dollar</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> per megajoule."</span><span class="p">)</span>
    <span class="k">return</span>

<span class="n">COSTS</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

<div id="outline-container-org64d75c4" class="outline-2">
<h2 id="org64d75c4">How Many Megajoules For a Dollar of Gas?</h2>
<div class="outline-text-2" id="text-org64d75c4">
<ul class="org-ul">
<li>A gallon of gasoline carries with it \(\approx 1.3E8\) joules of energy.</li>
<li>You pay \(5 \frac{\text{dollars}}{\text{gallon}}\).</li>
<li>How many megajoules (\(10^6\) joules) can you get for a dollar?</li>
</ul>
</div>

<div id="outline-container-orgcb800fc" class="outline-3">
<h3 id="orgcb800fc">Chain-Link Conversion</h3>
<div class="outline-text-3" id="text-orgcb800fc">
\begin{align}
\require{cancel}
\left(\frac{1 \cancel{gallon}}{5\textit{ dollars}}\right)\left(\frac{1.3 \times 10^8\textit{ joules}}{1 \cancel{gallon}}\right) &amp;= \left(\frac{1.3 \times 10^8 \cancel{joules}}{5\textit{ dollars}}\right)\left(\frac{1 megajoule}{10^6 \cancel{joule}}\right) \\
&amp;=\frac{1.3\times 10^8 megajoules}{(5 \textit{ dollars})\left(10^6\right)}\\
&amp;= 26 \frac{megajoules}{dollar}
\end{align}
</div>
</div>

<div id="outline-container-orgf2d3def" class="outline-3">
<h3 id="orgf2d3def">In Python</h3>
<div class="outline-text-3" id="text-orgf2d3def">
<div class="highlight"><pre><span></span><span class="n">gallons_per_dollar</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">joules_per_gallon</span> <span class="o">=</span> <span class="mi">13</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
<span class="n">joules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_gallon</span> <span class="o">*</span> <span class="n">gallons_per_dollar</span>
<span class="n">MEGAJOULES_PER_JOULE</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">gas_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_dollar</span> <span class="o">*</span> <span class="n">megajoules_per_joule</span>
<span class="n">gasoline</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">gas_megajoules_per_dollar</span>

<span class="n">print_energy</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">gas_megajoules_per_dollar</span><span class="p">),</span> <span class="s2">"Gasoline"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gasoline</span><span class="p">,</span> <span class="s2">"Gasoline"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Gasoline provides 26.00 megajoules per dollar.
Gasoline costs $0.0385 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc24775" class="outline-2">
<h2 id="orgcc24775">How Many MegaJoules For a Dollar of Electricity?</h2>
<div class="outline-text-2" id="text-orgcc24775">
<ul class="org-ul">
<li>Electricity is $0.05 per kilowatt-hour.</li>
<li>\(1\text{ watt} = 1 \frac{joule}{second}\)</li>
<li>\(1\text{ kilowatt-hour} = 1,000\text{ watts} \times 3,600\text{ seconds}\)</li>
</ul>
</div>

<div id="outline-container-org42729eb" class="outline-3">
<h3 id="org42729eb">Kilowatt-Hour To Joules</h3>
<div class="outline-text-3" id="text-org42729eb">
\begin{align}
1 kilowatt-hour &amp;= (1,000\text{ watts})(3,600\text{ seconds})\\
  &amp;= \left(\frac{1,000\text{ joules}}{\cancel{second}}\right)\left(3,600 \cancel{seconds}\right)\\
  &amp;= 36 \times 10^5 \text{ joules}
\end{align}
</div>
</div>
<div id="outline-container-org1444a80" class="outline-3">
<h3 id="org1444a80">A Dollar's Worth Of Megajoules</h3>
<div class="outline-text-3" id="text-org1444a80">
\begin{align}
\frac{1 \text{ kilowatt-hour}}{0.05\text{ dollars}} &amp;= \left(\frac{3.6 \times \cancel{10^6 joules}}{0.05\text{ dollars}}\right)\left(\frac{1 \text{ megajoule}}{\cancel{10^6 joules}}\right)\\

&amp;= \left(\frac{3.6\ megajoules}{0.05\text{ dollars}}\right)\left(\frac{20}{20}\right) \\
&amp;= 72 \ \frac{megajoules}{dollar}

\end{align}
</div>
</div>
<div id="outline-container-org8815b2c" class="outline-3">
<h3 id="org8815b2c">Check The Math</h3>
<div class="outline-text-3" id="text-org8815b2c">
<div class="highlight"><pre><span></span><span class="n">kilowatt_hours_per_dollar</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># 1/0.05 = 20</span>
<span class="n">megajoules</span> <span class="o">=</span> <span class="mf">3.6</span>
<span class="n">electricity_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">kilowatt_hours_per_dollar</span> <span class="o">*</span> <span class="n">megajoules</span>
<span class="n">electricity</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">electricity_megajoules_per_dollar</span>

<span class="n">print_energy</span><span class="p">(</span><span class="n">electricity_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Electricity"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">electricity</span><span class="p">,</span> <span class="s2">"Electricity"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Electricity provides 72.00 megajoules per dollar.
Electricity costs $0.0139 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org97943a3" class="outline-2">
<h2 id="org97943a3">How Many Megajoules For a Dollar Of Natural Gas?</h2>
<div class="outline-text-2" id="text-org97943a3">
<ul class="org-ul">
<li>A standard cubic foot of natural gas has about \(1.1 \times 10^6\) joules of energy.</li>
<li>You can get about \(5\times 10^5\) BTUs of gas for a dollar.</li>
<li>There are about 1,030 BTUs in a cubic foot.</li>
</ul>

\begin{align}
\left(1.1 \times 10^6 \frac{joules}{\cancel{cubic foot}}\right)\left(\frac{1\ \cancel{cubic foot}}{1.03 \times 10^3\ BTU}\right) &amp;= \left(\frac{1.1 \times 10^3\ joules}{1.03\ \cancel{BTU}}\right)\left(\frac{5 \times 10^5\ \cancel{BTU}}{dollar}\right)\\
&amp;= \left(\frac{5.5 \times 10^8\ \cancel{joules}}{1.03\ dollars}\right)\left(\frac{1\ Megajoule}{10^6 \cancel{joules}}\right)\\
&amp;= \left(\frac{5.5 \times 10^2\ Megajoules}{1.03 dollars}\right)\\
&amp;\approx 533.98\ \frac{Megajoules}{dollar}\\
\end{align}
</div>

<div id="outline-container-orgb5b6897" class="outline-3">
<h3 id="orgb5b6897">Check The Math</h3>
<div class="outline-text-3" id="text-orgb5b6897">
<div class="highlight"><pre><span></span><span class="n">joules_per_cubic_foot</span> <span class="o">=</span> <span class="mf">1.1E6</span>
<span class="n">cubic_feet_per_btu</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1030</span>
<span class="n">btus_per_dollar</span> <span class="o">=</span> <span class="mf">5e5</span>

<span class="n">joules_per_btu</span> <span class="o">=</span> <span class="n">joules_per_cubic_foot</span> <span class="o">*</span> <span class="n">cubic_feet_per_btu</span>

<span class="n">joules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_btu</span> <span class="o">*</span> <span class="n">btus_per_dollar</span>
<span class="n">natural_gas_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">joules_per_dollar</span> <span class="o">*</span> <span class="n">MEGAJOULES_PER_JOULE</span>
<span class="n">natural_gas</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">natural_gas_megajoules_per_dollar</span>
<span class="n">print_energy</span><span class="p">(</span><span class="n">natural_gas_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Natural Gas"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">natural_gas</span><span class="p">,</span> <span class="s2">"Natural Gas"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Natural Gas provides 533.98 megajoules per dollar.
Natural Gas costs $0.0019 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc3c008a" class="outline-2">
<h2 id="orgc3c008a">How Many Megajoules For a Dollar of Coal?</h2>
<div class="outline-text-2" id="text-orgc3c008a">
<ul class="org-ul">
<li>A Ton of coal holds about \(3.2 × 10^{10}\) joules of energy.</li>
<li>A Ton of coal costs $40.</li>
</ul>
<p>
How many Megajoules of energy in the form of coal can you get for a dollar?
</p>

\begin{align}
\left(\frac{3.2 \times 10^{10}\ joules}{40\ dollars}\right) &amp;= \left(\frac{8 \times 10^{8} joules}{dollar}\right)\\
&amp;= \left(\frac{8 \times 10^{8}\ \cancel{joules}}{dollar}\right)\left(\frac{1\ Megajoule}{1 \times 10^6\ \cancel{joules}}\right)\\
&amp;=8 \times 10^2 \frac{Megajoules}{dollar}
\end{align}
</div>

<div id="outline-container-orgfe5e6b2" class="outline-3">
<h3 id="orgfe5e6b2">Checking the Math</h3>
<div class="outline-text-3" id="text-orgfe5e6b2">
<div class="highlight"><pre><span></span><span class="n">coal_megajoules_per_dollar</span> <span class="o">=</span> <span class="n">MEGAJOULES_PER_JOULE</span> <span class="o">*</span> <span class="mf">3.2e10</span><span class="o">/</span><span class="mi">40</span>
<span class="n">coal</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">coal_megajoules_per_dollar</span>
<span class="n">print_energy</span><span class="p">(</span><span class="n">coal_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Coal"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coal</span><span class="p">,</span> <span class="s2">"Coal"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Coal provides 800.00 megajoules per dollar.
Coal costs $0.0013 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbeb7510" class="outline-2">
<h2 id="orgbeb7510">How Many Megajoules Per Dollar In Corn (Biodiesel)?</h2>
<div class="outline-text-2" id="text-orgbeb7510">
<ul class="org-ul">
<li>Corn oil costs about $0.10 per fluid ounce (wholesale).</li>
<li>A fluid ounce carries about 240 dietary calories (kilo-calories).</li>
<li>A calorie is about 4.2 joules.</li>
</ul>
<p>
How many Megajoules of energy in the form of corn oil can you get for a dollar?
</p>

\begin{align}
\left(\frac{1\cancel{fluid-ounce}}{0.10\ dollar}\right)\left(\frac{240\ kilocalories}{\cancel{fluid- ounce}}\right) &amp;= \left(\frac{240\ \cancel{kilocalories}}{0.10\ dollar}\right)\left(\frac{10^3\ calories}{1\ \cancel{kilocalorie}}\right)\\
&amp;=\left(\frac{24\times 10^4\ \cancel{calories}}{0.10\ dollar}\right)\left(\frac{4.2\ joules}{1 \cancel{calorie}}\right)\\
&amp;=\left(\frac{100.8\times 10^4\ joules}{1 \times 10^{-1} dollar}\right)\\
&amp;=\left(\frac{1.008 \times 10^7 joules}{dollar}\right)\left(\frac{1\ megajoule}{10^6\ joules}\right)\\
&amp;= 1.008 \times 10^{1}\ \frac{megajoules}{dollar}\\
&amp;= 10.008
\end{align}
</div>

<div id="outline-container-org7064d50" class="outline-3">
<h3 id="org7064d50">Checking the Math</h3>
<div class="outline-text-3" id="text-org7064d50">
<div class="highlight"><pre><span></span><span class="n">ounces_per_dollar</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">0.10</span>
<span class="n">kilocalories_per_ounce</span> <span class="o">=</span> <span class="mi">240</span>
<span class="n">joules_per_calorie</span> <span class="o">=</span> <span class="mf">4.2</span>
<span class="n">calories_per_kilocalorie</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

<span class="n">corn_megajoules_per_dollar</span> <span class="o">=</span> <span class="p">(</span><span class="n">ounces_per_dollar</span>
			      <span class="o">*</span> <span class="n">kilocalories_per_ounce</span>
			      <span class="o">*</span> <span class="n">calories_per_kilocalorie</span>
			      <span class="o">*</span> <span class="n">joules_per_calorie</span>
			      <span class="o">*</span> <span class="n">MEGAJOULES_PER_JOULE</span><span class="p">)</span>
<span class="n">corn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">corn_megajoules_per_dollar</span>
<span class="n">print_energy</span><span class="p">(</span><span class="n">corn_megajoules_per_dollar</span><span class="p">,</span> <span class="s2">"Corn"</span><span class="p">)</span>
<span class="n">COSTS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">corn</span><span class="p">,</span> <span class="s2">"Corn"</span><span class="p">))</span>
</pre></div>

<pre class="example">
Corn provides 10.08 megajoules per dollar.
Corn costs $0.0992 per megajoule.
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f186f5" class="outline-2">
<h2 id="org8f186f5">What Is the Ratio of the Cost of the Most Expensive to the Cheapest?</h2>
<div class="outline-text-2" id="text-org8f186f5">
<div class="highlight"><pre><span></span><span class="n">most_expensive</span><span class="p">,</span> <span class="n">cheapest</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">COSTS</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">COSTS</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The most expensive form of energy is </span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2"> "</span>
      <span class="sa">f</span><span class="s2">"at $</span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> per megajoule."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The cheapest form of energy is </span><span class="si">{</span><span class="n">cheapest</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2"> at "</span>
      <span class="sa">f</span><span class="s2">"$</span><span class="si">{</span><span class="n">cheapest</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> per megajoule."</span><span class="p">)</span>
</pre></div>

<pre class="example">
The most expensive form of energy is Corn at $0.10 per megajoule.
The cheapest form of energy is Coal at $0.0013 per megajoule.
</pre>


<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">most_expensive</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="o">/</span><span class="n">cheapest</span><span class="p">[</span><span class="n">cost</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> "</span>
      <span class="sa">f</span><span class="s2">"times more expensive than </span><span class="si">{</span><span class="n">cheapest</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
</pre></div>

<pre class="example">
Corn is 79.37 times more expensive than Coal.
</pre>
</div>
</div>

<div id="outline-container-org3e95e01" class="outline-2">
<h2 id="org3e95e01">Source</h2>
<div class="outline-text-2" id="text-org3e95e01">
<ul class="org-ul">
<li><a href="posts/course-global-warming/">Global Warming I: The Science and Modeling of Climate Change</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/number-of-subsets-in-a-set/index.html" class="u-url">Number of Subsets In a Set</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/number-of-subsets-in-a-set/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-27T13:09:06-07:00" itemprop="datePublished" title="2022-06-27 13:09">2022-06-27 13:09</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org2f96396" class="outline-2">
<h2 id="org2f96396">Short Answer</h2>
<div class="outline-text-2" id="text-org2f96396">
<p>
The number of subsets for a set of <i>n</i> elements is \(2^n\).
</p>
</div>
</div>

<div id="outline-container-org70c0331" class="outline-2">
<h2 id="org70c0331">One Way To Remember It</h2>
<div class="outline-text-2" id="text-org70c0331">
<p>
Let's say we have a set of <i>n</i> things and we want to know how many different ways we can pick subsets of those things (including all of them or none of them). If we have three things, for instance, we might pick only the first item, or the first and the last item, or only the second item, etc.
</p>

<p>
We can represent the items as boxes in a row and if an item is in the subset we put a one in its box and if it isn't then we put a zero there. So for the three item example we can represent the subset that has the first and third item as <i>101</i> (the boxes are invisible and elastic). Writing it this way we can think of each element of the set as a binary digit and the number of subsets you can create is the same as the number of binary numbers with the same number of digits as the elements in our set.
</p>

<p>
To see all the possible subsets you can write out the binary numbers. For the case of three elements we represent them as three digits so finding the subsets will be the equivalent of counting from 0 to 7 in binary.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="org-right"></colgroup>
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right"> </th>
<th scope="col" class="org-right">Item 1</th>
<th scope="col" class="org-right">Item 2</th>
<th scope="col" class="org-right">Item 3</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">5</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">6</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">7</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
In this case we get 8 possibilities. More generally, for <i>n</i> digits we can count from \(0\) to \(2^n - 1\) for a total of \(2^n\) numbers so the total number of subsets of a set with <i>n</i> elements is \(2^n\).
</p>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/algorithms-illuminated-part-3/index.html" class="u-url">Algorithms Illuminated - Part III: Greedy Algorithms and Dynamic Programming</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/algorithms-illuminated-part-3/index.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-27T13:03:04-07:00" itemprop="datePublished" title="2022-06-27 13:03">2022-06-27 13:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org163d3e6" class="outline-2">
<h2 id="org163d3e6">Citation</h2>
<div class="outline-text-2" id="text-org163d3e6">
<ul class="org-ul">
<li>[AI3] Roughgarden T. Algorithms illuminated. Part 3: Greedy algorithms and dynamic programming. First edition. San Francisco, CA: Soundlikeyourself Publishing, LLC; 2019. 217 p.</li>
</ul>
</div>
</div>
<div id="outline-container-orgc2adaf3" class="outline-2">
<h2 id="orgc2adaf3">On The Web</h2>
<div class="outline-text-2" id="text-orgc2adaf3">
<ul class="org-ul">
<li>
<a href="https://algorithmsilluminated.org/">Algorithms Illuminated website</a>: Has links to all four books, videos, test cases, etc.</li>
<li><a href="https://timroughgarden.org/">Tim Roughgarden's (the author) Website</a></li>
</ul>
</div>
</div>
<div id="outline-container-org3de2dc3" class="outline-2">
<h2 id="org3de2dc3">Other Books in the Series</h2>
<div class="outline-text-2" id="text-org3de2dc3">
<ul class="org-ul">
<li><a href="posts/algorithms-illuminated-part-1/">Algorithms Illuminated - Part 1: The Basics</a></li>
</ul>
</div>
</div>
    </div>
    </article>
</div>

        <ul class="pager postindexpager clearfix">
<li class="next"><a href="index-7.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script><!--End of body content--><footer id="footer">
            Scribbles by <a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> © 2023 - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<div id="license" xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
<span property="dct:title">Ape-Iron</span> is licensed under
<a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0
<img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a> 

            
            
        
    </div>
</footer>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</div>
</body>
</html>
