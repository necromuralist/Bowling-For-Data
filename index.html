<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Striking out for data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bowling For Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/">
<link rel="next" href="index-4.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/red-black-trees-rotation/" type="text/html">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href=".">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Searchâ€¦" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/red-black-trees-rotation/" class="u-url">Red-Black Trees: Rotation</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/red-black-trees-rotation/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-21T15:05:47-07:00" itemprop="datePublished" title="2022-03-21 15:05">2022-03-21 15:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/red-black-trees-rotation/#org6300fdc">What are Rotations?</a></li>
<li>
<a href="posts/red-black-trees-rotation/#orgd545c0a">Left Rotate</a>
<ul>
<li><a href="posts/red-black-trees-rotation/#orgc1c6721">Pseudocode</a></li>
<li>
<a href="posts/red-black-trees-rotation/#org6cb5064">Some Code</a>
<ul>
<li><a href="posts/red-black-trees-rotation/#orgb2bb0c9">A Fake Tree</a></li>
<li><a href="posts/red-black-trees-rotation/#orgf1bf053">The Left-Rotate</a></li>
<li><a href="posts/red-black-trees-rotation/#org939fe89">Testing It Out</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/red-black-trees-rotation/#org6ee0951">Right Rotate</a>
<ul>
<li><a href="posts/red-black-trees-rotation/#org1e10c34">Pseudocode</a></li>
<li>
<a href="posts/red-black-trees-rotation/#orgc0783a8">Some Code</a>
<ul>
<li><a href="posts/red-black-trees-rotation/#org0c2b39e">The Right-Rotate</a></li>
<li><a href="posts/red-black-trees-rotation/#org8bcd417">Testing It Out</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/red-black-trees-rotation/#org7ae4906">Sources</a></li>
</ul>
</div>
</div>
<p>
This is a post on rotating nodes in a tree. It is a continuation of <a href="posts/red-black-trees/">this post</a>.
</p>
<div id="outline-container-org6300fdc" class="outline-2">
<h2 id="org6300fdc">What are Rotations?</h2>
<div class="outline-text-2" id="text-org6300fdc">
<p>
In the context of a Red-Black Tree, a Rotation involves swapping the position of two nodes (a parent and one of its children) while maintaining the Binary Search Tree Properties. There are two kinds of rotation:
</p>

<ul class="org-ul">
<li>
<b><b>Right Rotation</b></b>: The left child is moved into the position of its parent and the former parent becomes the new parent's right child.</li>
<li>
<b><b>Left Rotation</b></b>: The right child is moved into the position of its parent and the former parent becomes the new parent's left child.</li>
</ul>
</div>
</div>
<div id="outline-container-orgd545c0a" class="outline-2">
<h2 id="orgd545c0a">Left Rotate</h2>
<div class="outline-text-2" id="text-orgd545c0a">
<p>
<a href="posts/clrs/">CLRS</a> gives the Left Rotate function so we'll start with that.
</p>
</div>
<div id="outline-container-orgc1c6721" class="outline-3">
<h3 id="orgc1c6721">Pseudocode</h3>
<div class="outline-text-3" id="text-orgc1c6721">
<pre id="left-rotate" style="display:hidden;">
\begin{algorithm}
\caption{LeftRotate}
\begin{algorithmic}
\INPUT The Tree and the parent Node to rotate
\PROCEDURE{LeftRotate}{\textit{T}, \textit{x}}

\STATE \textit{y} $\gets$ \textit{x}.right
\STATE \textit{x}.right $\gets$ \textit{y}.left

\IF {\textit{y}.left $\neq$ \textit{T}.\textsc{NIL}}
  \STATE \textit{y}.left.parent $\gets$ \textit{x}
\ENDIF

\STATE \textit{y}.parent $\gets$ \textit{x}.parent

\IF {\textit{x}.parent = \textit{T}.\textsc{NIL}}
 \STATE \textit{T}.root $\gets$ \textit{y}
\ELIF {\textit{x} = \textit{x}.parent.left}
 \STATE \textit{x}.parent.left $\gets$ \textit{y}
\ELSE
 \STATE \textit{x}.parent.right $\gets$ \textit{y}
\ENDIF

\STATE \textit{y}.left $\gets$ \textit{x}
\STATE \textit{x}.parent $\gets$ \textit{y}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org6cb5064" class="outline-3">
<h3 id="org6cb5064">Some Code</h3>
<div class="outline-text-3" id="text-org6cb5064">
<div class="highlight"><pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">be</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>

<span class="kn">import</span> <span class="nn">networkx</span>

<span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.red_black_tree</span> <span class="kn">import</span> <span class="n">tree</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"red-black-trees-rotation"</span>
<span class="n">OUTPUT</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"files/posts/</span><span class="si">{</span><span class="n">SLUG</span><span class="si">}</span><span class="s2">/"</span>
</pre></div>
</div>

<div id="outline-container-orgb2bb0c9" class="outline-4">
<h4 id="orgb2bb0c9">A Fake Tree</h4>
<div class="outline-text-4" id="text-orgb2bb0c9">
<p>
I don't have a tree class yet so I'll make one here so that we can run the rotation.
</p>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Tree</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
	<span class="k">return</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgf1bf053" class="outline-4">
<h4 id="orgf1bf053">The Left-Rotate</h4>
<div class="outline-text-4" id="text-orgf1bf053">
<p>
This is more-or-less a straight implementation of the Left-Rotate algorithm given above. The main difference is that our Node object automatically sets the parent for a child when the child is set on the node so you won't see the parent
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">left_rotate</span><span class="p">(</span><span class="n">source_tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Rotates the node with its right child</span>

<span class="sd">    Args:</span>
<span class="sd">     source_tree: the binary search tree containing the node</span>
<span class="sd">     node: the parent node to rotate</span>
<span class="sd">    """</span>
    <span class="n">new_parent</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span>
    <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">left</span>

    <span class="n">new_parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>

    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">:</span>
	<span class="n">source_tree</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">new_parent</span>
    <span class="n">new_parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">node</span>
    <span class="k">return</span>
</pre></div>

<p>
<b><b>Note:</b></b> Because I defined the <code>Node</code> class so that setting any of the three relation attributes (<code>parent</code>, <code>left</code>, <code>right</code>) updates both sides of the link (e.g. setting <code>left</code> also updates <code>left.parent</code>) we don't need the lines of the algorithm that figure out the other side of a newly established link, so the code is a little shorter than the pseudocode.
</p>
</div>
</div>

<div id="outline-container-org939fe89" class="outline-4">
<h4 id="org939fe89">Testing It Out</h4>
<div class="outline-text-4" id="text-org939fe89">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preorder</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Traverse the nodes and build an adjancency dictionary</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">left</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="k">else</span> <span class="kc">None</span>
	<span class="n">right</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span> <span class="k">else</span> <span class="kc">None</span>
	<span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)):</span>
	    <span class="k">if</span> <span class="n">left</span> <span class="ow">and</span> <span class="n">right</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
	    <span class="k">elif</span> <span class="n">left</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="p">)</span>
	    <span class="k">else</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">right</span><span class="p">,)</span>
	<span class="n">preorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
	<span class="n">preorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_tree</span><span class="p">(</span><span class="n">root_parent</span><span class="p">:</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""Build the test-tree</span>

<span class="sd">    Args:</span>
<span class="sd">     - root_parent: The parent of the root-node</span>

<span class="sd">    Returns:</span>
<span class="sd">     Tree, Nodes dict</span>
<span class="sd">    """</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root_parent</span><span class="p">)</span>

    <span class="n">root</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">if</span> <span class="n">root_parent</span> <span class="ow">is</span> <span class="n">tree</span><span class="o">.</span><span class="n">NIL</span> <span class="k">else</span> <span class="n">root_parent</span>
    <span class="n">test_tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>

    <span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

    <span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span>
</pre></div>
</div>
<ul class="org-ul">
<li>
<a id="orgd916779"></a>Nil Parent<br><div class="outline-text-5" id="text-orgd916779">
<p>
Our first case will be when the node to swap with its child is root.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_nodes</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">root_parent</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">left_rotate</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">root_parent</span> <span class="ow">is</span> <span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">:</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">root_parent</span><span class="p">))</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">root_parent</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">nodes</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">build_tree</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_graph</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">adjacencies</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">preorder</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">adjacencies</span><span class="p">)</span>
    <span class="n">pygraph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">nx_pydot</span><span class="o">.</span><span class="n">to_pydot</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">pygraph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">OUTPUT</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.png"</span><span class="p">)</span>
    <span class="k">return</span>

<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_left_rotate"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_left_rotate.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="n">test_nodes</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root-left-rotated"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root-left-rotated.png" alt="nil"></p>
</div>
</li>
<li>
<a id="org6318506"></a>Left Child<br><div class="outline-text-5" id="text-org6318506">
<p>
This is the case where the parent node being demoted is the left-child of its parent.
</p>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">build_tree</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_left_left_rotate"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_left_left_rotate.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">test_nodes</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_left_left_rotated"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_left_left_rotated.png" alt="nil"></p>
</div>
</li>

<li>
<a id="org28a8411"></a>Right Child<br><div class="outline-text-5" id="text-org28a8411">
<p>
This is the case where the parent node being demoted is the right-child of its parent.
</p>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">build_tree</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_parent_right_rotate"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_parent_right_rotate.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="n">test_nodes</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_parent_right_rotated"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_parent_right_rotated.png" alt="nil"></p>
</div>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org6ee0951" class="outline-2">
<h2 id="org6ee0951">Right Rotate</h2>
<div class="outline-text-2" id="text-org6ee0951">
<p>
This will be the Right-Rotate version. Since we saw with the Left Rotate that the <a href="posts/the-red-black-tree-nodes/">Node definition</a> reduces some of the code needed for the rotation I'll leave those lines out of this version
</p>
</div>
<div id="outline-container-org1e10c34" class="outline-3">
<h3 id="org1e10c34">Pseudocode</h3>
<div class="outline-text-3" id="text-org1e10c34">
<pre id="right-rotate" style="display:hidden;">
\begin{algorithm}
\caption{RightRotate}
\begin{algorithmic}
\INPUT The Tree and the parent Node to rotate
\PROCEDURE{RightRotate}{\textit{T}, \textit{x}}

\STATE \textit{y} $\gets$ \textit{x}.left
\STATE \textit{x}.left $\gets$ \textit{y}.right

\STATE \textit{y}.parent $\gets$ \textit{x}.parent

\IF {\textit{x}.parent = \textit{T}.\textsc{NIL}}
 \STATE \textit{T}.root $\gets$ \textit{y}
\ENDIF

\STATE \textit{y}.right $\gets$ \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
This makes it a little clearer, I think. What the algorithm is doing is pretty simple. If <code>x</code> is the parent node to rotate with its right child:
</p>

<ol class="org-ol">
<li>Move <code>x</code>'s left grandchild up to be <code>x</code>'s left-child.</li>
<li>Set the parent of the prior <code>x.left</code> to be <code>x</code>'s parent.</li>
<li>If <code>x</code> was root, make <code>y</code> root.</li>
<li>Make <code>x</code> the right child of its prior left-child.</li>
</ol>
</div>
</div>

<div id="outline-container-orgc0783a8" class="outline-3">
<h3 id="orgc0783a8">Some Code</h3>
<div class="outline-text-3" id="text-orgc0783a8">
</div>
<div id="outline-container-org0c2b39e" class="outline-4">
<h4 id="org0c2b39e">The Right-Rotate</h4>
<div class="outline-text-4" id="text-org0c2b39e">
<p>
This is more-or-less a straight implementation of the Right-Rotate algorithm given above. 
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">right_rotate</span><span class="p">(</span><span class="n">source_tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Rotates the node with its left child</span>

<span class="sd">    Args:</span>
<span class="sd">     source_tree: the binary search tree containing the node</span>
<span class="sd">     node: the parent node to rotate</span>
<span class="sd">    """</span>
    <span class="n">previous_child</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span>
    <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">previous_child</span><span class="o">.</span><span class="n">right</span>
    <span class="n">previous_child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>

    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">:</span>
	<span class="n">source_tree</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">previous_child</span>
    <span class="n">previous_child</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">node</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>

<div id="outline-container-org8bcd417" class="outline-4">
<h4 id="org8bcd417">Testing It Out</h4>
<div class="outline-text-4" id="text-org8bcd417">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_right_rotate_tree</span><span class="p">(</span><span class="n">root_parent</span><span class="p">:</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""Build the test-tree</span>

<span class="sd">    Args:</span>
<span class="sd">     - root_parent: The parent of the root-node</span>

<span class="sd">    Returns:</span>
<span class="sd">     Tree, Nodes dict</span>
<span class="sd">    """</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">root_parent</span><span class="p">)</span>

    <span class="n">root</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="k">if</span> <span class="n">root_parent</span> <span class="ow">is</span> <span class="n">tree</span><span class="o">.</span><span class="n">NIL</span> <span class="k">else</span> <span class="n">root_parent</span>
    <span class="n">test_tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>

    <span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span>
</pre></div>
</div>
<ul class="org-ul">
<li>
<a id="org2159bd3"></a>Nil Parent<br><div class="outline-text-5" id="text-org2159bd3">
<p>
Our first case will be when the node to swap with its child is root.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_nodes_right</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">root_parent</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">right_rotate</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>

    <span class="c1"># check the new root</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">root_parent</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">nodes</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">build_right_rotate_tree</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_right_rotate"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_right_rotate.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="n">test_nodes_right</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_right_rotated"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_right_rotated.png" alt="nil"></p>
</div>
</li>
<li>
<a id="org4682f3f"></a>Left Child<br><div class="outline-text-5" id="text-org4682f3f">
<p>
This is the case where the parent node being demoted is the left-child of its parent.
</p>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">build_right_rotate_tree</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_right_left_rotate"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_right_left_rotate.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">test_nodes_right</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root-right-left-rotated"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root-right-left-rotated.png" alt="nil"></p>
</div>
</li>

<li>
<a id="orga4bd556"></a>Right Child<br><div class="outline-text-5" id="text-orga4bd556">
<p>
This is the case where the parent node being demoted is the right-child of its parent.
</p>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">build_right_rotate_tree</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_right_right_rotate"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_right_right_rotate.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">test_nodes_right</span><span class="p">(</span><span class="n">test_tree</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">test_tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">"root_right_right_rotated"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/red-black-trees-rotation/root_right_right_rotated.png" alt="nil"></p>
</div>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org7ae4906" class="outline-2">
<h2 id="org7ae4906">Sources</h2>
<div class="outline-text-2" id="text-org7ae4906">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("left-rotate"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("right-rotate"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-red-black-tree-nodes/" class="u-url">The Red-Black Tree: Nodes</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-red-black-tree-nodes/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-19T15:58:42-07:00" itemprop="datePublished" title="2022-03-19 15:58">2022-03-19 15:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/the-red-black-tree-nodes/#org634bb64">Beginning</a>
<ul>
<li><a href="posts/the-red-black-tree-nodes/#orgff2c97d">Imports</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org287d12a">Set Up</a></li>
</ul>
</li>
<li>
<a href="posts/the-red-black-tree-nodes/#orgce19b4f">Middle</a>
<ul>
<li><a href="posts/the-red-black-tree-nodes/#org842ac96">Imports</a></li>
<li>
<a href="posts/the-red-black-tree-nodes/#org4e218a7">The Nil Node and Colors</a>
<ul>
<li><a href="posts/the-red-black-tree-nodes/#org984db09">Color</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org15362f9">The Nil Node</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/the-red-black-tree-nodes/#orgd85de22">The Node</a>
<ul>
<li>
<a href="posts/the-red-black-tree-nodes/#orgf2facea">Properties</a>
<ul>
<li><a href="posts/the-red-black-tree-nodes/#org038e258">Parent</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org79affd0">Left</a></li>
<li><a href="posts/the-red-black-tree-nodes/#orgdd85868">Right</a></li>
</ul>
</li>
<li>
<a href="posts/the-red-black-tree-nodes/#org3cc4424">Comparisons</a>
<ul>
<li><a href="posts/the-red-black-tree-nodes/#orgc875d8a">Equal</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org5f340ce">Less Than</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org446a9e4">Less Than or Equal</a></li>
</ul>
</li>
<li><a href="posts/the-red-black-tree-nodes/#orgb557e5e">Check Nodes</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org8dacd6a">String Output</a></li>
<li>
<a href="posts/the-red-black-tree-nodes/#orgae85c4f">Testing</a>
<ul>
<li><a href="posts/the-red-black-tree-nodes/#orge387620">Imports</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org9ea88e7">One Node</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org5c6149d">Check the Comparisons</a></li>
<li><a href="posts/the-red-black-tree-nodes/#orgd2c6b90">Check the Two-Way Updates.</a></li>
<li><a href="posts/the-red-black-tree-nodes/#orgfcf2fdb">The Check Node Method</a></li>
<li><a href="posts/the-red-black-tree-nodes/#org8e176c1">Check the Red-Black Properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/the-red-black-tree-nodes/#org8e1e3d6">End</a></li>
</ul>
</div>
</div>
<p>
This is a post that implements the Node for a Red-Black Tree. It is a continuation of <a href="posts/red-black-trees/">this post</a>.
</p>
<div id="outline-container-org634bb64" class="outline-2">
<h2 id="org634bb64">Beginning</h2>
<div class="outline-text-2" id="text-org634bb64">
<p>
I'm going to implement a Node and Red-Black Tree so that I can explore it further in other posts. 
</p>
</div>
<div id="outline-container-orgff2c97d" class="outline-3">
<h3 id="orgff2c97d">Imports</h3>
<div class="outline-text-3" id="text-orgff2c97d">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</pre></div>
</div>
</div>
<div id="outline-container-org287d12a" class="outline-3">
<h3 id="org287d12a">Set Up</h3>
<div class="outline-text-3" id="text-org287d12a">
<div class="highlight"><pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"the-red-black-tree-nodes"</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">"files/posts/"</span><span class="p">)</span><span class="o">/</span><span class="n">SLUG</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
    <span class="n">OUTPUT_PATH</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgce19b4f" class="outline-2">
<h2 id="orgce19b4f">Middle</h2>
<div class="outline-text-2" id="text-orgce19b4f">
<p>
This is the basic structure of our tree.
</p>

<p>
<img src="posts/the-red-black-tree-nodes/rb-tree.png" alt="nil"></p>
</div>

<div id="outline-container-org842ac96" class="outline-3">
<h3 id="org842ac96">Imports</h3>
<div class="outline-text-3" id="text-org842ac96">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">bowling.types</span> <span class="kn">import</span> <span class="n">Orderable</span>
</pre></div>
</div>
</div>
<div id="outline-container-org4e218a7" class="outline-3">
<h3 id="org4e218a7">The Nil Node and Colors</h3>
<div class="outline-text-3" id="text-org4e218a7">
<p>
I'm going to set up an Enum for the Colors and instead of using an actual Node object I'll use a namedtuple to (hopefully) make it simpler.
</p>

<p>
<b><b>Note:</b></b> The <a href="https://docs.python.org/3/library/enum.html">python Enum</a> uses object ID as the way to see if two things are equal, not their values. You can get around it, but since both the colors and the Nil are meant only to be used internally by the tree, not by the end user, I'm going to leave it as is. This means that to do things like check the color outside of the <code>tree</code> module that I'm creating, you have to import the module and refer to the Color or NIL using the module (e.g. <code>tree.Color</code>), otherwise you might end up with some funky problems where things that look equal aren't because they are actually different objects.
</p>
</div>

<div id="outline-container-org984db09" class="outline-4">
<h4 id="org984db09">Color</h4>
<div class="outline-text-4" id="text-org984db09">
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">"""red or black"""</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">BLACK</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bowling.data_structures.red_black_tree</span> <span class="kn">import</span> <span class="n">tree</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>

<span class="n">red</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span>
<span class="nb">print</span><span class="p">(</span><span class="n">red</span> <span class="ow">is</span> <span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">red</span> <span class="o">==</span> <span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">red</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

<pre class="example">
Color.RED
Color.BLACK
True
True
False
</pre>


<p>
Note that last case (<code>print(red==1)</code>). It's <code>False</code> because I'm using an Enum. We could switch it to an <a href="https://docs.python.org/3/library/enum.html#intenum">IntEnum</a> and allow integers but for now I'm sticking to the Enum to see how well it works.
</p>
</div>
</div>

<div id="outline-container-org15362f9" class="outline-4">
<h4 id="org15362f9">The Nil Node</h4>
<div class="outline-text-4" id="text-org15362f9">
<div class="highlight"><pre><span></span><span class="n">NIL_KEY</span> <span class="o">=</span> <span class="s2">"NIL"</span>
<span class="n">NIL</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"NIL"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"key"</span><span class="p">,</span> <span class="s2">"color"</span><span class="p">,</span> <span class="s2">"parent"</span><span class="p">,</span> <span class="s2">"left"</span><span class="p">,</span> <span class="s2">"right"</span><span class="p">],</span>
		 <span class="n">defaults</span><span class="o">=</span><span class="p">[</span><span class="n">NIL_KEY</span><span class="p">,</span> <span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])()</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="o">.</span><span class="n">color</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">))</span>
</pre></div>

<pre class="example">
NIL(key='NIL', color=&lt;Color.BLACK: 2&gt;)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd85de22" class="outline-2">
<h2 id="orgd85de22">The Node</h2>
<div class="outline-text-2" id="text-orgd85de22">
<p>
The Node for a red-black tree is the same as the <a href="posts/binary-search-tree-node/">Binary Search Tree Node</a> except that it has the <code>color</code> attribute. But, since I'm doing integrity checks in the object that also means that the checks have to be updated to take into consideration the Red-Black Tree Properties.
</p>

<p>
As part of the Insert Node method the new node gets set to RED, so I'm not going to require passing the color in.
</p>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="sd">"""A Node in a Binary Search Tree</span>

<span class="sd">    Args:</span>
<span class="sd">     key: item to compare nodes</span>
<span class="sd">     color: RED or BLACK</span>
<span class="sd">     parent: parent of this node</span>
<span class="sd">     left: left child</span>
<span class="sd">     right: right child</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Orderable</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		 <span class="n">parent</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="n">NIL</span><span class="p">,</span>
		 <span class="n">left</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="n">NIL</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="n">NIL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
	<span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">color</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">))</span>
</pre></div>
</div>

<div id="outline-container-orgf2facea" class="outline-3">
<h3 id="orgf2facea">Properties</h3>
<div class="outline-text-3" id="text-orgf2facea">
</div>
<div id="outline-container-org038e258" class="outline-4">
<h4 id="org038e258">Parent</h4>
<div class="outline-text-4" id="text-org038e258">
<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""The parent of this node"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

<span class="nd">@parent</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the parent and updates the parent</span>

<span class="sd">    Warning:</span>
<span class="sd">     this will clobber the parent's child if there's a node where this should</span>
<span class="sd">    be</span>

<span class="sd">    Args:</span>
<span class="sd">     parent: to add to self</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if parent and self have same key</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">parent_</span> <span class="ow">is</span> <span class="n">NIL</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent_</span>
	<span class="k">return</span>

    <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">parent_</span><span class="p">:</span>
	<span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Self (</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">) cannot equal parent (</span><span class="si">{</span><span class="n">parent_</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># since the left and right assignments update the parent</span>
    <span class="c1"># we need a hack to get around the setters or you end up</span>
    <span class="c1"># with an infinite loop - we set left, they set parent, we set left,...</span>
    <span class="k">if</span> <span class="bp">self</span> <span class="o">&lt;</span> <span class="n">parent_</span><span class="p">:</span>
	<span class="n">parent_</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">parent_</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent_</span>        
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org79affd0" class="outline-4">
<h4 id="org79affd0">Left</h4>
<div class="outline-text-4" id="text-org79affd0">
<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""The left child"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left</span>

<span class="nd">@left</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_left</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the left and its parent</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if left isn't less than self</span>

<span class="sd">    Args:</span>
<span class="sd">     new_left: a node to be the left child or None</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">new_left</span> <span class="ow">is</span> <span class="n">NIL</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">new_left</span>
	<span class="k">return</span>

    <span class="k">assert</span> <span class="n">new_left</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Left (</span><span class="si">{</span><span class="n">new_left</span><span class="si">}</span><span class="s2"> not &lt; self </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">)"</span>
    <span class="n">new_left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">new_left</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgdd85868" class="outline-4">
<h4 id="orgdd85868">Right</h4>
<div class="outline-text-4" id="text-orgdd85868">
<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""The right child"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right</span>

<span class="nd">@right</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_right</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the right and its parent</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if right isn't greater than self</span>

<span class="sd">    Args:</span>
<span class="sd">     new_right: a node to be the right child or None</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">new_right</span> <span class="ow">is</span> <span class="n">NIL</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="n">new_right</span>
	<span class="k">return</span>

    <span class="k">assert</span> <span class="n">new_right</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"right (</span><span class="si">{</span><span class="n">new_right</span><span class="si">}</span><span class="s2"> not &gt; self (</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">)"</span>
    <span class="n">new_right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="n">new_right</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-org3cc4424" class="outline-3">
<h3 id="org3cc4424">Comparisons</h3>
<div class="outline-text-3" id="text-org3cc4424">
<p>
These are convenience methods to make it so that you can compare the node-objects without referring to the key (see the <a href="https://docs.python.org/3/reference/datamodel.html#object.__lt__">python Data Model documentation</a>). In reading the documentation I thought that you had to implement everything, but after implementing <i>less than</i> and <i>less than or equal to</i> the <i>greater than</i> and <i>greater than or equal to</i> comparisons started to work. I guess if you don't implement them they just take the negative of the less than cases.
</p>
</div>

<div id="outline-container-orgc875d8a" class="outline-4">
<h4 id="orgc875d8a">Equal</h4>
<div class="outline-text-4" id="text-orgc875d8a">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""Check if the other node has an equal key</span>

<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">"key"</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5f340ce" class="outline-4">
<h4 id="org5f340ce">Less Than</h4>
<div class="outline-text-4" id="text-org5f340ce">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""See if this key is less than the other's</span>

<span class="sd">    Raises:</span>
<span class="sd">     AttributeError: the other thing doesn't have a key</span>

<span class="sd">    Returns:</span>
<span class="sd">     self &lt; other</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">"key"</span><span class="p">):</span>
	<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"'&lt;' not supported between '</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">' "</span>
			     <span class="sa">f</span><span class="s2">"and '(</span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>
</pre></div>
</div>
</div>
<div id="outline-container-org446a9e4" class="outline-4">
<h4 id="org446a9e4">Less Than or Equal</h4>
<div class="outline-text-4" id="text-org446a9e4">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""See if this key is less than or equal to other's</span>

<span class="sd">    Raises:</span>
<span class="sd">     AttributeError: other doesn't have key</span>

<span class="sd">    Returns:</span>
<span class="sd">     self &lt;= other</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">"key"</span><span class="p">):</span>
	<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"'&lt;' not supported between '</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">' "</span>
			<span class="s2">"and '{type(other)}'"</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgb557e5e" class="outline-3">
<h3 id="orgb557e5e">Check Nodes</h3>
<div class="outline-text-3" id="text-orgb557e5e">
<p>
This is a convenience method to check if a node and its sub-trees maintain the Binary Search Tree Property. It calls the children too so that the whole tree can be checked by calling this on the root. Now that there's checks when the attributes are set this isn't quite as necessary. The only time you might need it is if the attributes are set directly instead of using the setter.
</p>

<p>
<b><b>Note:</b></b> Although the <i>Binary Search Tree Property</i> allows duplicate keys, once you start doing things with the tree like inserting and deleting nodes it causes problems. Also, it's not likely that the keys are what you would be most interested in when using a tree, it would be the data associated with the node, so what would it mean to have two different items associated with the same key? There are probably uses for this, but to make it simpler I'm going to treat the keys more like dictionary keys and say that it's a mistake to have duplicates.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Checks that the Binary Search Tree Property holds</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError: Binary Search Tree Property violated or duplicates exist</span>
<span class="sd">    """</span>
    <span class="c1"># red-black property 1: every node is either red or black</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span> <span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Invalid Color: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2">"</span>

    <span class="c1"># red-black property 4: if a node is red, both children are black</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">:</span>
	<span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span> <span class="ow">and</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">),</span>\
	    <span class="p">(</span><span class="sa">f</span><span class="s2">"Parent: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2"> Left: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2"> "</span>
	     <span class="sa">f</span><span class="s2">"Right: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2">. "</span>
	     <span class="s2">"Both Children of a Red parent must be Black"</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NIL</span><span class="p">:</span>
	<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Left: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="si">}</span><span class="s2"> not &lt; Self: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">"</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NIL</span><span class="p">:</span>
	<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Right: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="si">}</span><span class="s2"> not &gt; Self: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">"</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org8dacd6a" class="outline-3">
<h3 id="org8dacd6a">String Output</h3>
<div class="outline-text-3" id="text-org8dacd6a">
<p>
This is to make it a little easier to print.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""The key as a string"""</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgae85c4f" class="outline-3">
<h3 id="orgae85c4f">Testing</h3>
<div class="outline-text-3" id="text-orgae85c4f">
<p>
I'll have to break this up later.
</p>
</div>
<div id="outline-container-orge387620" class="outline-4">
<h4 id="orge387620">Imports</h4>
<div class="outline-text-4" id="text-orge387620">
<div class="highlight"><pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">be</span><span class="p">,</span>
    <span class="n">be_above</span><span class="p">,</span>
    <span class="n">be_above_or_equal</span><span class="p">,</span>
    <span class="n">be_below</span><span class="p">,</span>
    <span class="n">be_below_or_equal</span><span class="p">,</span>
    <span class="n">be_none</span><span class="p">,</span>
    <span class="n">equal</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">,</span>
    <span class="n">raise_error</span>
<span class="p">)</span>

<span class="c1"># software under test</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.red_black_tree</span> <span class="kn">import</span> <span class="n">tree</span>
</pre></div>
</div>
</div>
<div id="outline-container-org9ea88e7" class="outline-4">
<h4 id="org9ea88e7">One Node</h4>
<div class="outline-text-4" id="text-org9ea88e7">
<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>

<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">color</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">NIL</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5c6149d" class="outline-4">
<h4 id="org5c6149d">Check the Comparisons</h4>
<div class="outline-text-4" id="text-org5c6149d">
<div class="highlight"><pre><span></span><span class="n">uncle</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below_or_equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="n">brother</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">brother</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_above</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">brother</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_above_or_equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="c1"># I'm still deciding who's responsible for checking if a node exists</span>
<span class="c1"># for now I'll copy what happens when None is compared to ints</span>
<span class="n">expect</span><span class="p">(</span><span class="n">brother</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">uncle</span><span class="o">.</span><span class="n">parent</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">brother</span> <span class="o">&lt;</span> <span class="n">uncle</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">brother</span><span class="o">.</span><span class="n">parent</span> <span class="o">&gt;</span> <span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgd2c6b90" class="outline-4">
<h4 id="orgd2c6b90">Check the Two-Way Updates.</h4>
<div class="outline-text-4" id="text-orgd2c6b90">
</div>
<ul class="org-ul">
<li>
<a id="org2296efa"></a>Set the Parent<br><div class="outline-text-5" id="text-org2296efa">
<p>
In the constructor.
</p>
<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bad_parent</span><span class="p">():</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
		     <span class="n">parent</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">),</span>
		     <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
    <span class="k">return</span>

<span class="n">expect</span><span class="p">(</span><span class="n">bad_parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bad_parent</span><span class="p">():</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
    <span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="k">return</span>

<span class="n">expect</span><span class="p">(</span><span class="n">bad_parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li>
<a id="org569dda8"></a>Set The Left Child<br><div class="outline-text-5" id="text-org569dda8">
<div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li>
<a id="org68fe0fd"></a>Set The Right Child<br><div class="outline-text-5" id="text-org68fe0fd">
<div class="highlight"><pre><span></span><span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgfcf2fdb" class="outline-4">
<h4 id="orgfcf2fdb">The Check Node Method</h4>
<div class="outline-text-4" id="text-orgfcf2fdb">
<div class="highlight"><pre><span></span><span class="n">uncle</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>

<span class="c1"># parent is root</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>

<span class="c1"># parent is right child</span>
<span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">uncle</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>

<span class="c1"># parent is left child</span>
<span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">brother</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bad_check</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
    <span class="k">return</span>

<span class="c1"># left node is greater than the parent</span>
<span class="n">lefty</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span> 
    <span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
<span class="n">parent</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad_check</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># left node is less than the parent</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">NIL</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># right node is less than the parent</span>
<span class="n">righty</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">righty</span>
    <span class="k">return</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
<span class="n">parent</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="n">righty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad_check</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># right and left are okay</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">righty</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="c1"># left children of parent's left child have to be less than parent</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="c1"># right is greater than parent</span>
<span class="n">lefty</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">lefty</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># disallow duplicates</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">parent</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">key</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org8e176c1" class="outline-4">
<h4 id="org8e176c1">Check the Red-Black Properties</h4>
<div class="outline-text-4" id="text-org8e176c1">
<div class="highlight"><pre><span></span><span class="c1"># colors have to use the Color Enum</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">to_not</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># if a node is red both children must be black</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span><span class="p">)</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">left</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">BLACK</span>
<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">to_not</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
</pre></div>

<p>
The <a href="posts/binary-search-tree-in-order-traversal/">next post</a> will be about traversing the tree in the order of the nodes.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org8e1e3d6" class="outline-2">
<h2 id="org8e1e3d6">End</h2>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/red-black-trees/" class="u-url">Red-Black Trees</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/red-black-trees/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-19T14:43:23-07:00" itemprop="datePublished" title="2022-03-19 14:43">2022-03-19 14:43</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgf583328" class="outline-2">
<h2 id="orgf583328">What are Red-Black Trees?</h2>
<div class="outline-text-2" id="text-orgf583328">
<p>
A <b>Red-Black Tree</b> is a variation of a <a href="posts/binary-search-trees/">Binary Search Tree</a> that adds an extra attribute to each node - the node's <b>color</b>, which can be either <code>RED</code> or <code>BLACK</code>.
</p>

<p>
<img src="posts/red-black-trees/node.png" alt="nil"></p>
</div>

<div id="outline-container-org1db308a" class="outline-3">
<h3 id="org1db308a">Why Do We Need Red-Black Trees?</h3>
<div class="outline-text-3" id="text-org1db308a">
<p>
The basic operations done on a Binary Search Tree (e.g. search, insert, etc.) are \(O(h)\) - they perform based on the height of the tree, so when the tree is balanced they perform optimally, but the height depends on the order that the nodes are inserted (and deleted) so the tree can end up being taller than we want it to be. Red-Black Trees use the colors and the <b>Red-Black Properties</b> to ensure that the tree is more balanced.
</p>
</div>
</div>
<div id="outline-container-orgc97a604" class="outline-3">
<h3 id="orgc97a604">What are the <b>Red-Black Properties</b>?</h3>
<div class="outline-text-3" id="text-orgc97a604">
<p>
These are the properties that need to be maintained for a Red-Black Tree to work correctly (from <a href="posts/clrs/">CLRS</a>).
</p>

<ol class="org-ol">
<li>Every Node is either Red or Black.</li>
<li>The Root is Black.</li>
<li>Every Leaf (Nil) is Black</li>
<li>If a Node is Red then both of its children are Black.</li>
<li>For each Node, all simple paths from the node to descendant leaves contain the same number of Black Nodes.</li>
</ol>
<p>
When the properties are true the height of a tree with <b>n</b> nodes is \(O(\log(n))\).
</p>
</div>
</div>
<div id="outline-container-orgd74db41" class="outline-3">
<h3 id="orgd74db41">What's the deal with the Nil Leaves?</h3>
<div class="outline-text-3" id="text-orgd74db41">
<p>
CLRS define the leaves of a binary tree as Nil values (not the end nodes with keys like I tend to do) and for Red-Black Trees, unlike Binary Search Trees they use a special Node object that is colored Black and has arbitrary values for the other attributes. To save space the Nil Node is a singleton and besides being used as the leaves it also is the parent of the root.
</p>
</div>
</div>

<div id="outline-container-org9e0e996" class="outline-3">
<h3 id="org9e0e996">Anything Else?</h3>
<div class="outline-text-3" id="text-org9e0e996">
<p>
One last bit of terminology: the <b>Black-Height</b> of a node is the count of the Black Nodes on a simple path from the node to a leaf, not counting the node itself but counting the leaf. This is basically a name for property five of the Red-Black Properties.
</p>
</div>
</div>
</div>
<div id="outline-container-org5eaeacf" class="outline-2">
<h2 id="org5eaeacf">The Posts</h2>
<div class="outline-text-2" id="text-org5eaeacf">
<ul class="org-ul">
<li><a href="posts/the-red-black-tree/">The Red-Black Tree</a></li>
</ul>
</div>
</div>
<div id="outline-container-org5977b3a" class="outline-2">
<h2 id="org5977b3a">Sources</h2>
<div class="outline-text-2" id="text-org5977b3a">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search-tree-randomized/" class="u-url">Binary Search Tree: Randomized</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search-tree-randomized/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-16T17:59:09-07:00" itemprop="datePublished" title="2022-03-16 17:59">2022-03-16 17:59</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/binary-search-tree-randomized/#org33df8dc">Introduction</a>
<ul>
<li><a href="posts/binary-search-tree-randomized/#org7f6a77d">Imports and Setup</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search-tree-randomized/#orga3c496d">Some Illustrative Cases</a>
<ul>
<li><a href="posts/binary-search-tree-randomized/#orgad2f05b">Added In Sorted Order</a></li>
<li><a href="posts/binary-search-tree-randomized/#org809f267">A More Balanced Tree</a></li>
<li><a href="posts/binary-search-tree-randomized/#orgf4b3b2f">Something In Between</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search-tree-randomized/#org43d969a">An Empirical Check</a>
<ul>
<li><a href="posts/binary-search-tree-randomized/#orgd696643">Height vs Nodes</a></li>
<li><a href="posts/binary-search-tree-randomized/#orgf905700">Node Distribution</a></li>
</ul>
</li>
<li><a href="posts/binary-search-tree-randomized/#org546eec6">Sources</a></li>
</ul>
</div>
</div>
<p>
This is the next post in a series on Binary Search Trees that start with <a href="posts/binary-search-trees/">this post</a>. In this post we'll be looking at tree-heights when you randomize the order that the nodes are inserted into the tree.
</p>
<div id="outline-container-org33df8dc" class="outline-2">
<h2 id="org33df8dc">Introduction</h2>
<div class="outline-text-2" id="text-org33df8dc">
<p>
We now have a basic Binary Search Tree and some methods to build and query it. I didn't really go over it but if you look at the basic <a href="posts/binary-search-tree-queries/">querying methods</a> (search, min, max, etc.) you can see that they boil down to starting at a node (often the root) and then traversing up or down the levels of the tree until we find what we want or we reach a leaf. This means that at most the number of comparisons you make (everytime you reach a node you compare the node's key to your key to pick a child to follow) will be the height of tree (<b>h</b>).
</p>

<p>
The height of the tree depends, however, on the order in which you insert and delete the nodes. If you insert them in ascending order, for instance, you end up with all the nodes being right children and a height of <b>n - 1</b> (the number of edges). But, <a href="posts/clrs/">CLRS</a> shows that if you randomize the insertion you will, on average have a height of \(O(\lg(n))\) so I'm going to take an experimental look at that here.
</p>
</div>

<div id="outline-container-org7f6a77d" class="outline-3">
<h3 id="org7f6a77d">Imports and Setup</h3>
<div class="outline-text-3" id="text-org7f6a77d">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>

<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">networkx</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Node</span><span class="p">,</span> <span class="n">Query</span><span class="p">,</span> <span class="n">Tree</span><span class="p">)</span>

<span class="c1"># monkey projects</span>
<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
<span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"binary-search-tree-randomized"</span>
<span class="n">GRAPH_OUTPUT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">"files/posts/</span><span class="si">{</span><span class="n">SLUG</span><span class="si">}</span><span class="s2">/"</span><span class="p">)</span>
<span class="n">ALTAIR_OUTPUT</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="n">SLUG</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">GRAPH_OUTPUT</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
    <span class="n">GRAPH_OUTPUT</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">ALTAIR_OUTPUT</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preorder</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Build the adjancency dictionary</span>

<span class="sd">    Args:</span>
<span class="sd">     node: the next node to add</span>
<span class="sd">     adjacencies: dictionary of key: adjacent node keys</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">left</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
	<span class="n">right</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
	<span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)):</span>
	    <span class="k">if</span> <span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
	    <span class="k">elif</span> <span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">right</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="p">)</span>
	    <span class="k">else</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">right</span><span class="p">,)</span>
	<span class="n">preorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
	<span class="n">preorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orga3c496d" class="outline-2">
<h2 id="orga3c496d">Some Illustrative Cases</h2>
<div class="outline-text-2" id="text-orga3c496d">
</div>
<div id="outline-container-orgad2f05b" class="outline-3">
<h3 id="orgad2f05b">Added In Sorted Order</h3>
<div class="outline-text-3" id="text-orgad2f05b">
<p>
This is our worst-case where the nodes after the root all end up as right-children and the height is <b>n - 1</b>.
</p>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">adjacencies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">preorder</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">nx_pydot</span><span class="o">.</span><span class="n">to_pydot</span><span class="p">(</span><span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">adjacencies</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">GRAPH_OUTPUT</span><span class="o">/</span><span class="s2">"first_tree.png"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/binary-search-tree-randomized/first_tree.png" alt="nil"></p>

<p>
If it were in reversed order we'd get a similar graph but the children would all be on the left and in the reverse order, but since graphviz/dot doesn't show left vs right it'd be hard to see what's going on.
</p>
</div>
</div>
<div id="outline-container-org809f267" class="outline-3">
<h3 id="org809f267">A More Balanced Tree</h3>
<div class="outline-text-3" id="text-org809f267">
<p>
This would be the best case, where the nodes are evenly balanced across the tree. Even though we have more nodes than the prior tree we only have a height of two.
</p>
<div class="highlight"><pre><span></span><span class="n">KEYS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">KEYS</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">KEYS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

<span class="n">adjacencies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">preorder</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">nx_pydot</span><span class="o">.</span><span class="n">to_pydot</span><span class="p">(</span><span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">adjacencies</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">GRAPH_OUTPUT</span><span class="o">/</span><span class="s2">"second_tree.png"</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

<p>
<img src="posts/binary-search-tree-randomized/second_tree.png" alt="nil"></p>
</div>
</div>
<div id="outline-container-orgf4b3b2f" class="outline-3">
<h3 id="orgf4b3b2f">Something In Between</h3>
<div class="outline-text-3" id="text-orgf4b3b2f">
<p>
If we insert the nodes in random order then we would expect to see something better than the worst case but not a perfectly balanced tree either.
</p>
<div class="highlight"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">KEYS</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">KEYS</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">KEYS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

<span class="n">adjacencies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">preorder</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">nx_pydot</span><span class="o">.</span><span class="n">to_pydot</span><span class="p">(</span><span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">adjacencies</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">GRAPH_OUTPUT</span><span class="o">/</span><span class="s2">"third_tree.png"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/binary-search-tree-randomized/third_tree.png" alt="nil"></p>
</div>
</div>
</div>
<div id="outline-container-org43d969a" class="outline-2">
<h2 id="org43d969a">An Empirical Check</h2>
<div class="outline-text-2" id="text-org43d969a">
</div>
<div id="outline-container-orgd696643" class="outline-3">
<h3 id="orgd696643">Height vs Nodes</h3>
<div class="outline-text-3" id="text-orgd696643">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">heights</span><span class="p">(</span><span class="n">keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""Builds the binary tree from the nodes and gets height</span>

<span class="sd">    Args:</span>
<span class="sd">     nodes: list of keys for nodes</span>

<span class="sd">    Returns:</span>
<span class="sd">     (number of nodes, height)</span>
<span class="sd">    """</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
	<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">),</span> <span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">things_to_sort</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
		  <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">height_vs_count</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
	<span class="n">delayed</span><span class="p">(</span><span class="n">heights</span><span class="p">)(</span><span class="n">thing_to_sort</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">thing_to_sort</span> <span class="ow">in</span> <span class="n">things_to_sort</span>
    <span class="p">)</span>
</pre></div>

<pre class="example">
Started: 2022-03-17 20:17:02.325084
Ended: 2022-03-17 20:17:30.486929
Elapsed: 0:00:28.161845
</pre>


<div class="highlight"><pre><span></span><span class="n">NODES</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">unzipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">height_vs_count</span><span class="p">))</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Nodes"</span><span class="p">:</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">NODES</span><span class="p">],</span>
			  <span class="s2">"Height"</span><span class="p">:</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">HEIGHT</span><span class="p">]})</span>
<span class="n">frame</span><span class="p">[</span><span class="s2">"3Log2"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s2">"Nodes"</span><span class="p">])</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Nodes"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Height"</span><span class="p">,</span>
    <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Nodes"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	       <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Height"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">)]</span>
<span class="p">)</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"#feb236"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Nodes"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"3Log2"</span><span class="p">,</span>
    <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Nodes"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	       <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"3Log2"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Randomized Binary Search Tree Node Count vs Height"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"nodes-vs-height"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/binary-search-tree-randomized/nodes-vs-height.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
So it looks like when you insert the nodes randomly you tend to get a tree height that's \(O(\log(n))\).
</p>
</div>
</div>
<div id="outline-container-orgf905700" class="outline-3">
<h3 id="orgf905700">Node Distribution</h3>
<div class="outline-text-3" id="text-orgf905700">
<div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">urn</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>
<span class="n">samples</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"log2(</span><span class="si">{</span><span class="n">nodes</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">things_to_sort</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">urn</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nodes</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>

<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">height_distribution</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
	<span class="n">delayed</span><span class="p">(</span><span class="n">heights</span><span class="p">)(</span><span class="n">thing_to_sort</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">thing_to_sort</span> <span class="ow">in</span> <span class="n">things_to_sort</span>
    <span class="p">)</span>
</pre></div>

<pre class="example">
log2(10000) = 13.287712379549449
Started: 2022-03-17 21:15:42.270315
Ended: 2022-03-17 21:16:32.620183
Elapsed: 0:00:50.349868
</pre>


<div class="highlight"><pre><span></span><span class="n">NODES</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">unzipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">height_distribution</span><span class="p">))</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Nodes"</span><span class="p">:</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">NODES</span><span class="p">],</span>
			  <span class="s2">"Height"</span><span class="p">:</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">HEIGHT</span><span class="p">]})</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

<span class="n">histogram</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"#50586C"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Height"</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"count()"</span><span class="p">,</span> <span class="n">tooltip</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Height"</span><span class="p">))</span>

<span class="n">median</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"#DCE2F0"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"mean(Height):Q"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"mean(Height)"</span><span class="p">))</span>

<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span><span class="n">histogram</span> <span class="o">+</span> <span class="n">median</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Randomized Binary Search Tree Height Distribution (</span><span class="si">{</span><span class="n">nodes</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> Nodes)"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"height-distribution"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/binary-search-tree-randomized/height-distribution.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>


<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Median: </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">Height</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Min: </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">Height</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Max: </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">Height</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"3 x log2(n): </span><span class="si">{</span><span class="mi">3</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
Median: 30.0
Min: 24
Max: 40
3 x log2(n): 39.86
</pre>


<p>
So, with our evenly ranged inputs, even though in the worst case we could have ended up with a tree with a height of 10,000, by inserting the nodes in random order it turns out that most of the time it has a height of 30 and in this sample it has a maximum of 40.
</p>
</div>
</div>
</div>
<div id="outline-container-org546eec6" class="outline-2">
<h2 id="org546eec6">Sources</h2>
<div class="outline-text-2" id="text-org546eec6">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search-tree-queries/" class="u-url">Binary Search Tree Queries</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search-tree-queries/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-14T14:47:08-07:00" itemprop="datePublished" title="2022-03-14 14:47">2022-03-14 14:47</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/binary-search-tree-queries/#org8c57566">A Query Class</a></li>
<li>
<a href="posts/binary-search-tree-queries/#org98d6af6">Search</a>
<ul>
<li><a href="posts/binary-search-tree-queries/#org69a5b1e">The Algorithm</a></li>
<li><a href="posts/binary-search-tree-queries/#org10a4bda">The Iterative Version</a></li>
<li>
<a href="posts/binary-search-tree-queries/#org0e76ece">The Implementation</a>
<ul>
<li><a href="posts/binary-search-tree-queries/#org21bb98f">Testing</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/binary-search-tree-queries/#orgc1a50e0">Miminum and Maximum</a>
<ul>
<li>
<a href="posts/binary-search-tree-queries/#orgdd942e5">Mimimum</a>
<ul>
<li><a href="posts/binary-search-tree-queries/#org54cc9cd">The Implementation</a></li>
<li><a href="posts/binary-search-tree-queries/#orgf2c4f51">Testing</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search-tree-queries/#org14398e4">Maximum</a>
<ul>
<li><a href="posts/binary-search-tree-queries/#orgfdbc986">The Implementation</a></li>
<li><a href="posts/binary-search-tree-queries/#org4bed782">Testing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/binary-search-tree-queries/#orgc32540c">Tree Successor</a></li>
<li><a href="posts/binary-search-tree-queries/#orgefb8adb">Tree Predecessor</a></li>
<li><a href="posts/binary-search-tree-queries/#org90232e4">Height</a></li>
<li><a href="posts/binary-search-tree-queries/#orga25ed93">Sources</a></li>
</ul>
</div>
</div>
<p>
This is the next post in a series on Binary Search Trees that start with <a href="posts/binary-search-trees/">this post</a>. In this post we'll look at some basic queries we can make using the tree.
</p>

<div id="outline-container-org8c57566" class="outline-2">
<h2 id="org8c57566">A Query Class</h2>
<div class="outline-text-2" id="text-org8c57566">
<p>
The textbook(s) treat these as functions, but they seem to suggest to me methods of a class, so I'll make one. The <code>TYPE_CHECKING</code> and <code>annotations</code> imports are to prevent circular imports as noted on <a href="https://adamj.eu/tech/2021/05/13/python-type-hints-how-to-fix-circular-imports/">Adam Johnson's blog</a>.
</p>

<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="c1"># this project</span>
<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.node</span> <span class="kn">import</span> <span class="n">Node</span>
    <span class="kn">from</span> <span class="nn">.tree</span> <span class="kn">import</span> <span class="n">Tree</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Query</span><span class="p">:</span>
    <span class="sd">"""Holds a tree and performs queries on it</span>

<span class="sd">    Args:</span>
<span class="sd">     tree: A Binary Search Tree</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span>
	<span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org98d6af6" class="outline-2">
<h2 id="org98d6af6">Search</h2>
<div class="outline-text-2" id="text-org98d6af6">
<p>
The first thing we'll look at is searching for a Node in a Binary Search Tree. Because of the way the tree is structured the search looks a lot like a <a href="posts/binary-search/">Binary Search</a> where we start at the root of the tree and then work our way downwards, picking the next child to follow based on whether the key we're searching for is greater than the right child's key or less than the left child's key. If it's equal then we've found the node we want.
</p>
</div>

<div id="outline-container-org69a5b1e" class="outline-3">
<h3 id="org69a5b1e">The Algorithm</h3>
<div class="outline-text-3" id="text-org69a5b1e">
<pre id="tree-search" style="display:hidden;">
\begin{algorithm}
\caption{TreeSearch}
\begin{algorithmic}
\INPUT The Node to start searching from and the key to search for.
\OUTPUT If a node with the key is in the tree, then it will output the node.
\PROCEDURE{TreeSearch}{x, key}
\IF {\textit{x} = \textsc{NIL} or key = \textit{x}.key}
  \RETURN \textit{x}
\ENDIF

\IF {key &lt; \textit{x}.key}
    \RETURN \textsc{TreeSearch}(\textit{x}.left, key)
\ELSE
    \RETURN \textsc{TreeSearch}(\textit{x}.right, key)
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>
<div id="outline-container-org10a4bda" class="outline-3">
<h3 id="org10a4bda">The Iterative Version</h3>
<div class="outline-text-3" id="text-org10a4bda">
<p>
The recursive version of <code>TreeSearch</code> is quite nice, but it also translates easily to an iterative version if for some reason performance or size becomes a problem.
</p>

<pre id="iterative-tree-search" style="display:hidden;">
\begin{algorithm}
\caption{IterativeTreeSearch}
\begin{algorithmic}
\INPUT The Node to start searching from and the key to search for.
\OUTPUT If a node with the key is in the tree, then it will output the node.
\PROCEDURE{IterativeTreeSearch}{x, key}
\WHILE {\textit{x} $\neq$ \textsc{NIL} and key $\neq$ \textit{x}.key}
  \IF {key &lt; \textit{x}.key}
   \STATE \textit{x} $\gets$ \textit{x}.left
  \ELSE
   \STATE \textit{x} $\gets$ \textit{x}.right
  \ENDIF
\ENDWHILE
\RETURN \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>
<div id="outline-container-org0e76ece" class="outline-3">
<h3 id="org0e76ece">The Implementation</h3>
<div class="outline-text-3" id="text-org0e76ece">
<p>
I'll add the iterative version of the Tree Search as a method for our Query class.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Searches the tree for the node with the matching key</span>

<span class="sd">    Args:</span>
<span class="sd">     key: node's key to search for</span>

<span class="sd">    Returns:</span>
<span class="sd">     the node with the key or None if it isn't in the tree</span>
<span class="sd">    """</span>
    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span>
    <span class="k">while</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
	<span class="k">if</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
	    <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span>
	<span class="k">else</span><span class="p">:</span>
	   <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span>
    <span class="k">return</span> <span class="n">node</span>
</pre></div>
</div>
<div id="outline-container-org21bb98f" class="outline-4">
<h4 id="org21bb98f">Testing</h4>
<div class="outline-text-4" id="text-org21bb98f">
<div class="highlight"><pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">be</span><span class="p">,</span><span class="n">be_none</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Tree</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree</span> <span class="kn">import</span> <span class="n">Query</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>

<span class="n">five</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">five</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">five</span><span class="p">))</span>

<span class="n">fifteen</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">fifteen</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">fifteen</span><span class="p">))</span>
</pre></div>

<p>
I'll have to think of something more interesting to show for thisâ€¦
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc1a50e0" class="outline-2">
<h2 id="orgc1a50e0">Miminum and Maximum</h2>
<div class="outline-text-2" id="text-orgc1a50e0">
</div>
<div id="outline-container-orgdd942e5" class="outline-3">
<h3 id="orgdd942e5">Mimimum</h3>
<div class="outline-text-3" id="text-orgdd942e5">
<pre id="tree-minimum" style="display:hidden;">
\begin{algorithm}
\caption{TreeMinimum}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the smallest key.
\PROCEDURE{TreeMinimum}{x}
\WHILE {\textit{x}.left $\neq$ \textsc{NIL}}
   \STATE \textit{x} $\gets$ \textit{x}.left
\ENDWHILE
\RETURN \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>

<div id="outline-container-org54cc9cd" class="outline-4">
<h4 id="org54cc9cd">The Implementation</h4>
<div class="outline-text-4" id="text-org54cc9cd">
<p>
I originally didn't take the root node as an argument, since I thought the minimum of the tree is always the smallest item. But this method gets used later on in the <code>successor</code> method where we want to find the smallest item in the right-subtree of a particular node, so the outcome won't necessarily be the smallest item in the tree.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the node with the smallest key</span>

<span class="sd">    Args:</span>
<span class="sd">     node: a node to use as the starting root</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span>

    <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span>
    <span class="k">return</span> <span class="n">node</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgf2c4f51" class="outline-4">
<h4 id="orgf2c4f51">Testing</h4>
<div class="outline-text-4" id="text-orgf2c4f51">
<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org14398e4" class="outline-3">
<h3 id="org14398e4">Maximum</h3>
<div class="outline-text-3" id="text-org14398e4">
<pre id="tree-maximum" style="display:hidden;">
\begin{algorithm}
\caption{TreeMaximum}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the largest key.
\PROCEDURE{TreeMaximum}{x}
\WHILE {\textit{x}.right $\neq$ \textsc{NIL}}
   \STATE \textit{x} $\gets$ \textit{x}.right
\ENDWHILE
\RETURN \textit{x}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>

<div id="outline-container-orgfdbc986" class="outline-4">
<h4 id="orgfdbc986">The Implementation</h4>
<div class="outline-text-4" id="text-orgfdbc986">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the node with the largest key</span>

<span class="sd">    Args:</span>
<span class="sd">     root: subtree root to start at</span>

<span class="sd">    Returns:</span>
<span class="sd">     node with the largest key in tree/subtree</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span>
    <span class="k">while</span> <span class="n">root</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">right</span>
    <span class="k">return</span> <span class="n">root</span>
</pre></div>
</div>
</div>
<div id="outline-container-org4bed782" class="outline-4">
<h4 id="org4bed782">Testing</h4>
<div class="outline-text-4" id="text-org4bed782">
<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc32540c" class="outline-2">
<h2 id="orgc32540c">Tree Successor</h2>
<div class="outline-text-2" id="text-orgc32540c">
<p>
A "Successor" node is the next largest node after a given node. Since all the nodes in a right subtree are greater than the node, it's the smallest node in the right (if it exists). If the right subtree is empty then we traverse up the ancestors of the node until we find the first one that is greater than our node.
</p>

<pre id="tree-successor" style="display:hidden;">
\begin{algorithm}
\caption{TreeSuccessor}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the next largest key.
\PROCEDURE{TreeSuccessor}{x}
\IF {\textit{x}.right $\neq$ \textsc{NIL}}
  \RETURN \textsc{TreeMinimum}(\textit{x}.right)
\ENDIF

\STATE \textit{y} $\gets$ \textit{x}.parent

\WHILE {\textit{y} $\neq$ \textsc{NIL} and \textit{x} = \textit{y}.right}
   \STATE \textit{x} $\gets$ \textit{y}
   \STATE \textit{y} $\gets$ \textit{y}.parent
\ENDWHILE
\RETURN \textit{y}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">successor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the next largest node</span>

<span class="sd">    Args:</span>
<span class="sd">     node: the node who's successor to find</span>

<span class="sd">    Returns:</span>
<span class="sd">     successor node to the input node</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>

    <span class="n">successor</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">while</span> <span class="n">successor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node</span> <span class="o">==</span> <span class="n">successor</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
	<span class="n">node</span> <span class="o">=</span> <span class="n">successor</span>
	<span class="n">successor</span> <span class="o">=</span> <span class="n">successor</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">return</span> <span class="n">successor</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">successor</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgefb8adb" class="outline-2">
<h2 id="orgefb8adb">Tree Predecessor</h2>
<div class="outline-text-2" id="text-orgefb8adb">
<p>
Similar in concept to a node successor, a node <i>predecessor</i> is the largest node less than the given node.
</p>

<pre id="tree-predecessor" style="display:hidden;">
\begin{algorithm}
\caption{TreePredecessor}
\begin{algorithmic}
\INPUT The Node to start the search from.
\OUTPUT The Node with the next smallest key.
\PROCEDURE{TreePredecessor}{x}
\IF {\textit{x}.left $\neq$ \textsc{NIL}}
  \RETURN \textsc{TreeMaximum}(\textit{x}.right)
\ENDIF

\STATE \textit{y} $\gets$ \textit{x}.parent

\WHILE {\textit{y} $\neq$ \textsc{NIL} and \textit{x} = \textit{y}.left}
   \STATE \textit{x} $\gets$ \textit{y}
   \STATE \textit{y} $\gets$ \textit{y}.parent
\ENDWHILE
\RETURN \textit{y}
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predecessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""Returns the predecessor node</span>

<span class="sd">    Args:</span>
<span class="sd">     node: the node whose predecessor we want</span>

<span class="sd">    Returns:</span>
<span class="sd">     largest node smaller than given node</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="n">predecessor</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">while</span> <span class="n">predecessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node</span> <span class="o">==</span> <span class="n">predecessor</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
	<span class="n">node</span><span class="p">,</span> <span class="n">predecessor</span> <span class="o">=</span> <span class="n">predecessor</span><span class="p">,</span> <span class="n">predecessor</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">return</span> <span class="n">predecessor</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">predecessor</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org90232e4" class="outline-2">
<h2 id="org90232e4">Height</h2>
<div class="outline-text-2" id="text-org90232e4">
<p>
The height of the Binary Search Tree is the number of edges from the root of the tree to the furthest node. The algorithms we're looking at here don't use them but I'm going to use height to look at how the order you insert nodes in the tree affects the height. 
</p>

<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""The length of the longest path starting at the root</span>

<span class="sd">    Returns:</span>
<span class="sd">     number of edges from root to furthest leaf</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_height</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tree_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""The length of the longest path starting at the node</span>

<span class="sd">    Args:</span>
<span class="sd">     the node to start the measurement from</span>

<span class="sd">    Returns:</span>
<span class="sd">     number of edges from root to furthest leaf</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_height</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_height</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orga25ed93" class="outline-2">
<h2 id="orga25ed93">Sources</h2>
<div class="outline-text-2" id="text-orga25ed93">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-search"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("iterative-tree-search"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-minimum"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-maximum"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-successor"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("tree-predecessor"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search-tree-node-insertion/" class="u-url">Binary Search Tree Node Insertion</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search-tree-node-insertion/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-12T15:23:47-08:00" itemprop="datePublished" title="2022-03-12 15:23">2022-03-12 15:23</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/binary-search-tree-node-insertion/#org80b70cd">The Tree</a>
<ul>
<li><a href="posts/binary-search-tree-node-insertion/#org7cc8d42">The Query</a></li>
<li><a href="posts/binary-search-tree-node-insertion/#org67a0bb2">The Insertion Algorithm</a></li>
<li><a href="posts/binary-search-tree-node-insertion/#orgdccee9b">The Insert Method</a></li>
<li><a href="posts/binary-search-tree-node-insertion/#orge78bd29">Transplant</a></li>
<li><a href="posts/binary-search-tree-node-insertion/#orgb9add5d">Deletion</a></li>
</ul>
</li>
<li><a href="posts/binary-search-tree-node-insertion/#org406833d">Plotting</a></li>
<li><a href="posts/binary-search-tree-node-insertion/#orga268c66">Sources</a></li>
</ul>
</div>
</div>
<p>
This is the next post in a series on Binary Search Trees that start with <a href="posts/binary-search-trees/">this post</a>. In this post we'll be looking at creating a Tree class and the method of inserting a node into the tree.
</p>

<div id="outline-container-org80b70cd" class="outline-2">
<h2 id="org80b70cd">The Tree</h2>
<div class="outline-text-2" id="text-org80b70cd">
<p>
Although <a href="posts/clrs/">CLRS</a> use a <b>T</b> (as in tree) class in their algorithms, they only use it to store a <b>root</b> attribute. To make it a little more object-oriented I'll create a Tree class and add the <code>insert</code> method to it, rather than passing the tree to a function. Not a big change, but one that might be useful.
</p>

<p>
<img src="posts/binary-search-tree-node-insertion/tree.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">.query</span> <span class="kn">import</span> <span class="n">Query</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Tree</span><span class="p">:</span>
    <span class="sd">"""Binary Search Tree</span>

<span class="sd">    Args:</span>
<span class="sd">     root: the root node for the tree</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_query</span> <span class="o">=</span> <span class="kc">None</span>        
	<span class="k">return</span>
</pre></div>
</div>

<div id="outline-container-org7cc8d42" class="outline-3">
<h3 id="org7cc8d42">The Query</h3>
<div class="outline-text-3" id="text-org7cc8d42">
<p>
We have kind of a chicken and the egg problem here in that I defined the Query to contain the Tree, but we need to use its <code>min</code> function to delete nodes. We'll see how it goes.
</p>

<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""A Tree Query"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span>
</pre></div>
</div>
</div>
<div id="outline-container-org67a0bb2" class="outline-3">
<h3 id="org67a0bb2">The Insertion Algorithm</h3>
<div class="outline-text-3" id="text-org67a0bb2">
<p>
This is the <a href="posts/clrs/">CLRS</a> insert algorithm. As I noted above they consider it a function, rather than a method of the tree.
</p>

<p>
One thing that tripped me up initially was the term "insert". I thought that it would put the new node in between existing nodes, but it instead adds it as a leaf. The job of the algorithm is to find the correct leaf to add the new node to and which side to put it on (left or right).
</p>

<pre id="insert-node" style="display:hidden;">
\begin{algorithm}
\caption{Insert Node}
\begin{algorithmic}

\INPUT Tree and Node to insert.
\PROCEDURE{TreeInsert}{\textit{T, z}}

\STATE \textit{y} $\gets$ \textsc{NIL}
\STATE \textit{x} $\gets$ T.root

\WHILE {\textit{x} $\neq$ \textsc{NIL}}
 \STATE \textit{y} = \textit{x}
 \IF {\textit{z}.key &lt; \textit{x}.key}
   \STATE \textit{x} $\gets$ \textit{x}.left
 \ELSE
   \STATE \textit{x} $\gets$ \textit{x}.right
 \ENDIF
\ENDWHILE
\STATE
\STATE \textit{z}.parent $\gets$ \textit{y}
\STATE
\IF {\textit{y} = \textsc{NIL}} 
 \STATE T.root $\gets$ \textit{z}
\ELIF {\textit{z}.key &lt; \textit{y}.key}
  \STATE \textit{y}.left $\gets$ \textit{z}
\ELSE
  \STATE \textit{y}.right $\gets$ \textit{z}
\ENDIF

\ENDPROCEDURE

\end{algorithmic}
\end{algorithm}
</pre>

<p>
What we have here is sort of a hunter and hound scenario. The hunter <code>y</code> is pulled along by the hound <code>x</code> as the hound chases down the path to find the spot for the new node. Once the hound falls into the spot where there's no node, the hunter is in the location of the leaf that should be the new node's parent and the hound is where the new node should be inserted.
</p>
</div>
</div>

<div id="outline-container-orgdccee9b" class="outline-3">
<h3 id="orgdccee9b">The Insert Method</h3>
<div class="outline-text-3" id="text-orgdccee9b">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Insert the node as a new leaf in the tree</span>

<span class="sd">    Args:</span>
<span class="sd">     node: a node to insert into the tree</span>
<span class="sd">    """</span>
    <span class="n">hunter</span><span class="p">,</span> <span class="n">hound</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>

    <span class="k">while</span> <span class="n">hound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">hunter</span><span class="p">,</span> <span class="n">hound</span> <span class="o">=</span> <span class="n">hound</span><span class="p">,</span> <span class="n">hound</span><span class="o">.</span><span class="n">left</span> <span class="k">if</span> <span class="n">node</span> <span class="o">&lt;</span> <span class="n">hound</span> <span class="k">else</span> <span class="n">hound</span><span class="o">.</span><span class="n">right</span>

    <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">hunter</span>

    <span class="k">if</span> <span class="n">hunter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">node</span>
    <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;</span> <span class="n">hunter</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
	<span class="n">hunter</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">node</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">hunter</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">node</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree.tree</span> <span class="kn">import</span> <span class="n">Tree</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orge78bd29" class="outline-3">
<h3 id="orge78bd29">Transplant</h3>
<div class="outline-text-3" id="text-orge78bd29">
<p>
This is an implementation of what CLRS calls <code>Transplant</code> (although I kind of think <code>replace</code> might be more to the point) where we are given two nodes - one to remove from the tree and the other to take its place. It might not seem obvious by itself why you would need it but it's used when you delete nodes.
</p>

<pre id="transplant-node" style="display:hidden;">
\begin{algorithm}
\caption{Transplant Node}
\begin{algorithmic}

\INPUT Tree, Node to replace, Node to insert.
\PROCEDURE{Transplant}{\textit{T, u, v}}

\IF {\textit{u}.parent = \textsc{NIL}}
  \STATE \textit{T}.root $\gets$ \textsc{v}
\ELIF {\textit{u} = \textit{u}.parent.left}
  \STATE \textit{u}.parent.left = \textit{v}
 \ELSE
   \STATE \textit{u}.parent.right $\gets$ \textit{v}
 \ENDIF

\IF {\textit{v} $\neq$ \textsc{NIL}} 
 \STATE \textit{v}.parent $\gets$ \textit{u}.parent
\ENDIF

\ENDPROCEDURE

\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">transplant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_be_replaced</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">replacement</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Replace node with another</span>

<span class="sd">    Args:</span>
<span class="sd">     to_be_replaced: current holder of the position to be replaced</span>
<span class="sd">     replacement: node to replace the incumbent</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">to_be_replaced</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">replacement</span>
    <span class="k">elif</span> <span class="n">to_be_replaced</span> <span class="o">==</span> <span class="n">to_be_replaced</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
	<span class="n">to_be_replaced</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">replacement</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">to_be_replaced</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">replacement</span>

    <span class="k">if</span> <span class="n">replacement</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">replacement</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">to_be_replaced</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">transplant</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">666</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">transplant</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">transplant</span><span class="p">))</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">lefty</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">lefty</span><span class="p">)</span>

<span class="c1"># the transplant doesn't check the Binary Search Tree Property</span>
<span class="c1"># before doing its thing so we have to make sure our transplant</span>
<span class="c1"># is less than the parent when setting the left node</span>
<span class="n">smaller_transplant</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">lefty</span><span class="p">,</span> <span class="n">smaller_transplant</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">lefty</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">smaller_transplant</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">smaller_transplant</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">lefty</span><span class="o">.</span><span class="n">parent</span><span class="p">))</span>

<span class="c1"># similarly we need to make sure the right transplant is bigger</span>
<span class="n">righty</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">righty</span><span class="p">)</span>
<span class="n">bigger_transplant</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">righty</span><span class="p">,</span> <span class="n">bigger_transplant</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">righty</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">bigger_transplant</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">righty</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">bigger_transplant</span><span class="o">.</span><span class="n">parent</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgb9add5d" class="outline-3">
<h3 id="orgb9add5d">Deletion</h3>
<div class="outline-text-3" id="text-orgb9add5d">
<p>
The uses for the <code>transplant</code> method might seem a little obscure, but it's a necessary function for our <code>delete</code> method to delete a node from the tree. There are three cases (four-ish really) to take care of:
</p>

<ol class="org-ol">
<li>The node to delete has no left child: transplant the right child with the node</li>
<li>The node to delete has no right child: transplant the left child with the node</li>
<li>The node to delete has both children: transplant the children with the node</li>
</ol>
<pre id="delete-node" style="display:hidden;">
\begin{algorithm}
\caption{Delete Node}
\begin{algorithmic}

\INPUT Tree, Node to delete.
\PROCEDURE{Delete}{\textit{T, z}}
\IF {\textit{z}.left = \textsc{NIL}}
  \STATE \textsc{Transplant}(\textit{T, z, z.right})
\ELIF {\textit{z}.right = \textsc{NIL}}
  \STATE \textsc{Transplant}(\textit{T, z, z.left})
\ELSE
   \STATE \textit{y} $\gets$ \textsc{TreeMinimum}(\textit{z}.right)
   \IF {\textit{y}.parent $\neq$ \textit{z}}
     \STATE \textsc{Transplant}(\textit{T, y, y.right})
     \STATE \textit{y}.right $\gets$ \textit{z}.right
     \STATE \textit{y}.right.parent $\gets$ \textit{y}
   \ENDIF

  \STATE \textsc{Transplant}(\textit{T, z, y})
  \STATE \textit{y}.left $\gets$ \textit{z}.left
  \STATE \textit{y}.left.parent $\gets$ \textit{y}
\ENDIF
\ENDPROCEDURE

\end{algorithmic}
\end{algorithm}
</pre>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Remove the node from the tree</span>

<span class="sd">    Args:</span>
<span class="sd">     node: node to remove from the tree</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">replacement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">replacement</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="n">node</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">replacement</span><span class="p">,</span> <span class="n">replacement</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
	    <span class="n">replacement</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span>
	    <span class="n">replacement</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">replacement</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">replacement</span><span class="p">)</span>
	<span class="n">replacement</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span>
	<span class="n">replacement</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">replacement</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">child</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">child</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">child</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">child</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">child</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">child</span><span class="p">))</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">child</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org406833d" class="outline-2">
<h2 id="org406833d">Plotting</h2>
<div class="outline-text-2" id="text-org406833d">
<div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="n">adjacencies</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">inorder</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Traverse the nodes and build an adjancency dictionary</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">inorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
	<span class="n">left</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span> <span class="k">else</span> <span class="kc">None</span>
	<span class="n">right</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span> <span class="k">else</span> <span class="kc">None</span>
	<span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)):</span>
	    <span class="k">if</span> <span class="n">left</span> <span class="ow">and</span> <span class="n">right</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
	    <span class="k">elif</span> <span class="n">left</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="p">)</span>
	    <span class="k">else</span><span class="p">:</span>
		<span class="n">adjacencies</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">right</span><span class="p">,)</span>
	    <span class="n">inorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">adjacencies</span><span class="p">)</span>
    <span class="k">return</span>

<span class="n">inorder</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">adjacencies</span><span class="o">=</span><span class="n">adjacencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adjacencies</span><span class="p">)</span>
</pre></div>

<pre class="example">
{2: (1, 3), 5: (2, 7), 7: (6, 8), 10: (5, 15), 12: (11, 14), 15: (12, 17), 17: (16, 20)}
</pre>


<p>
Now that we have an adjacency list, let's try and plot it.
</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span>

<span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"binary-search-tree-node-insertion"</span>
<span class="n">OUTPUT</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"files/posts/</span><span class="si">{</span><span class="n">SLUG</span><span class="si">}</span><span class="s2">/"</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">adjacencies</span><span class="p">)</span>

<span class="n">pygraph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">nx_pydot</span><span class="o">.</span><span class="n">to_pydot</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="n">pygraph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">OUTPUT</span> <span class="o">+</span> <span class="s2">"first_tree.png"</span><span class="p">)</span>
</pre></div>

<p>
<img src="posts/binary-search-tree-node-insertion/first_tree.png" alt="nil"></p>

<p>
This is sort of an artificial example in that in order to get the plot right I had to insert nodes until they all had two (except the leaves), but it hopefully shows that it works.
</p>
</div>
</div>
<div id="outline-container-orga268c66" class="outline-2">
<h2 id="orga268c66">Sources</h2>
<div class="outline-text-2" id="text-orga268c66">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("insert-node"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("transplant-node"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("delete-node"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search-tree-node/" class="u-url">Binary Search Tree Node</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search-tree-node/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-11T14:19:09-08:00" itemprop="datePublished" title="2022-03-11 14:19">2022-03-11 14:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/binary-search-tree-node/#org7a39b38">The Abstract</a></li>
<li>
<a href="posts/binary-search-tree-node/#orgea99740">The Implementation</a>
<ul>
<li>
<a href="posts/binary-search-tree-node/#org221755b">Properties</a>
<ul>
<li><a href="posts/binary-search-tree-node/#org031acba">Parent</a></li>
<li><a href="posts/binary-search-tree-node/#org1d98c00">Left</a></li>
<li><a href="posts/binary-search-tree-node/#org80483e7">Right</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search-tree-node/#orgc612898">Comparisons</a>
<ul>
<li><a href="posts/binary-search-tree-node/#org664dbe9">Equal</a></li>
<li><a href="posts/binary-search-tree-node/#org213d26b">Less Than</a></li>
<li><a href="posts/binary-search-tree-node/#orgb9c05c6">Less Than or Equal</a></li>
</ul>
</li>
<li><a href="posts/binary-search-tree-node/#orgf7cb253">Check Nodes</a></li>
<li><a href="posts/binary-search-tree-node/#org5838516">String Output</a></li>
<li>
<a href="posts/binary-search-tree-node/#org22d31cf">Testing</a>
<ul>
<li><a href="posts/binary-search-tree-node/#org86ab71e">Imports</a></li>
<li><a href="posts/binary-search-tree-node/#org85e00bf">One Node</a></li>
<li><a href="posts/binary-search-tree-node/#org490d681">Check the Comparisons</a></li>
<li><a href="posts/binary-search-tree-node/#org6a9a4c7">Check the Two-Way Updates.</a></li>
<li><a href="posts/binary-search-tree-node/#org3025f12">The Check Node Method</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/binary-search-tree-node/#org23880fc">Sources</a></li>
</ul>
</div>
</div>
<p>
This is the next post in a series on Binary Search Trees that start with <a href="posts/binary-search-trees/">this post</a>.
</p>

<div id="outline-container-org7a39b38" class="outline-2">
<h2 id="org7a39b38">The Abstract</h2>
<div class="outline-text-2" id="text-org7a39b38">
<p>
As mentioned in the <a href="posts/binary-search-trees/">first post</a>, the Binary Search Tree is a linked structure made up of Nodes that look more or less like this:
</p>

<p>
<img src="posts/binary-search-tree-node/node.png" alt="nil"></p>

<p>
And which maintain the Binary Search Tree Property. I'm going to forego the data field and add a couple of methods to make it more convenient for me, but most of the way this will work will be to pass nodes (particularly the root) to functions.
</p>
</div>
</div>

<div id="outline-container-orgea99740" class="outline-2">
<h2 id="orgea99740">The Implementation</h2>
<div class="outline-text-2" id="text-orgea99740">
<p>
Since I'm using pypy 3.7 there's a problem with the declaration of an attribute of the Node class being a Node object (it isn't defined yet) but according to <a href="https://stackoverflow.com/questions/55320236/does-python-evaluate-type-hinting-of-a-forward-reference">this post on stackoverflow</a> we can import <code>annotations</code> from the future to fix it.
</p>

<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">bowling.types</span> <span class="kn">import</span> <span class="n">Orderable</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="sd">"""A Node in a Binary Search Tree</span>

<span class="sd">    Args:</span>
<span class="sd">     key: item to compare nodes</span>
<span class="sd">     parent: parent of this node</span>
<span class="sd">     left: left child</span>
<span class="sd">     right: right child</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Orderable</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		 <span class="n">left</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">Node</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
	<span class="k">return</span>
</pre></div>
</div>
<div id="outline-container-org221755b" class="outline-3">
<h3 id="org221755b">Properties</h3>
<div class="outline-text-3" id="text-org221755b">
</div>
<div id="outline-container-org031acba" class="outline-4">
<h4 id="org031acba">Parent</h4>
<div class="outline-text-4" id="text-org031acba">
<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""The parent of this node"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

<span class="nd">@parent</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the parent and updates the parent</span>

<span class="sd">    Warning:</span>
<span class="sd">     this will clobber the parent's child if there's a node where this should</span>
<span class="sd">    be</span>

<span class="sd">    Args:</span>
<span class="sd">     parent: to add to self</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if parent and self have same key</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">parent_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent_</span>
	<span class="k">return</span>

    <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">parent_</span><span class="p">:</span>
	<span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Self (</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">) cannot equal parent (</span><span class="si">{</span><span class="n">parent_</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># since the left and right assignments update the parent</span>
    <span class="c1"># we need a hack to get around the setters or you end up</span>
    <span class="c1"># with an infinite loop - we set left, they set parent, we set left,...</span>
    <span class="k">if</span> <span class="bp">self</span> <span class="o">&lt;</span> <span class="n">parent_</span><span class="p">:</span>
	<span class="n">parent_</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">parent_</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent_</span>        
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org1d98c00" class="outline-4">
<h4 id="org1d98c00">Left</h4>
<div class="outline-text-4" id="text-org1d98c00">
<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""The left child"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left</span>

<span class="nd">@left</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_left</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the left and its parent</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if left isn't less than self</span>

<span class="sd">    Args:</span>
<span class="sd">     new_left: a node to be the left child or None</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">new_left</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">new_left</span>
	<span class="k">return</span>

    <span class="k">assert</span> <span class="n">new_left</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Left (</span><span class="si">{</span><span class="n">new_left</span><span class="si">}</span><span class="s2"> not &lt; self </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">)"</span>
    <span class="n">new_left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">new_left</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org80483e7" class="outline-4">
<h4 id="org80483e7">Right</h4>
<div class="outline-text-4" id="text-org80483e7">
<div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
    <span class="sd">"""The right child"""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right</span>

<span class="nd">@right</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_right</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Sets the right and its parent</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError if right isn't greater than self</span>

<span class="sd">    Args:</span>
<span class="sd">     new_right: a node to be the right child or None</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">new_right</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="n">new_right</span>
	<span class="k">return</span>

    <span class="k">assert</span> <span class="n">new_right</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"right (</span><span class="si">{</span><span class="n">new_right</span><span class="si">}</span><span class="s2"> not &gt; self (</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">)"</span>
    <span class="n">new_right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="n">new_right</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgc612898" class="outline-3">
<h3 id="orgc612898">Comparisons</h3>
<div class="outline-text-3" id="text-orgc612898">
<p>
These are convenience methods to make it so that you can compare the node-objects without referring to the key (see the <a href="https://docs.python.org/3/reference/datamodel.html#object.__lt__">python Data Model documentation</a>). In reading the documentation I thought that you had to implement everything, but after implementing <i>less than</i> and <i>less than or equal to</i> the <i>greater than</i> and <i>greater than or equal to</i> comparisons started to work. I guess if you don't implement them they just take the negative of the less than cases.
</p>
</div>

<div id="outline-container-org664dbe9" class="outline-4">
<h4 id="org664dbe9">Equal</h4>
<div class="outline-text-4" id="text-org664dbe9">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""Check if the other node has an equal key</span>

<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>
</pre></div>
</div>
</div>

<div id="outline-container-org213d26b" class="outline-4">
<h4 id="org213d26b">Less Than</h4>
<div class="outline-text-4" id="text-org213d26b">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""See if this key is less than the other's</span>

<span class="sd">    Raises:</span>
<span class="sd">     TypeError: the other thing doesn't have a key</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
	<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"'&lt;' not supported between '</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">' "</span>
			<span class="s2">"and '{type(other)}'"</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgb9c05c6" class="outline-4">
<h4 id="orgb9c05c6">Less Than or Equal</h4>
<div class="outline-text-4" id="text-orgb9c05c6">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""See if this key is less than or equal to other's"""</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
	<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"'&lt;' not supported between '</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">' "</span>
			<span class="s2">"and '{type(other)}'"</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgf7cb253" class="outline-3">
<h3 id="orgf7cb253">Check Nodes</h3>
<div class="outline-text-3" id="text-orgf7cb253">
<p>
This is a convenience method to check if a node and its sub-trees maintain the Binary Search Tree Property. It calls the children too so that the whole tree can be checked by calling this on the root. Now that there's checks when the attributes are set this isn't quite as necessary. The only time you might need it is if the attributes are set directly instead of using the setter.
</p>

<p>
<b><b>Note:</b></b> Although the <i>Binary Search Tree Property</i> allows duplicate keys, once you start doing things with the tree like inserting and deleting nodes it causes problems. Also, it's not likely that the keys are what you would be most interested in when using a tree, it would be the data associated with the node, so what would it mean to have two different items associated with the same key? There are probably uses for this, but to make it simpler I'm going to treat the keys more like dictionary keys and say that it's a mistake to have duplicates.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Checks that the Binary Search Tree Property holds</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError: Binary Search Tree Property violated or duplicates exist</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Node</span><span class="p">,</span>\
	<span class="sa">f</span><span class="s2">"self.parent=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="si">}</span><span class="s2">, type=</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Left: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="si">}</span><span class="s2"> not &lt; Self: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">"</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Right: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="si">}</span><span class="s2"> not &gt; Self: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">"</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-org5838516" class="outline-3">
<h3 id="org5838516">String Output</h3>
<div class="outline-text-3" id="text-org5838516">
<p>
This is to make it a little easier to print.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""The key as a string"""</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-org22d31cf" class="outline-3">
<h3 id="org22d31cf">Testing</h3>
<div class="outline-text-3" id="text-org22d31cf">
<p>
I'll have to break this up later.
</p>
</div>
<div id="outline-container-org86ab71e" class="outline-4">
<h4 id="org86ab71e">Imports</h4>
<div class="outline-text-4" id="text-org86ab71e">
<div class="highlight"><pre><span></span><span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">be_above</span><span class="p">,</span>
    <span class="n">be_above_or_equal</span><span class="p">,</span>
    <span class="n">be_below</span><span class="p">,</span>
    <span class="n">be_below_or_equal</span><span class="p">,</span>
    <span class="n">be_none</span><span class="p">,</span>
    <span class="n">equal</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">,</span>
    <span class="n">raise_error</span>
<span class="p">)</span>

<span class="c1"># software under test</span>
<span class="kn">from</span> <span class="nn">bowling.data_structures.binary_search_tree.node</span> <span class="kn">import</span> <span class="n">Node</span>
</pre></div>
</div>
</div>

<div id="outline-container-org85e00bf" class="outline-4">
<h4 id="org85e00bf">One Node</h4>
<div class="outline-text-4" id="text-org85e00bf">
<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>

<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org490d681" class="outline-4">
<h4 id="org490d681">Check the Comparisons</h4>
<div class="outline-text-4" id="text-org490d681">
<div class="highlight"><pre><span></span><span class="n">uncle</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">9</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_below_or_equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="n">brother</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">brother</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_above</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">brother</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_above_or_equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="c1"># I'm still deciding who's responsible for checking if a node exists</span>
<span class="c1"># for now I'll copy what happens when None is compared to ints</span>
<span class="n">expect</span><span class="p">(</span><span class="n">brother</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">uncle</span><span class="o">.</span><span class="n">parent</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">brother</span> <span class="o">&lt;</span> <span class="n">uncle</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">brother</span><span class="o">.</span><span class="n">parent</span> <span class="o">&gt;</span> <span class="n">uncle</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org6a9a4c7" class="outline-4">
<h4 id="org6a9a4c7">Check the Two-Way Updates.</h4>
<div class="outline-text-4" id="text-org6a9a4c7">
</div>
<ul class="org-ul">
<li>
<a id="org7c40aaa"></a>Set the Parent<br><div class="outline-text-5" id="text-org7c40aaa">
<p>
In the constructor.
</p>
<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bad_parent</span><span class="p">():</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">return</span>

<span class="n">expect</span><span class="p">(</span><span class="n">bad_parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
</pre></div>

<p>
On the object
</p>
<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bad_parent</span><span class="p">():</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="k">return</span>

<span class="n">expect</span><span class="p">(</span><span class="n">bad_parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li>
<a id="org67b9f1a"></a>Set The Left Child<br><div class="outline-text-5" id="text-org67b9f1a">
<div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li>
<a id="org2450181"></a>Set The Right Child<br><div class="outline-text-5" id="text-org2450181">
<div class="highlight"><pre><span></span><span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div id="outline-container-org3025f12" class="outline-4">
<h4 id="org3025f12">The Check Node Method</h4>
<div class="outline-text-4" id="text-org3025f12">
<div class="highlight"><pre><span></span><span class="n">uncle</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>

<span class="c1"># parent is root</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>

<span class="c1"># parent is right child</span>
<span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">uncle</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>

<span class="c1"># parent is left child</span>
<span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">brother</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bad_check</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
    <span class="k">return</span>

<span class="c1"># left node is greater than the parent</span>
<span class="n">lefty</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span> 
    <span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
<span class="n">parent</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad_check</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># left node is less than the parent</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># right node is less than the parent</span>
<span class="n">righty</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">righty</span>
    <span class="k">return</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>
<span class="n">parent</span><span class="o">.</span><span class="n">_right</span> <span class="o">=</span> <span class="n">righty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad_check</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># right and left are okay</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">righty</span>
<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">lefty</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># children of parent's children</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">check_node</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">lefty</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="c1"># disallow duplicates</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">parent</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad_check</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bad</span><span class="p">():</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">bad_check</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span><span class="p">(</span><span class="n">raise_error</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">key</span><span class="p">)))</span>
</pre></div>

<p>
The <a href="posts/binary-search-tree-in-order-traversal/">next post</a> will be about traversing the tree in the order of the nodes.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org23880fc" class="outline-2">
<h2 id="org23880fc">Sources</h2>
<div class="outline-text-2" id="text-org23880fc">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search-tree-in-order-traversal/" class="u-url">Binary Search Tree: In-Order Traversal</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search-tree-in-order-traversal/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-10T15:21:25-08:00" itemprop="datePublished" title="2022-03-10 15:21">2022-03-10 15:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/binary-search-tree-in-order-traversal/#org783bd69">Traversing a Tree</a>
<ul>
<li><a href="posts/binary-search-tree-in-order-traversal/#orgc11e06a">The Algorithm</a></li>
<li>
<a href="posts/binary-search-tree-in-order-traversal/#orga321950">Implementing It</a>
<ul>
<li><a href="posts/binary-search-tree-in-order-traversal/#org3f4e172">The Function</a></li>
<li><a href="posts/binary-search-tree-in-order-traversal/#orgf7186b8">A First Sample</a></li>
<li><a href="posts/binary-search-tree-in-order-traversal/#org6dac0ff">A Little Fancier</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/binary-search-tree-in-order-traversal/#org77e6efc">End</a>
<ul>
<li><a href="posts/binary-search-tree-in-order-traversal/#org148ecc2">The Posts</a></li>
<li><a href="posts/binary-search-tree-in-order-traversal/#orgc59fc27">Sources</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
This is the next post in a series on Binary Search Trees that start with <a href="posts/binary-search-trees/">this post</a>.
</p>
<div id="outline-container-org783bd69" class="outline-2">
<h2 id="org783bd69">Traversing a Tree</h2>
<div class="outline-text-2" id="text-org783bd69">
<p>
There are three common ways to traverse a Binary Search Tree which can be characterized by when the root of the tree is added:
</p>

<ul class="org-ul">
<li>Pre-Order Tree Walk
<ol class="org-ol">
<li>root</li>
<li>sub-trees</li>
</ol>
</li>
<li>In-Order Tree Walk
<ol class="org-ol">
<li>left sub-tree</li>
<li>root</li>
<li>right sub-tree</li>
</ol>
</li>
<li>Post-Order Tree Walk
<ol class="org-ol">
<li>sub-trees</li>
<li>root</li>
</ol>
</li>
</ul>
<p>
We're going to look at how to get the nodes of the tree in sorted (non-decreasing) order, which is a characteristic of the In-Order Tree Walk.
</p>
</div>
<div id="outline-container-orgc11e06a" class="outline-3">
<h3 id="orgc11e06a">The Algorithm</h3>
<div class="outline-text-3" id="text-orgc11e06a">
<p>
<a href="posts/clrs/">CLRS</a> gives the In-Order Tree Walk in the context of printing the nodes of the tree in order.
</p>

<pre id="in-order-walk" style="display:hidden;">
\begin{algorithm}
\caption{In-Order Tree Walk}
\begin{algorithmic}
\INPUT Node \textit{x}

\PROCEDURE{InorderTreeWalk}{\textit{x}}
\IF {\textit{x} $\neq$ \textsc{Nil}}

 \STATE \textsc{InorderTreeWalk}(\textit{x.left})
 \STATE \textsc{Print}(\textit{x.key})
 \STATE \textsc{InorderTreeWalk}(\textit{x.right})
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-orga321950" class="outline-3">
<h3 id="orga321950">Implementing It</h3>
<div class="outline-text-3" id="text-orga321950">
</div>
<div id="outline-container-org3f4e172" class="outline-4">
<h4 id="org3f4e172">The Function</h4>
<div class="outline-text-4" id="text-org3f4e172">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">in_order_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Print the nodes in order</span>

<span class="sd">    Args:</span>
<span class="sd">     root: the root node</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">in_order_traversal</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
	<span class="n">in_order_traversal</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgf7186b8" class="outline-4">
<h4 id="orgf7186b8">A First Sample</h4>
<div class="outline-text-4" id="text-orgf7186b8">
<p>
Let's start with a simple example.
</p>

<p>
<img src="posts/binary-search-tree-in-order-traversal/first_tree.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
<span class="n">in_order_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</pre></div>

<pre class="example">
1 2 3 
</pre>
</div>
</div>

<div id="outline-container-org6dac0ff" class="outline-4">
<h4 id="org6dac0ff">A Little Fancier</h4>
<div class="outline-text-4" id="text-org6dac0ff">
<p>
<img src="posts/binary-search-tree-in-order-traversal/second_tree.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="n">rootier</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rootier</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">root</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">right</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">right</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">right</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
<span class="n">rootier</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
<span class="n">rootier</span><span class="o">.</span><span class="n">check_node</span><span class="p">()</span>
<span class="n">in_order_traversal</span><span class="p">(</span><span class="n">rootier</span><span class="p">)</span>
</pre></div>

<pre class="example">
1 2 3 4 5 6 7 
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org77e6efc" class="outline-2">
<h2 id="org77e6efc">End</h2>
<div class="outline-text-2" id="text-org77e6efc">
</div>
<div id="outline-container-org148ecc2" class="outline-3">
<h3 id="org148ecc2">The Posts</h3>
<div class="outline-text-3" id="text-org148ecc2">
<ul class="org-ul">
<li><a href="posts/binary-search-trees/">Previous Post</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgc59fc27" class="outline-3">
<h3 id="orgc59fc27">Sources</h3>
<div class="outline-text-3" id="text-orgc59fc27">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("in-order-walk"));
});
</script>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search-trees/" class="u-url">Binary Search Trees</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search-trees/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-08T16:37:49-08:00" itemprop="datePublished" title="2022-03-08 16:37">2022-03-08 16:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/binary-search-trees/#org00e8373">What is a Binary Search Tree?</a></li>
<li><a href="posts/binary-search-trees/#org9b6ff02">The Binary Search Tree Property</a></li>
<li><a href="posts/binary-search-trees/#org9ade799">The Posts</a></li>
<li><a href="posts/binary-search-trees/#orgbe07810">Sources</a></li>
</ul>
</div>
</div>
<div id="outline-container-org00e8373" class="outline-2">
<h2 id="org00e8373">What is a Binary Search Tree?</h2>
<div class="outline-text-2" id="text-org00e8373">
<p>
Using <a href="posts/clrs/">CLRS</a>:
</p>

<ul class="org-ul">
<li>A Binary Search Tree is a linked structure of Nodes</li>
<li>Each Node is an object</li>
<li>Each node has a <i>Key</i> (and <i>Data</i>)</li>
<li>Each Node has <i>Left</i>, <i>Right</i>, and <i>Parent</i> attributes which point to the Left Child, Right-Child, and Parent of the Node.</li>
<li>If a child is missing then it is set to <i>Nil</i>.</li>
<li>The root Node is the only Node with a Parent set to <i>Nil</i>.</li>
</ul>
<p>
When describing Binary Search Trees I'll tend to refer to the Nodes but mean the Nodes' keys (e.g. to say a Node is less than another means its key is less than the other Node's).
</p>
</div>
</div>

<div id="outline-container-org9b6ff02" class="outline-2">
<h2 id="org9b6ff02">The Binary Search Tree Property</h2>
<div class="outline-text-2" id="text-org9b6ff02">
<p>
All the nodes in the left sub-tree of a node are less than or equal to the node and all the nodes in the right sub-tree of the node are greater than or equal to the node.
</p>
</div>
</div>

<div id="outline-container-org9ade799" class="outline-2">
<h2 id="org9ade799">The Posts</h2>
<div class="outline-text-2" id="text-org9ade799">
<ul class="org-ul">
<li><a href="posts/binary-search-tree-node/">Binary Search Tree Node</a></li>
<li><a href="posts/binary-search-tree-node-insertion/">Binary Search Tree Node Insertion</a></li>
<li><a href="posts/binary-search-tree-in-order-traversal/">Binary Search Tree: In-Order Traversal</a></li>
<li><a href="posts/binary-search-tree-queries/">Binary Search Tree Queries</a></li>
<li><a href="posts/binary-search-tree-randomized/">Binary Search Tree: Randomized</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgbe07810" class="outline-2">
<h2 id="orgbe07810">Sources</h2>
<div class="outline-text-2" id="text-orgbe07810">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/algorithm-problems/" class="u-url">Algorithm Problems</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/algorithm-problems/" rel="bookmark">
            <time class="published dt-published" datetime="2022-03-03T18:33:06-08:00" itemprop="datePublished" title="2022-03-03 18:33">2022-03-03 18:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgf453246" class="outline-2">
<h2 id="orgf453246">By Problem</h2>
<div class="outline-text-2" id="text-orgf453246">
<ul class="org-ul">
<li><a href="posts/the-sorting-problem/">The Sorting Problem</a></li>
<li><a href="posts/the-selection-problem/">The Selection Problem</a></li>
</ul>
</div>
</div>

<div id="outline-container-org32f31ce" class="outline-2">
<h2 id="org32f31ce">By Algorithm Type</h2>
<div class="outline-text-2" id="text-org32f31ce">
<ul class="org-ul">
<li><a href="posts/more-of-the-output/">More of the Output</a></li>
<li><a href="posts/iterative-algorithms/">Iterative Algorithms</a></li>
<li><a href="posts/divide-and-conquer/">Divide and Conquer</a></li>
<li><a href="posts/decrease-and-conquer/">Decrease And Conquer</a></li>
</ul>
</div>
</div>
    </div>
    </article>
</div>

        <ul class="pager postindexpager clearfix">
<li class="next"><a href="index-4.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script><!--End of body content--><footer id="footer"><a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
 <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
