<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Striking out for data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bowling For Data (old posts, page 3) | Bowling For Data</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Bowling-For-Data/index-3.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-light
bg-light
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href=".">

            <span id="blog-title">Bowling For Data</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://necromuralist.github.io/Bowling-For-Data/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
 <!-- End of custom search -->
 

            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-master-theorem/" class="u-url">The Master Theorem</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-master-theorem/" rel="bookmark">
            <time class="published dt-published" datetime="2022-01-26T14:12:02-08:00" itemprop="datePublished" title="2022-01-26 14:12">2022-01-26 14:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org6a086e2" class="outline-2">
<h2 id="org6a086e2">The General Divide and Conquer Recurrence</h2>
<div class="outline-text-2" id="text-org6a086e2">
<p>
When we have a <a href="posts/divide-and-conquer/">Divide and Conquer</a> algorithm that we solve via recursion we can estimate the running time using the <b>General Divide and Conquer Recurrence</b>.
</p>

<ul class="org-ul">
<li>\(T(n)\) is the total runtime.</li>
<li>\(n\) is the size of the problem (the number of instances in the input).</li>
<li>\(a\) is the number of the sub-problems that we create that need to be solved.</li>
<li>\(b\) is the number of sub-problems we create (we'll mostly see cases where \(a=b=2\)).</li>
<li>\(f(n)\) is the time spent dividing the problem and later recombining the sub-problems.</li>
</ul>
<p>
Which we combine into this equation.
</p>

<p>
\[
T(n) = aT \left(\frac{n}{b} \right) + f(n)
\]
</p>
</div>
</div>

<div id="outline-container-org063116d" class="outline-2">
<h2 id="org063116d">The Master Theorem</h2>
<div class="outline-text-2" id="text-org063116d">
<p>
In the case where \(f(n) \in \Theta \left (n^d \right)\) and \(d ≥ 0\) (so it's either 1 or a power of n), we can use the following conditional cases to estimate the runtime.
</p>

<p>
\[
T(n) \in \begin{cases}
\Theta\left (n^d \right ) &amp; \textrm{if }a &lt; b^d \\
\Theta\left (n^d \log n \right ) &amp; \textrm{if }a = b^d \\
\Theta\left (n^{\log_b a} \right) &amp; \textrm{if }a &gt; b^d
\end{cases}
\]
</p>
</div>
</div>

<div id="outline-container-orge4c88c7" class="outline-2">
<h2 id="orge4c88c7">Source</h2>
<div class="outline-text-2" id="text-orge4c88c7">
<ul class="org-ul">
<li><a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-mergesort/" class="u-url">The Mergesort</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-mergesort/" rel="bookmark">
            <time class="published dt-published" datetime="2022-01-25T17:49:38-08:00" itemprop="datePublished" title="2022-01-25 17:49">2022-01-25 17:49</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/the-mergesort/#org350471a">Beginning</a></li>
<li>
<a href="posts/the-mergesort/#orgaaf64b4">Middle</a>
<ul>
<li><a href="posts/the-mergesort/#orgca80224">The CLRS Algorithm</a></li>
<li><a href="posts/the-mergesort/#org0e1cdc0">Runtime</a></li>
<li>
<a href="posts/the-mergesort/#orgaf466a8">The Levitin</a>
<ul>
<li><a href="posts/the-mergesort/#org5f4b762">Implement It</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="posts/the-mergesort/#orge90fd53">Comparing Sorts</a></li>
<li>
<a href="posts/the-mergesort/#orgef20ca7">Looking at the Mergesort</a>
<ul>
<li><a href="posts/the-mergesort/#org61e5083">A Shuffle Input</a></li>
<li><a href="posts/the-mergesort/#orgabea5e9">A Reversed Input</a></li>
</ul>
</li>
<li><a href="posts/the-mergesort/#org4f9d713">End</a></li>
</ul>
</div>
</div>
<div id="outline-container-org350471a" class="outline-2">
<h2 id="org350471a">Beginning</h2>
<div class="outline-text-2" id="text-org350471a">
<p>
This is a look at the <a href="https://en.wikipedia.org/wiki/Merge_sort"><i>Mergesort</i></a>, an example of the <a href="posts/divide-and-conquer/">Divide and Conquer</a> strategy for sorting collections.
</p>
</div>
</div>
<div id="outline-container-orgaaf64b4" class="outline-2">
<h2 id="orgaaf64b4">Middle</h2>
<div class="outline-text-2" id="text-orgaaf64b4">
</div>
<div id="outline-container-orgca80224" class="outline-3">
<h3 id="orgca80224">The CLRS Algorithm</h3>
<div class="outline-text-3" id="text-orgca80224">
<p>
Our <i>Mergesort</i> repeatedly divides the given list into two parts and then recursively calls itself with the sub-problems and then takes advantage of our previously defined <a href="posts/the-merge/">Merge</a> function to combine the solutions together once we are down to one item to sort (\(p = r\)).
</p>

<pre id="the-mergesort" style="display:hidden;">
\begin{algorithm}
\caption{Mergesort}
\begin{algorithmic}
\INPUT An array and left and right locations of the subarray in the array
\OUTPUT The array in sorted order

\PROCEDURE{Mergesort}{$A, p, r$}
\IF {p &lt; r}
         \STATE \textbf{Divide}
         \STATE $q \gets \left \lfloor \frac{p + r}{2} \right \rfloor$
         
         \STATE \\ \textbf{Conquer}
         \STATE \textsc{MergeSort}(A, p, q)
         \STATE \textsc{MergeSort}(A, q + 1, r)

         \STATE \\ \textbf{Combine}
         \STATE \textsc{Merge}(A, p, q, r)
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org0e1cdc0" class="outline-3">
<h3 id="org0e1cdc0">Runtime</h3>
<div class="outline-text-3" id="text-org0e1cdc0">
<ul class="org-ul">
<li>
<b><b>Divide:</b></b> \(D(n) = \Theta(1)\)</li>
<li>
<b><b>Conquer:</b></b> \(2T\left (\frac{n}{2}\right)\)</li>
<li>
<b><b>Combine:</b></b> \(C(n) = \Theta(n)\)</li>
</ul>

\begin{align}
T(n) &amp;= 2T \left( \frac{n}{2} \right) + \Theta(1) + \Theta(n) \\
&amp;= 2T \left( \frac{n}{2} \right) + \Theta(n) \\
&amp;= \Theta(n \log_2 n)
\end{align}
</div>
</div>
<div id="outline-container-orgaf466a8" class="outline-3">
<h3 id="orgaf466a8">The Levitin</h3>
<div class="outline-text-3" id="text-orgaf466a8">
<pre id="the-mergesort-levitin" style="display:hidden;">
\begin{algorithm}
\caption{Levitin's Mergesort}
\begin{algorithmic}
\INPUT Array $A[0 \ldots n - 1]$ of orderable elements.
\OUTPUT Array $A[0 \ldots n - 1]$ sorted in non-decreasing order.

\PROCEDURE{MergeSort}{A}
\IF {n &gt; 1}
         \STATE \textbf{Divide}
         \STATE Copy $A\left[0 \ldots \left\lfloor \frac{n}{2} \right\rfloor - 1 \right]$ to $B \left[0 \ldots \left\lfloor \frac{n}{2} \right\rfloor - 1 \right]$
         \STATE Copy $A \left[\left\lfloor \frac{n}{2}\right\rfloor \ldots n - 1 \right]$ to $C \left[0 \ldots \left\lfloor \frac{n}{2} \right\rfloor - 1 \right]$
         
         \STATE \\ \textbf{Conquer}
         \STATE \textsc{MergeSort}(B)
         \STATE \textsc{MergeSort}(C)

         \STATE \\ \textbf{Combine}
         \STATE \textsc{Merge}(B, C, A)
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>

<div id="outline-container-org5f4b762" class="outline-4">
<h4 id="org5f4b762">Implement It</h4>
<div class="outline-text-4" id="text-org5f4b762">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">MutableSequence</span><span class="p">,</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log2</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">contain_exactly</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">left_stack</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
	  <span class="n">right_stack</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
	  <span class="n">target</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Merges values from left and right stacks into target collection</span>

<span class="sd">    Args:</span>
<span class="sd">     left_stack: sorted collection of items to merge</span>
<span class="sd">     right_stack: sorted collection of items to merge</span>
<span class="sd">     target: collection into which to merge the items</span>

<span class="sd">    Returns:</span>
<span class="sd">     count of basic operations</span>
<span class="sd">    """</span>
    <span class="n">left_size</span><span class="p">,</span> <span class="n">right_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_stack</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_stack</span><span class="p">)</span>
    <span class="n">next_left</span> <span class="o">=</span> <span class="n">next_right</span> <span class="o">=</span> <span class="n">put_item_here</span> <span class="o">=</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">next_left</span> <span class="o">&lt;</span> <span class="n">left_size</span> <span class="ow">and</span> <span class="n">next_right</span> <span class="o">&lt;</span> <span class="n">right_size</span><span class="p">:</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]:</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span>
	    <span class="n">next_left</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]</span>
	    <span class="n">next_right</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="n">put_item_here</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">next_left</span> <span class="o">==</span> <span class="n">left_size</span> <span class="ow">and</span> <span class="n">next_right</span> <span class="o">&lt;</span> <span class="n">right_size</span><span class="p">:</span>
	<span class="k">for</span> <span class="n">stack_offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left_size</span> <span class="o">+</span> <span class="n">right_size</span> <span class="o">-</span> <span class="n">put_item_here</span><span class="p">):</span>
	    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">next_left</span> <span class="o">&lt;</span> <span class="n">left_size</span><span class="p">:</span>
	<span class="k">for</span> <span class="n">stack_offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left_size</span> <span class="o">+</span> <span class="n">right_size</span> <span class="o">-</span> <span class="n">put_item_here</span><span class="p">):</span>
	    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mergesort</span><span class="p">(</span><span class="n">collection</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Sorts the collection using a recursive mergesort</span>

<span class="sd">    Args:</span>
<span class="sd">     collection: a mutable sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">     runtime count</span>
<span class="sd">    """</span>
    <span class="n">items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">items</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
	<span class="n">middle</span> <span class="o">=</span> <span class="n">items</span><span class="o">//</span><span class="mi">2</span>
	<span class="n">left_stack</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[:</span><span class="n">middle</span><span class="p">]</span>
	<span class="n">right_stack</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="n">middle</span><span class="p">:]</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_stack</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_stack</span><span class="p">)</span> <span class="o">==</span> <span class="n">items</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="n">mergesort</span><span class="p">(</span><span class="n">left_stack</span><span class="p">)</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="n">mergesort</span><span class="p">(</span><span class="n">right_stack</span><span class="p">)</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="n">merge</span><span class="p">(</span><span class="n">left_stack</span><span class="p">,</span> <span class="n">right_stack</span><span class="p">,</span> <span class="n">collection</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">10</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)),</span> <span class="n">k</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="n">starting</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">runtime</span> <span class="o">=</span> <span class="n">mergesort</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="n">log2</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">starting</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">size</span> <span class="o">*</span> <span class="n">log2</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">runtime</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

<pre class="example">
10,240.0
10,240
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge90fd53" class="outline-2">
<h2 id="orge90fd53">Comparing Sorts</h2>
<div class="outline-text-2" id="text-orge90fd53">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>

<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># this project</span>
<span class="kn">from</span> <span class="nn">bowling.sort.insertion</span> <span class="kn">import</span> <span class="n">insertion_sort</span>

<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">numba_random</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">(</span><span class="mi">2022</span><span class="p">)</span>
<span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>

<span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"the-mergesort"</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="n">SLUG</span><span class="p">)</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merger</span><span class="p">(</span><span class="n">thing_to_sort</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""A thing to add the size of the input to the output</span>

<span class="sd">    Args:</span>
<span class="sd">     thing_to_sort: collection of items to sort</span>

<span class="sd">    Returns:</span>
<span class="sd">     number of things to sort, count of merges</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">thing_to_sort</span><span class="p">),</span> <span class="n">mergesort</span><span class="p">(</span><span class="n">thing_to_sort</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">ninsertion</span> <span class="o">=</span> <span class="n">njit</span><span class="p">(</span><span class="n">insertion_sort</span><span class="p">)</span>

<span class="n">things_to_sort</span> <span class="o">=</span> <span class="p">[</span><span class="n">numba_random</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">count</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
		  <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)]</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">insertion_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
	<span class="n">delayed</span><span class="p">(</span><span class="n">ninsertion</span><span class="p">)(</span><span class="n">thing_to_sort</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">thing_to_sort</span> <span class="ow">in</span> <span class="n">things_to_sort</span><span class="p">)</span>
</pre></div>

<pre class="example">
Started: 2022-01-28 01:12:10.628102
Ended: 2022-01-28 01:12:22.681161
Elapsed: 0:00:12.053059
</pre>


<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">merge_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
	<span class="n">delayed</span><span class="p">(</span><span class="n">merger</span><span class="p">)(</span><span class="n">thing_to_sort</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">thing_to_sort</span> <span class="ow">in</span> <span class="n">things_to_sort</span><span class="p">)</span>
</pre></div>

<pre class="example">
Started: 2022-01-28 01:12:33.278574
Ended: 2022-01-28 01:12:38.850064
Elapsed: 0:00:05.571490
</pre>


<div class="highlight"><pre><span></span><span class="n">SIZE</span><span class="p">,</span> <span class="n">COMPARISONS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">unzipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">merge_output</span><span class="p">))</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Size"</span><span class="p">:</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">SIZE</span><span class="p">],</span>
<span class="s2">"Mergesort"</span><span class="p">:</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">COMPARISONS</span><span class="p">]})</span>

<span class="n">unzipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">insertion_output</span><span class="p">))</span>
<span class="n">frame</span><span class="p">[</span><span class="s2">"Insertion Sort"</span><span class="p">]</span> <span class="o">=</span> <span class="n">unzipped</span><span class="p">[</span><span class="n">COMPARISONS</span><span class="p">]</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Size"</span><span class="p">],</span>
		    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Mergesort"</span><span class="p">,</span> <span class="s2">"Insertion Sort"</span><span class="p">],</span>
		    <span class="n">var_name</span><span class="o">=</span><span class="s2">"Sort Algorithm"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Comparisons"</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Size"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Comparisons"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Sort Algorithm"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Size"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Comparisons"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="s2">"Sort Algorithm"</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Insertion vs Merge Sort"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"insertion-vs-merge"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-mergesort/insertion-vs-merge.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<div class="highlight"><pre><span></span><span class="n">frame</span><span class="p">[</span><span class="s2">"nlog2(n)"</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s2">"Size"</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s2">"Size"</span><span class="p">])</span>
<span class="k">del</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s2">"Insertion Sort"</span><span class="p">])</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Size"</span><span class="p">],</span>
		    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Mergesort"</span><span class="p">,</span> <span class="s2">"nlog2(n)"</span><span class="p">],</span>
		    <span class="n">var_name</span><span class="o">=</span><span class="s2">"Source"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Comparisons"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Size"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Comparisons"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Source"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Size"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Comparisons"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="s2">"Source"</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Merge Sort vs Theoretical"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"merge-by-logn"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-mergesort/merge-by-logn.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>


<div id="outline-container-orgef20ca7" class="outline-2">
<h2 id="orgef20ca7">Looking at the Mergesort</h2>
<div class="outline-text-2" id="text-orgef20ca7">
<p>
The version of mergesort I implemented above is based on Levitin's algorithm, which I thought was clearer, since the copying was happening outside of the merge. This makes it harder to plot the progress of the sort, though, so I'm going to use the CLRS algorithm here to get some kind of visualization (hopefully).
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bowling.sort.merge</span> <span class="kn">import</span> <span class="n">merge_clrs</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mergesort_tracer</span><span class="p">(</span><span class="n">collection</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
		     <span class="n">tracer</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Sorts the collection using a recursive mergesort</span>

<span class="sd">    This uses the CLRS merge-sort to build dict of the locations of the</span>
<span class="sd">    elements as the merging is done</span>

<span class="sd">    Args:</span>
<span class="sd">     collection: a mutable sequence</span>
<span class="sd">     left: the index of the beginning element of the sub-array</span>
<span class="sd">     right: the index of the ending element of the sub-array</span>
<span class="sd">     tracer: the dictionary to track the indices of the items</span>

<span class="sd">    Returns:</span>
<span class="sd">     tracer updated with post-merge locations of the items in tracer</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">tracer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">tracer</span> <span class="o">=</span> <span class="p">{</span><span class="n">element</span><span class="p">:</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">collection</span><span class="p">)}</span>

    <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">:</span>
	<span class="n">middle</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
	<span class="n">mergesort_tracer</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">tracer</span><span class="p">)</span>
	<span class="n">mergesort_tracer</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">tracer</span><span class="p">)</span>
	<span class="n">merge_clrs</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
	    <span class="n">tracer</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tracer</span>
</pre></div>
</div>

<div id="outline-container-org61e5083" class="outline-3">
<h3 id="org61e5083">A Shuffle Input</h3>
<div class="outline-text-3" id="text-org61e5083">
<div class="highlight"><pre><span></span><span class="n">elements</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">start</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">elements</span><span class="p">))</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">tracer</span> <span class="o">=</span> <span class="n">mergesort_tracer</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">))</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tracer</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"index"</span><span class="p">:</span> <span class="s2">"Merge"</span><span class="p">})</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Merge"</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">"Element"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Merge"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Location"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Element"</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Merge"</span><span class="p">,</span> <span class="s2">"Location"</span><span class="p">,</span> <span class="s2">"Element"</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Mergesort Tracing"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"mergesort-trace"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-mergesort/mergesort-trace.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
You can kind of see what's going on, every time you see a bunch of crossed lines it's because the merge moved items around… but maybe an artificial case will be clearer.
</p>
</div>
</div>

<div id="outline-container-orgabea5e9" class="outline-3">
<h3 id="orgabea5e9">A Reversed Input</h3>
<div class="outline-text-3" id="text-orgabea5e9">
<p>
Let's use an input that's sorted but backwards to see the swaps more clearly.
</p>

<div class="highlight"><pre><span></span><span class="n">elements</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">start</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">elements</span><span class="p">))</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">tracer</span> <span class="o">=</span> <span class="n">mergesort_tracer</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">))</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tracer</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"index"</span><span class="p">:</span> <span class="s2">"Merge"</span><span class="p">})</span>
<span class="n">melted</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Merge"</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">"Element"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Merge"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Location"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">tickMinStep</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">altair</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Element"</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">"Merge"</span><span class="p">,</span> <span class="s2">"Location"</span><span class="p">,</span> <span class="s2">"Element"</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Mergesort Tracing (From Backwards Source)"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span>
<span class="p">)</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">"mergesort-trace-backwards"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/the-mergesort/mergesort-trace-backwards.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>



<div id="outline-container-org4f9d713" class="outline-2">
<h2 id="org4f9d713">End</h2>
<div class="outline-text-2" id="text-org4f9d713">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
<li><a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms (Levitin)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("the-mergesort"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("the-mergesort-levitin"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/divide-and-conquer/" class="u-url">Divide and Conquer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/divide-and-conquer/" rel="bookmark">
            <time class="published dt-published" datetime="2022-01-25T17:12:58-08:00" itemprop="datePublished" title="2022-01-25 17:12">2022-01-25 17:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgced490d" class="outline-2">
<h2 id="orgced490d">Description</h2>
<div class="outline-text-2" id="text-orgced490d">
<p>
The Divide-and-Conquer approach involves three parts.
</p>

<ul class="org-ul">
<li>
<b><b>Divide:</b></b> Break the problem up into sub-problems that are smaller instances of the same problem.</li>
<li>
<b><b>Conquer:</b></b> If the problem is small enough solve it, otherwise recursively solve the sub-problem.</li>
<li>
<b><b>Combine:</b></b> Combine the solutions to the sub-problems into a solution for the original problem.</li>
</ul>
</div>
</div>
<div id="outline-container-org6e907ee" class="outline-2">
<h2 id="org6e907ee">See</h2>
<div class="outline-text-2" id="text-org6e907ee">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
</ul>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-merge/" class="u-url">The Merge</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/the-merge/" rel="bookmark">
            <time class="published dt-published" datetime="2022-01-23T17:32:22-08:00" itemprop="datePublished" title="2022-01-23 17:32">2022-01-23 17:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/the-merge/#org92c3556">The Merge</a>
<ul>
<li>
<a href="posts/the-merge/#orgdccd4d7">CLRS</a>
<ul>
<li><a href="posts/the-merge/#org8fab162">Implement It</a></li>
<li><a href="posts/the-merge/#org6162a30">Runtime</a></li>
</ul>
</li>
<li>
<a href="posts/the-merge/#orgc39cf35">Levitin</a>
<ul>
<li><a href="posts/the-merge/#orgc495d5c">Implement It</a></li>
<li><a href="posts/the-merge/#org23e8781">Runtime</a></li>
</ul>
</li>
<li><a href="posts/the-merge/#org7b7c4c2">A Hybrid</a></li>
</ul>
</li>
<li><a href="posts/the-merge/#org305c62c">End</a></li>
</ul>
</div>
</div>
<div id="outline-container-org92c3556" class="outline-2">
<h2 id="org92c3556">The Merge</h2>
<div class="outline-text-2" id="text-org92c3556">
<p>
This is an implementation of the merge portion of the merge-sort. It takes two sorted sections of a collection and merges them together in place.
</p>
</div>

<div id="outline-container-orgdccd4d7" class="outline-3">
<h3 id="orgdccd4d7">CLRS</h3>
<div class="outline-text-3" id="text-orgdccd4d7">
<p>
The precondition for this to work is that there are two sections within the array passed in to the algorithm that are already sorted and that they are located by the three index-values given to the algorithm. The first sorted section starts at <code>p</code> and ends at <code>q</code> in the array and the second sorted section starts at <code>q + 1</code> and ends at <code>r</code> within the array.
</p>

<p>
This is the CLRS version with the indexing changed to start at 0.
</p>

<pre id="the-merge" style="display:hidden;">
\begin{algorithm}
\caption{Merge}
\begin{algorithmic}
\INPUT An array and left, middle, and right locations in the array
\REQUIRE Sub-arrays from $p$ to $q$ and from $q + 1$ to $r$ are sorted
\OUTPUT The array with the two sections collated in order

\PROCEDURE{Merge}{$A, p, q, r$}

\STATE \textbf{The sizes of the sub-sections}
\STATE $n_1 \gets q - p + 1$
\STATE $n_2 \gets r - q$

\STATE \\ \textbf{Copy the subsections to new arrays.}
\STATE \textit{New arrays have one extra cell to hold a sentinel.}
\STATE $L \gets Array[0\ldots n_1]$
\STATE $R \gets Array[0 \ldots n_2]$

\FOR {$i \in {0 \ldots n_1 - 1}$}
  \STATE $L[i] \gets A[p + i - 1]$
\ENDFOR

\FOR{$j \in {0 \ldots n_2 - 1}$}
  \STATE $R[j] \gets A[q + j]$
\ENDFOR

\STATE \\ \textbf{Add sentinel to indicate end}
\STATE $L[n_1] \gets \infty $
\STATE $R[n_2] \gets \infty $

\STATE \\ \textbf{Collate}
\STATE $i \gets 0$
\STATE $j \gets 0$

\FOR {$k \in {p \ldots r}$}
 \IF {$L[i] \leq R[j]$}
   \STATE $A[k] \gets L[i]$
   \STATE $i' \gets i + 1$
 \ELSE
  \STATE $A[k] \gets R[j]$
  \STATE $j' \gets j + 1$
\ENDIF
\ENDFOR
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
One way to think about how the algorithm is like you have two stacks of cards, each of which is sorted and you want to merge them together in sorted order. Since they are already sorted, you only have to compare the top cards on the two stacks to each other, chose the lower card and put it in your output stack, and keep repeating this until you've moved all the cards from the two stacks to the output. If one stack runs out of cards you just move the other remaining cards onto the output stack.
</p>

<p>
Our algorithm starts by copying out the values from the source array into two new arrays to create our stacks. We append an \(\infty\) onto the end of each to simulate the emptying of the stack. Then we keep looking at the top item in each stack and copying the smaller item back into the original array. Because of the copying we are going over the input twice, but that is a relatively small (linear) increase.
</p>
</div>

<div id="outline-container-org8fab162" class="outline-4">
<h4 id="org8fab162">Implement It</h4>
<div class="outline-text-4" id="text-org8fab162">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">MutableSequence</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">contain_exactly</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">INFINITY</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge_clrs</span><span class="p">(</span><span class="n">collection</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">,</span>
	  <span class="n">left_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
	  <span class="n">left_end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
	  <span class="n">right_end</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Merge the sub-sections from the collection</span>

<span class="sd">    Args:</span>
<span class="sd">     collection: list or array with sorted sub-sections</span>
<span class="sd">     left_start: index of start of first sub-section</span>
<span class="sd">     left_end: index of last item of first sub-section</span>
<span class="sd">     right_end: index of the last item of second sub-section</span>
<span class="sd">    """</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">left_size</span> <span class="o">=</span> <span class="n">left_end</span> <span class="o">-</span> <span class="n">left_start</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">right_size</span> <span class="o">=</span> <span class="n">right_end</span> <span class="o">-</span> <span class="n">left_end</span>
    <span class="n">right_start</span> <span class="o">=</span> <span class="n">left_end</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">left_stack</span> <span class="o">=</span> <span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">left_size</span><span class="p">)</span>
    <span class="n">right_stack</span> <span class="o">=</span> <span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">right_size</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">stack_location</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left_size</span><span class="p">):</span>
	<span class="n">left_stack</span><span class="p">[</span><span class="n">stack_location</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="n">left_start</span> <span class="o">+</span> <span class="n">stack_location</span><span class="p">]</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">stack_location</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">right_size</span><span class="p">):</span>
	<span class="n">right_stack</span><span class="p">[</span><span class="n">stack_location</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="n">right_start</span> <span class="o">+</span> <span class="n">stack_location</span><span class="p">]</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">left_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INFINITY</span><span class="p">)</span>
    <span class="n">right_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INFINITY</span><span class="p">)</span>

    <span class="n">next_left</span> <span class="o">=</span> <span class="n">next_right</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">put_next_item_here</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left_start</span><span class="p">,</span> <span class="n">right_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]:</span>
	    <span class="n">collection</span><span class="p">[</span><span class="n">put_next_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span>
	    <span class="n">next_left</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">collection</span><span class="p">[</span><span class="n">put_next_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]</span>
	    <span class="n">next_right</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge_check</span><span class="p">(</span><span class="n">merger</span><span class="p">):</span>
    <span class="n">first</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">second</span> <span class="o">=</span> <span class="n">first</span><span class="p">[:]</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="n">second</span>

    <span class="n">count</span> <span class="o">=</span> <span class="n">merger</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">first</span> <span class="o">+</span> <span class="n">second</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">merger</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">first</span> <span class="o">+</span> <span class="n">second</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">merger</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">merge_check</span><span class="p">(</span><span class="n">merge_clrs</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org6162a30" class="outline-4">
<h4 id="org6162a30">Runtime</h4>
<div class="outline-text-4" id="text-org6162a30">
<p>
Without doing anything fancy we can see that there's three for loops, the first two cover copying over all the sub-list items from the original list to the new lists, so together they execute once for every item (<i>n</i> times). And the loop that does the actual merge also runs once for each item so it also runs <i>n</i> times so altogether it has a run time of <i>2n</i> which we'll say is \(\Theta(n)\). This is actually going to be part of the merge-sort but I thought I'd put that in here since the post is separate.
</p>
</div>
</div>
</div>

<div id="outline-container-orgc39cf35" class="outline-3">
<h3 id="orgc39cf35">Levitin</h3>
<div class="outline-text-3" id="text-orgc39cf35">
<p>
This is the version given in <a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms</a> which I find a little clearer than the CLRS version. I generally prefer Levitin's versions, but, you know, CLRS is the one you <b>have to</b> have, so it's there too.
</p>

<pre id="the-merge-levitin" style="display:hidden;">
\begin{algorithm}
\caption{Merge}
\begin{algorithmic}
\INPUT $B[0 \ldots p-1]$, $C[0 \ldots q - 1]$, $A[0 \ldots p + q - 1]$
\REQUIRE Sub-arrays $B$ and $C$ are sorted
\OUTPUT Sorted array $A$ with the elements of $B$ and $C$.

\PROCEDURE{Merge}{$B, C, A$}

\STATE $i \gets 0$
\STATE $j \gets 0$
\STATE $k \gets 0$

\WHILE {$i &lt; p$ and $j &lt; q$}
 \IF {$B[i] \le C[j]$}
  \STATE $A[k] \gets B[i]$
  \STATE $i \gets i + 1$
 \ELSE
  \STATE $A[k] \gets C[j]$
  \STATE $j \gets j + 1$
 \ENDIF
 \STATE $k \gets k + 1$
\ENDWHILE

\IF {$i=p$}
 \STATE Copy $C[j \ldots q-1]$ to $A[k \ldots p + q - 1]$
\ELSE
 \STATE Copy $B[i \ldots p - 1]$ to $A[k \ldots p + q - 1]$
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>

<p>
There are a couple of noticeable differences between Levitin's version and the CLRS version. The first is that the lists to merge are passed into the function rather than being separated inside the function, which makes the "Divide" step separate from the "Combine" step. Additionally, instead of adding a sentinel to the end of the stacks the conditional checks to see if one of them is empty and copies over the stack that isn't empty outside of the merge-loop. This adds an additional conditional check to the main loop but then takes away the conditional check when copying over the leftovers. I might give the CLRS version a point for being more concise in handling the leftovers for the case where left and right are different sizes.
</p>
</div>
<div id="outline-container-orgc495d5c" class="outline-4">
<h4 id="orgc495d5c">Implement It</h4>
<div class="outline-text-4" id="text-orgc495d5c">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge_levitin</span><span class="p">(</span><span class="n">left_stack</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">right_stack</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
		  <span class="n">target</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Merges values from left and right stacks into target collection</span>

<span class="sd">    Args:</span>
<span class="sd">     left_stack: sorted collection of items to merge</span>
<span class="sd">     right_stack: sorted collection of items to merge</span>
<span class="sd">     target: collection into which to merge the items</span>

<span class="sd">    Returns:</span>
<span class="sd">     count of basic operations</span>
<span class="sd">    """</span>
    <span class="n">left_size</span><span class="p">,</span> <span class="n">right_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_stack</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_stack</span><span class="p">)</span>
    <span class="n">next_left</span> <span class="o">=</span> <span class="n">next_right</span> <span class="o">=</span> <span class="n">put_item_here</span> <span class="o">=</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">next_left</span> <span class="o">&lt;</span> <span class="n">left_size</span> <span class="ow">and</span> <span class="n">next_right</span> <span class="o">&lt;</span> <span class="n">right_size</span><span class="p">:</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]:</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span>
	    <span class="n">next_left</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]</span>
	    <span class="n">next_right</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="n">put_item_here</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">next_left</span> <span class="o">==</span> <span class="n">left_size</span> <span class="ow">and</span> <span class="n">next_right</span> <span class="o">&lt;</span> <span class="n">right_size</span><span class="p">:</span>
	<span class="k">for</span> <span class="n">stack_offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left_size</span> <span class="o">+</span> <span class="n">right_size</span> <span class="o">-</span> <span class="n">put_item_here</span><span class="p">):</span>
	    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">next_left</span> <span class="o">&lt;</span> <span class="n">left_size</span><span class="p">:</span>
	<span class="k">for</span> <span class="n">stack_offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left_size</span> <span class="o">+</span> <span class="n">right_size</span> <span class="o">-</span> <span class="n">put_item_here</span><span class="p">):</span>
	    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span> <span class="o">+</span> <span class="n">stack_offset</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">first</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">second</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="o">+</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">first</span><span class="p">)]</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">second</span><span class="p">))</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">merge_levitin</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">collection</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">second</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">first</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="o">+</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">second</span><span class="p">)]</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">second</span><span class="p">))</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">merge_levitin</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">collection</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-org23e8781" class="outline-4">
<h4 id="org23e8781">Runtime</h4>
<div class="outline-text-4" id="text-org23e8781">
<p>
Since the dividing of the array is moved out of the merge the runtime for the merge is \(n\) so it's also \(\Theta(n)\).
</p>
</div>
</div>
</div>
<div id="outline-container-org7b7c4c2" class="outline-3">
<h3 id="org7b7c4c2">A Hybrid</h3>
<div class="outline-text-3" id="text-org7b7c4c2">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">left_stack</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">right_stack</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
	  <span class="n">target</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Merges values from left and right stacks into target collection</span>

<span class="sd">    Args:</span>
<span class="sd">     left_stack: sorted collection of items to merge</span>
<span class="sd">     right_stack: sorted collection of items to merge</span>
<span class="sd">     target: collection into which to merge the items</span>

<span class="sd">    Returns:</span>
<span class="sd">     count of basic operations</span>
<span class="sd">    """</span>
    <span class="n">target_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_stack</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_stack</span><span class="p">)</span>

    <span class="c1"># since we aren't copying the lists this can be kind of dangerous</span>
    <span class="c1"># passing in the same list more than once will append INFINITY each time</span>
    <span class="n">left_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INFINITY</span><span class="p">)</span>
    <span class="n">right_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INFINITY</span><span class="p">)</span>
    <span class="n">next_left</span> <span class="o">=</span> <span class="n">next_right</span> <span class="o">=</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">put_item_here</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target_size</span><span class="p">):</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]:</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_stack</span><span class="p">[</span><span class="n">next_left</span><span class="p">]</span>
	    <span class="n">next_left</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">target</span><span class="p">[</span><span class="n">put_item_here</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_stack</span><span class="p">[</span><span class="n">next_right</span><span class="p">]</span>
	    <span class="n">next_right</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">first</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">second</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="o">+</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">first</span><span class="p">)]</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">second</span><span class="p">))</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">collection</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">second</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">first</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="o">+</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">second</span><span class="p">)]</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">second</span><span class="p">))</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">collection</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">expect</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-org305c62c" class="outline-2">
<h2 id="org305c62c">End</h2>
<div class="outline-text-2" id="text-org305c62c">
<ul class="org-ul">
<li><a href="posts/clrs/">Introduction To Algorithms (CLRS)</a></li>
<li><a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("the-merge"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("the-merge-levitin"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/binary-search/" class="u-url">Binary Search</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/binary-search/" rel="bookmark">
            <time class="published dt-published" datetime="2022-01-14T16:22:42-08:00" itemprop="datePublished" title="2022-01-14 16:22">2022-01-14 16:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="posts/binary-search/#org628c5ee">Beginning</a>
<ul>
<li><a href="posts/binary-search/#org56b8765">The Algorithm Parts</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search/#orgb6afefe">Implementation</a>
<ul>
<li><a href="posts/binary-search/#orgf8ae298">Imports</a></li>
<li><a href="posts/binary-search/#orgd186d67">Set Up</a></li>
<li>
<a href="posts/binary-search/#org5fbc69b">Binary Search One</a>
<ul>
<li><a href="posts/binary-search/#org30c8655">The Pseudocode</a></li>
<li><a href="posts/binary-search/#org9cef72c">The Function</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search/#orgdf2028b">Levitin's Version</a>
<ul>
<li><a href="posts/binary-search/#orgf4a820f">The Pseudocode</a></li>
<li><a href="posts/binary-search/#org9f3c134">The Function</a></li>
</ul>
</li>
<li>
<a href="posts/binary-search/#org5fcf40c">Recursive Version</a>
<ul>
<li><a href="posts/binary-search/#org17a83ae">The Pseudocode</a></li>
<li><a href="posts/binary-search/#orgee22b76">The Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="posts/binary-search/#org41709bd">Some Plotting</a>
<ul>
<li><a href="posts/binary-search/#orgc5c18f9">Left and Right</a></li>
<li><a href="posts/binary-search/#org67aff50">Runtime</a></li>
</ul>
</li>
<li><a href="posts/binary-search/#orgb82ae74">See Also</a></li>
</ul>
</div>
</div>
<div id="outline-container-org628c5ee" class="outline-2">
<h2 id="org628c5ee">Beginning</h2>
<div class="outline-text-2" id="text-org628c5ee">
</div>
<div id="outline-container-org56b8765" class="outline-3">
<h3 id="org56b8765">The Algorithm Parts</h3>
<div class="outline-text-3" id="text-org56b8765">
<ul class="org-ul">
<li>
<b><b>Precondition:</b></b> The input array (A) is sorted in non-decreasing order and the key \(k\) is in \(A\).</li>
<li>
<b><b>Postcondition:</b></b> The index of the matching element is output</li>
<li>
<b><b>Loop Invariant:</b></b> The key is in our current sublist: \(k \in A[left \ldots right]\).</li>
<li>
<b><b>Basic Step:</b></b> Find the midpoint of the sub-array, adjust the sub-array to use the midpoint such that the key is in the new sub-array.</li>
<li>
<b><b>Exit Condition:</b></b> \(left \le right\).</li>
<li>
<b><b>Make Progress:</b></b> After each loop the sublist is half the size of the previous sublist.</li>
<li>
<b><b>Maintain the Loop Invariant:</b></b> Pick the half of the sublist whose boundary value would allow the key.</li>
<li>
<b><b>Establish the Loop Invariant:</b></b> The initial sublist is the original list (\(left = 0, right=A.length -1\)).</li>
<li>
<b><b>Worst Case Runtime:</b></b> Since the input is repeatedly halved, the worst-case is \(\Theta(\log_{2} n)\).</li>
</ul>
<p>
Rather than saying "if k is in A" over and over, the search precondition requires that \(k\) is in \(A\) and if it isn't it's considered a failed search - which doesn't mean the algorithm is incorrect, just that the pre-condition wasn't met. We have to handle the other case, but for the purpose of defining the algorithm we'll set a stricter pre-condition.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb6afefe" class="outline-2">
<h2 id="orgb6afefe">Implementation</h2>
<div class="outline-text-2" id="text-orgb6afefe">
</div>
<div id="outline-container-orgf8ae298" class="outline-3">
<h3 id="orgf8ae298">Imports</h3>
<div class="outline-text-3" id="text-orgf8ae298">
<div class="highlight"><pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="n">be_false</span><span class="p">,</span> <span class="n">be_none</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">expect</span><span class="p">,</span> <span class="n">raise_error</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>

<span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">graeae.visualization.altair_helpers</span> <span class="kn">import</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">save_chart</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgd186d67" class="outline-3">
<h3 id="orgd186d67">Set Up</h3>
<div class="outline-text-3" id="text-orgd186d67">
<div class="highlight"><pre><span></span><span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
<span class="n">OUTPUT_PATH</span> <span class="o">=</span> <span class="n">output_path</span><span class="p">(</span><span class="s2">"binary-search"</span><span class="p">)</span>
<span class="n">save_it</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">save_chart</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>

<span class="n">SearchOutput</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">"SearchOutput"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"index"</span><span class="p">,</span> <span class="s2">"count"</span><span class="p">])</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5fbc69b" class="outline-3">
<h3 id="org5fbc69b">Binary Search One</h3>
<div class="outline-text-3" id="text-org5fbc69b">
</div>
<div id="outline-container-org30c8655" class="outline-4">
<h4 id="org30c8655">The Pseudocode</h4>
<div class="outline-text-4" id="text-org30c8655">
<pre id="binarysearch" style="display:hidden;">
\begin{algorithm}
\caption{BinarySearch}
\begin{algorithmic}
\INPUT Array A of items in non-decreasing order, search key
\OUTPUT If key is in array, the index of the item that matches
\PROCEDURE{BinarySearch}{A, key}
\STATE left $\gets$ 0
\STATE right $\gets$ A.length - 1

\WHILE {right &gt; left}
\STATE middle $\gets \left \lfloor \frac{\textrm{left} + \textrm{right}}{2} \right \rfloor$

\IF {key $\le$ A[middle]}
\STATE right $\gets$ middle
\ELSE
\STATE left $\gets$ middle + 1
\ENDIF
\ENDWHILE

\IF {key = A[left]}
\RETURN left
\ELSE
\RETURN NotFound
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org9cef72c" class="outline-4">
<h4 id="org9cef72c">The Function</h4>
<div class="outline-text-4" id="text-org9cef72c">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">binary_search</span><span class="p">(</span><span class="n">element</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SearchOutput</span><span class="p">:</span>
    <span class="sd">"""Does an iterative binary search for the key</span>

<span class="sd">    Args:</span>
<span class="sd">     element: item in the source to search for</span>
<span class="sd">     elements: sorted (non-decreasing) collection with the key</span>

<span class="sd">    Returns:</span>
<span class="sd">     SearchOutput(index of the key in the source or None if not found, count of comparisons)</span>
<span class="sd">    """</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">element</span> <span class="o">&lt;=</span> <span class="n">elements</span><span class="p">[</span><span class="n">right</span><span class="p">]):</span>
	<span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">left</span><span class="p">:</span>
	<span class="k">assert</span> <span class="n">elements</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">element</span> <span class="o">&lt;=</span> <span class="n">elements</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
	<span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="n">middle</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

	<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">middle</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span> <span class="o">&lt;=</span> <span class="n">elements</span><span class="p">[</span><span class="n">middle</span><span class="p">]</span>
		       <span class="k">else</span> <span class="p">(</span><span class="n">middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>

    <span class="n">location</span> <span class="o">=</span> <span class="n">left</span> <span class="k">if</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">==</span> <span class="n">element</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_it</span><span class="p">(</span><span class="n">searcher</span><span class="p">):</span>
    <span class="n">test_case</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">searcher</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">test_case</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

    <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">expected</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
	<span class="n">expect</span><span class="p">(</span><span class="n">searcher</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="n">item</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">items</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">searcher</span><span class="p">(</span><span class="n">element</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">items</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>

    <span class="n">last</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">last</span> <span class="o">+</span> <span class="mi">100</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">searcher</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">items</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">searcher</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[])[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_none</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">searcher</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span>

<span class="n">test_it</span><span class="p">(</span><span class="n">binary_search</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-orgdf2028b" class="outline-3">
<h3 id="orgdf2028b">Levitin's Version</h3>
<div class="outline-text-3" id="text-orgdf2028b">
<p>
The version I entered above is one that I found on the web (<a href="https://www.eecs.yorku.ca/course_archive/2013-14/W/2011/lectures/09%20Loop%20Invariants%20and%20Binary%20Search.pdf">PDF Lecture Notes</a>), and is roughly what CLRS has. The one in <a href="posts/itdaa/">Levitin's Book</a> is clearer to me but has one more comparison.
</p>
</div>
<div id="outline-container-orgf4a820f" class="outline-4">
<h4 id="orgf4a820f">The Pseudocode</h4>
<div class="outline-text-4" id="text-orgf4a820f">
<pre id="binarysearch2" style="display:hidden;">
\begin{algorithm}
\caption{BinarySearchTwo}
\begin{algorithmic}
\INPUT Array A of items in non-decreasing order, search key in A
\OUTPUT The index of the item that matches key
\PROCEDURE{BinarySearchTwo}{A, key}
\STATE left $\gets$ 0
\STATE right $\gets$ A.length - 1

\WHILE {left $\le$ right}
\STATE middle $\gets \left \lfloor \frac{\textrm{left} + \textrm{right}}{2} \right \rfloor$

\IF {key = A[middle]}
  \RETURN middle
\ELIF {key &lt; A[middle]}
\STATE right $\gets$ middle - 1
\ELSE
\STATE left $\gets$ middle + 1
\ENDIF
\ENDWHILE

\IF {key = A[left]}
\RETURN left
\ELSE
\RETURN NotFound
\ENDIF
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-org9f3c134" class="outline-4">
<h4 id="org9f3c134">The Function</h4>
<div class="outline-text-4" id="text-org9f3c134">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">binary_search_two</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">elements</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SearchOutput</span><span class="p">:</span>
    <span class="sd">"""Iterative Binary Search</span>

<span class="sd">    Args:</span>
<span class="sd">     element: item in the source</span>
<span class="sd">     elements: sorted collection to search</span>

<span class="sd">    Returns:</span>
<span class="sd">     index where key is found in the source or False if not found</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError: key is out of bounds for the source</span>
<span class="sd">    """</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">location</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="n">right</span> <span class="ow">and</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
	<span class="n">middle</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

	<span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="n">elements</span><span class="p">[</span><span class="n">middle</span><span class="p">]:</span>
	    <span class="n">location</span> <span class="o">=</span> <span class="n">middle</span>

	<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">middle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span> <span class="o">&lt;=</span> <span class="n">elements</span><span class="p">[</span><span class="n">middle</span><span class="p">]</span> <span class="k">else</span>
		       <span class="p">(</span><span class="n">middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">test_it</span><span class="p">(</span><span class="n">binary_search_two</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org5fcf40c" class="outline-3">
<h3 id="org5fcf40c">Recursive Version</h3>
<div class="outline-text-3" id="text-org5fcf40c">
<p>
Although it is pretty straightforward as an iterative function, divide and conquer lends itself to recursion so, just for completeness, here's a recursive version of the binary search.
</p>
</div>

<div id="outline-container-org17a83ae" class="outline-4">
<h4 id="org17a83ae">The Pseudocode</h4>
<div class="outline-text-4" id="text-org17a83ae">
<pre id="binarysearch3" style="display:hidden;">
\begin{algorithm}
\caption{Recursive Binary Search}
\begin{algorithmic}
\REQUIRE Input Array is in non-decreasing order
\INPUT Array A , search key, left and right indices to limit the search
\OUTPUT The index of the item that matches the key
\PROCEDURE{BinarySearchRecursive}{A, key, left, right}

\IF {left &gt; right}
  \RETURN NotFound
\ENDIF

\STATE middle $\gets \left \lfloor \frac{\textrm{left} + \textrm{right}}{2} \right \rfloor$

\IF {key = A[middle]}
 \RETURN middle
\ELIF {key &lt; A[middle]}
 \STATE right $\gets$ middle - 1
\ELSE
 \STATE left $\gets$ middle + 1
\ENDIF

\RETURN \textsc{BinarySearchRecursive}(elements, key, left, right)

\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</pre>
</div>
</div>

<div id="outline-container-orgee22b76" class="outline-4">
<h4 id="orgee22b76">The Implementation</h4>
<div class="outline-text-4" id="text-orgee22b76">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">recursive_binary_search</span><span class="p">(</span><span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
			    <span class="n">left</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
			    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">"""Recursive binary search</span>

<span class="sd">    Args:</span>
<span class="sd">     elements: sorted sequence with element in it</span>
<span class="sd">     key: item in elements to search for</span>
<span class="sd">     left: left index of the current sub-list to search</span>
<span class="sd">     right: right index of the current sub-list to search</span>
<span class="sd">     count: number of times we run the comparison (for plotting)</span>

<span class="sd">    Returns:</span>
<span class="sd">     (index, count) - index of the element in the elements and the comparison count</span>
<span class="sd">    """</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">left</span> <span class="o">&gt;</span> <span class="n">right</span><span class="p">:</span>
	<span class="c1"># we missed it, the element isn't in the elements</span>
	<span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">count</span>

    <span class="n">middle</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

    <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">middle</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
	<span class="c1"># we found it</span>
	<span class="k">return</span> <span class="n">middle</span><span class="p">,</span> <span class="n">count</span>

    <span class="c1"># move one of the boundaries to the middle</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">elements</span><span class="p">[</span><span class="n">middle</span><span class="p">]:</span>
	<span class="n">right</span> <span class="o">=</span> <span class="n">middle</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="n">left</span> <span class="o">=</span> <span class="n">middle</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">recursive_binary_search</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>

<p>
This is a helper to get the recursive call started and to handle empty lists or search terms that are outside of the range of the list.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">element</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""calls the recursive binary search</span>

<span class="sd">    Args:</span>
<span class="sd">     element: an element in source to search for</span>
<span class="sd">     elements: sorted sequence of items     </span>
<span class="sd">    """</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="ow">or</span>  <span class="ow">not</span> <span class="n">elements</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">element</span> <span class="o">&lt;=</span> <span class="n">elements</span><span class="p">[</span><span class="n">right</span><span class="p">]:</span>
	<span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">recursive_binary_search</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">test_it</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<div id="outline-container-org41709bd" class="outline-2">
<h2 id="org41709bd">Some Plotting</h2>
<div class="outline-text-2" id="text-org41709bd">
</div>
<div id="outline-container-orgc5c18f9" class="outline-3">
<h3 id="orgc5c18f9">Left and Right</h3>
<div class="outline-text-3" id="text-orgc5c18f9">
<p>
Let's look at how the search updates the left and right boundaries. First we'll need a function that records the locations.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">binary_search_points</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="sd">"""Iterative Binary Search</span>

<span class="sd">    Args:</span>
<span class="sd">     key: item in the source</span>
<span class="sd">     source: sorted collection to search</span>

<span class="sd">    Returns:</span>
<span class="sd">     tuple of left-right locations</span>

<span class="sd">    Raises:</span>
<span class="sd">     AssertionError: key is out of bounds for the source</span>
<span class="sd">    """</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">lefts</span> <span class="o">=</span> <span class="p">[</span><span class="n">left</span><span class="p">]</span>
    <span class="n">rights</span> <span class="o">=</span> <span class="p">[</span><span class="n">right</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">left</span><span class="p">:</span>
	<span class="k">assert</span> <span class="n">source</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;=</span> <span class="n">source</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
	<span class="n">middle</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

	<span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="n">middle</span><span class="p">)</span> <span class="k">if</span> <span class="n">key</span> <span class="o">&lt;=</span> <span class="n">source</span><span class="p">[</span><span class="n">middle</span><span class="p">]</span>
			 <span class="k">else</span> <span class="p">(</span><span class="n">middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>
	<span class="n">lefts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
	<span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lefts</span><span class="p">,</span> <span class="n">rights</span>
</pre></div>

<p>
Now we'll plot it.
</p>

<div class="highlight"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">))</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
<span class="n">lefts</span><span class="p">,</span> <span class="n">rights</span> <span class="o">=</span> <span class="n">binary_search_points</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">Left</span><span class="o">=</span><span class="n">lefts</span><span class="p">,</span> <span class="n">Right</span><span class="o">=</span><span class="n">rights</span><span class="p">,</span> <span class="n">Split</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lefts</span><span class="p">)))))</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Split"</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Left"</span><span class="p">,</span> <span class="s2">"Right"</span><span class="p">],</span>
		   <span class="n">var_name</span><span class="o">=</span><span class="s2">"left_or_right"</span><span class="p">,</span>
		   <span class="n">value_name</span><span class="o">=</span><span class="s2">"Index"</span><span class="p">)</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span>

<span class="n">lines</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Split:O"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Index"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"left_or_right"</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Split:O"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Index"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"left_or_right"</span>
<span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Binary Search Left-Right Boundaries"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">550</span>
<span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">save_it</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"binary-search"</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/binary-search/binary-search.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>

<p>
So, it isn't really so pretty as with the sorting plots. As the plot confirms, the left and right slowly narrow to find the item in the list.
</p>
</div>
</div>

<div id="outline-container-org67aff50" class="outline-3">
<h3 id="org67aff50">Runtime</h3>
<div class="outline-text-3" id="text-org67aff50">
<p>
Let's see how the number of loops goes up with the size of the search space.
</p>

<div class="highlight"><pre><span></span><span class="n">EXPONENT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">numba_search</span> <span class="o">=</span> <span class="n">njit</span><span class="p">(</span><span class="n">binary_search</span><span class="p">)</span>

<span class="n">sizes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">EXPONENT</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">random_source</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">count</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">count</span><span class="p">))</span>
		    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">]</span>
<span class="n">random_things</span> <span class="o">=</span> <span class="p">[(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">elements</span><span class="p">),</span> <span class="n">elements</span><span class="p">)</span>
		    <span class="k">for</span> <span class="n">elements</span> <span class="ow">in</span> <span class="n">random_source</span><span class="p">]</span>

<span class="n">worst_things</span> <span class="o">=</span> <span class="p">[(</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">elements</span><span class="p">)</span> <span class="k">for</span> <span class="n">elements</span> <span class="ow">in</span> <span class="n">random_source</span><span class="p">]</span>

<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">random_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
	<span class="n">delayed</span><span class="p">(</span><span class="n">numba_search</span><span class="p">)(</span><span class="n">element</span><span class="p">,</span> <span class="n">elements</span><span class="p">)</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">elements</span><span class="p">)</span> <span class="ow">in</span> <span class="n">random_things</span><span class="p">)</span>

    <span class="n">worst_output</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
	<span class="n">delayed</span><span class="p">(</span><span class="n">numba_search</span><span class="p">)(</span><span class="n">element</span><span class="p">,</span> <span class="n">elements</span><span class="p">)</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">elements</span><span class="p">)</span> <span class="ow">in</span> <span class="n">worst_things</span><span class="p">)</span>
</pre></div>

<pre class="example">
Started: 2022-01-16 21:33:07.668315
Ended: 2022-01-16 21:33:08.905390
Elapsed: 0:00:01.237075
</pre>


<div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">Count</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span>
    <span class="n">Random</span><span class="o">=</span><span class="p">[</span><span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">random_output</span><span class="p">],</span>
    <span class="n">First</span><span class="o">=</span><span class="p">[</span><span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">worst_output</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">melted</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Count"</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Random"</span><span class="p">,</span> <span class="s2">"First"</span><span class="p">],</span>
		   <span class="n">var_name</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Bisections"</span><span class="p">)</span>

<span class="n">theoretical</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">Count</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">Theoretical</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">sizes</span><span class="p">)))</span>
</pre></div>

<p>
Now, to plot.
</p>

<div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Bisections"</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Location"</span><span class="p">)</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">theoretical</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Theoretical"</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Count"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">","</span><span class="p">),</span>
	     <span class="n">altair</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">"Theoretical"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">".2f"</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Binary Search Bisections"</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">525</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">save_chart</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"binary-search-comparisons"</span><span class="p">,</span>
	   <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>
</pre></div>

<object type="text/html" data="posts/binary-search/binary-search-comparisons.html" style="width:100%" height="600">
  <p>Figure Missing</p>
</object>
</div>
</div>
</div>

<div id="outline-container-orgb82ae74" class="outline-2">
<h2 id="orgb82ae74">See Also</h2>
<div class="outline-text-2" id="text-orgb82ae74">
<ul class="org-ul">
<li>Loop Invariants [Internet]. [cited 2022 Jan 15]. Available from: <a href="https://www.cs.cornell.edu/courses/cs2112/2018fa/lectures/lec_loopinv/">https://www.cs.cornell.edu/courses/cs2112/2018fa/lectures/lec_loopinv/</a>
</li>
<li><a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms (Levitin)</a></li>
</ul>
<script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("binarysearch"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("binarysearch2"));
});
</script><script>
window.addEventListener('load', function () {
    pseudocode.renderElement(document.getElementById("binarysearch3"));
});
</script>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/decrease-and-conquer/" class="u-url">Decrease And Conquer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                The Cloistered Monkey
            </span></p>
            <p class="dateline">
            <a href="posts/decrease-and-conquer/" rel="bookmark">
            <time class="published dt-published" datetime="2022-01-11T11:51:54-08:00" itemprop="datePublished" title="2022-01-11 11:51">2022-01-11 11:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>
With <i>Decrease-and-Conquer</i> algorithms you exploit the relationship between the solution to a problem and the solution to a sub-problem. There are three types of Decrease-and-Conquer algorithms:
</p>

<ul class="org-ul">
<li>Decrease by a constant (typically one)</li>
<li>Decrease by a constant factor (typically two)</li>
<li>Decrease by a variable amount</li>
</ul>
<div id="outline-container-org3f491c2" class="outline-2">
<h2 id="org3f491c2">See Also</h2>
<div class="outline-text-2" id="text-org3f491c2">
<ul class="org-ul">
<li><a href="posts/itdaa/">Introduction to the Design &amp; Analysis of Algorithms</a></li>
</ul>
</div>
</div>
    </div>
    </article>
</div>

        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
            <li class="next"><a href="index-2.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
             MathJax.Hub.Config({
               tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 displayMath: [['$$','$$'], ['\\[','\\]']],
                 processEscapes: true,
                 processEnvironments: true,
               },
               displayAlign: 'center',
               "HTML-CSS": {
                 styles: {'.MathJax_Display': {"margin": 0}}
               }
             });
            </script><script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script><!--End of body content--><footer id="footer"><a href="mailto:cloisteredmonkey.jmark@slmail.me">The Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
 <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
